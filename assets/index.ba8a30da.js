/* empty css                    */import"./vue.17dc9343.js";import{q as dt,D as u,ad as A,a0 as k,aG as Xt,aM as _,a3 as C,a4 as m,K as q,Q as X,aR as he,a2 as P,J as re,aa as H,aP as $e,aN as Le,l as Pe,u as zt,t as B,ba as Ve,aS as ze,H as ne,w as St,bb as Ot,ab as R,az as ht,aO as Mt,A as Ce,a1 as O,bf as j,bh as Qt,bB as pr,ay as Ze,bD as ut,bk as mt,V as vr,j as hr,bE as pn,aF as mr,aT as Ht,aV as se,z as We,bw as br,bA as yr,bl as Ut,as as vn,aK as _r,av as Nr,bn as wr}from"./@vue.f39bd477.js";import{c as Mn}from"./nanoevents.1080beb7.js";import{L as Ue}from"./lz-string.dccec454.js";import{Y as kr}from"./vue-next-select.3f210d97.js";import{D as Sr}from"./vuedraggable.3138c559.js";import{p as Cr}from"./vue-textarea-autosize.35804eaf.js";import{P as xr}from"./vue-panzoom.db51701d.js";import{u as In,s as Mr}from"./vue-toastification.277609fd.js";import"./amator.662264f3.js";import"./bezier-easing.a990b400.js";import"./sortablejs.d2aaca1a.js";import"./panzoom.f5ccc6c8.js";import"./wheel.c9cad283.js";import"./ngraph.events.083734c6.js";const Ir=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerpolicy&&(s.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?s.credentials="include":i.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}};Ir();const $r="modulepreload",hn={},Lr="./",bt=function(t,n){return!n||n.length===0?t():Promise.all(n.map(r=>{if(r=`${Lr}${r}`,r in hn)return;hn[r]=!0;const i=r.endsWith(".css"),s=i?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${r}"]${s}`))return;const a=document.createElement("link");if(a.rel=i?"stylesheet":$r,i||(a.as="script",a.crossOrigin=""),a.href=r,document.head.appendChild(a),i)return new Promise((o,l)=>{a.addEventListener("load",o),a.addEventListener("error",()=>l(new Error(`Unable to preload CSS for ${r}`)))})})).then(()=>t())},Rr="./projInfo-schema.json",Fr="Nanite",Pr="A project made in Profectus",Tr="break-the-cycle",Er="Escapee",zr="",Or="",Dr="0.0",Ar="Initial Commit",Vr=!0,jr=!1,Br=2,qr=!0,Ur=null,Zr="",Wr=["main"],Gr=3600,Hr=!0,Yr="base64";var ee={$schema:Rr,title:Fr,description:Pr,id:Tr,author:Er,discordName:zr,discordLink:Or,versionNumber:Dr,versionTitle:Ar,allowGoBack:Vr,defaultShowSmall:jr,defaultDecimalsShown:Br,useHeader:qr,banner:Ur,logo:Zr,initialTabs:Wr,maxTickLength:Gr,enablePausing:Hr,exportEncoding:Yr};const Jr=dt({id:"",devSpeed:null,name:"",tabs:[],time:-1,autosave:!0,timePlayed:0,keepGoing:!1,modID:"",modVersion:"",layers:{}});var J=window.player=Jr;function $n(e){return JSON.stringify(e,(t,n)=>u(n))}var W=(e,t)=>{const n=e.__vccOpts||e;for(const[r,i]of t)n[r]=i;return n};const Ln=e=>($e("data-v-1b5356cf"),e=e(),Le(),e),Kr={class:"error"},Xr={class:"error-title"},Qr={class:"error-details",style:{"margin-top":"-10px"}},ei={key:0},ti={class:"instructions"},ni=["href"],ri=Ln(()=>m("br",null,null,-1)),ii={key:0,style:{"margin-top":"20px"}},si=Ln(()=>m("h3",null,"Other errors",-1)),oi=[si],ai={class:"error-details"},li={key:0,style:{"margin-top":"10px"}},ui={key:1,style:{"margin-top":"10px"}},ci=A({__name:"Error",props:{errors:{}},setup(e){const t=e,n=k(()=>t.errors[0]),r=k(()=>t.errors.map(s=>s.stack==null?[]:s.stack.split(`
`))),i=k(()=>t.errors.map(s=>s.cause==null?[]:(typeof s.cause=="string"?s.cause:JSON.stringify(s.cause)).split(`
`)));return Xt(()=>{J.autosave=!1,J.devSpeed=0}),(s,a)=>(_(),C("div",Kr,[m("h1",Xr,q(n.value.name)+": "+q(n.value.message),1),m("div",Qr,[n.value.cause?(_(),C("div",ei,[(_(!0),C(X,null,he(i.value[0],o=>(_(),C("div",{key:o},q(o),1))),128))])):P("",!0),n.value.stack?(_(),C("div",{key:1,style:re(n.value.cause?"margin-top: 10px":"")},[(_(!0),C(X,null,he(r.value[0],o=>(_(),C("div",{key:o},q(o),1))),128))],4)):P("",!0)]),m("div",ti,[H(" Check the console for more details, and consider sharing it with the developers on "),m("a",{href:u(ee).discordLink||"https://discord.gg/yJ4fjnjU54",class:"discord-link"},"discord",8,ni),H("!"),ri,s.errors.length>1?(_(),C("div",ii,oi)):P("",!0),(_(!0),C(X,null,he(s.errors.slice(1),(o,l)=>(_(),C("div",{key:l,style:{"margin-top":"20px"}},[m("details",ai,[m("summary",null,q(o.name)+": "+q(o.message),1),o.cause?(_(),C("div",li,[(_(!0),C(X,null,he(i.value[l+1],v=>(_(),C("div",{key:v},q(v),1))),128))])):P("",!0),o.stack?(_(),C("div",ui,[(_(!0),C(X,null,he(r.value[l+1],v=>(_(),C("div",{key:v},q(v),1))),128))])):P("",!0)])]))),128))])]))}});var Rn=W(ci,[["__scopeId","data-v-1b5356cf"]]);class di{constructor(t){this.map=new Map,this.first=void 0,this.last=void 0,this.maxSize=t}get size(){return this.map.size}get(t){const n=this.map.get(t);if(n!==void 0)return n!==this.first&&(n===this.last?(this.last=n.prev,this.last.next=void 0):(n.prev.next=n.next,n.next.prev=n.prev),n.next=this.first,this.first.prev=n,this.first=n),n.value}set(t,n){if(this.maxSize<1)return;if(this.map.has(t))throw new Error("Cannot update existing keys in the cache");const r=new fi(t,n);for(this.first===void 0?(this.first=r,this.last=r):(r.next=this.first,this.first.prev=r,this.first=r),this.map.set(t,r);this.map.size>this.maxSize;){const i=this.last;this.map.delete(i.key),this.last=i.prev,this.last.next=void 0}}}class fi{constructor(t,n){this.next=void 0,this.prev=void 0,this.key=t,this.value=n}}const Zt=17,gi=9e15,pi=Math.log10(9e15),vi=1/9e15,hi=308,mi=-324,mn=5,bi=(1<<10)-1,yi=function(){const e=[];for(let n=mi+1;n<=hi;n++)e.push(Number("1e"+n));const t=323;return function(n){return e[n+t]}}(),He=[2,Math.E,3,4,5,6,7,8,9,10],_i=[[1,1.0891180521811203,1.1789767925673957,1.2701455431742086,1.3632090180450092,1.4587818160364217,1.5575237916251419,1.6601571006859253,1.767485818836978,1.8804192098842727,2],[1,1.1121114330934079,1.231038924931609,1.3583836963111375,1.4960519303993531,1.6463542337511945,1.8121385357018724,1.996971324618307,2.2053895545527546,2.4432574483385254,Math.E],[1,1.1187738849693603,1.2464963939368214,1.38527004705667,1.5376664685821402,1.7068895236551784,1.897001227148399,2.1132403089001035,2.362480153784171,2.6539010333870774,3],[1,1.1367350847096405,1.2889510672956703,1.4606478703324786,1.6570295196661111,1.8850062585672889,2.1539465047453485,2.476829779693097,2.872061932789197,3.3664204535587183,4],[1,1.1494592900767588,1.319708228183931,1.5166291280087583,1.748171114438024,2.0253263297298045,2.3636668498288547,2.7858359149579424,3.3257226212448145,4.035730287722532,5],[1,1.159225940787673,1.343712473580932,1.5611293155111927,1.8221199554561318,2.14183924486326,2.542468319282638,3.0574682501653316,3.7390572020926873,4.6719550537360774,6],[1,1.1670905356972596,1.3632807444991446,1.5979222279405536,1.8842640123816674,2.2416069644878687,2.69893426559423,3.3012632110403577,4.121250340630164,5.281493033448316,7],[1,1.1736630594087796,1.379783782386201,1.6292821855668218,1.9378971836180754,2.3289975651071977,2.8384347394720835,3.5232708454565906,4.478242031114584,5.868592169644505,8],[1,1.1793017514670474,1.394054150657457,1.65664127441059,1.985170999970283,2.4069682290577457,2.9647310119960752,3.7278665320924946,4.814462547283592,6.436522247411611,9],[1,1.1840100246247336,1.4061375836156955,1.6802272208863964,2.026757028388619,2.4770056063449646,3.080525271755482,3.9191964192627284,5.135152840833187,6.989961179534715,10]],Ni=[[-1,-.9194161097107025,-.8335625019330468,-.7425599821143978,-.6466611521029437,-.5462617907227869,-.4419033816638769,-.3342645487554494,-.224140440909962,-.11241087890006762,0],[-1,-.90603157029014,-.80786507256596,-.7064666939634,-.60294836853664,-.49849837513117,-.39430303318768,-.29147201034755,-.19097820800866,-.09361896280296,0],[-1,-.9021579584316141,-.8005762598234203,-.6964780623319391,-.5911906810998454,-.486050182576545,-.3823089430815083,-.28106046722897615,-.1831906535795894,-.08935809204418144,0],[-1,-.8917227442365535,-.781258746326964,-.6705130326902455,-.5612813129406509,-.4551067709033134,-.35319256652135966,-.2563741554088552,-.1651412821106526,-.0796919581982668,0],[-1,-.8843387974366064,-.7678744063886243,-.6529563724510552,-.5415870994657841,-.4352842206588936,-.33504449124791424,-.24138853420685147,-.15445285440944467,-.07409659641336663,0],[-1,-.8786709358426346,-.7577735191184886,-.6399546189952064,-.527284921869926,-.4211627631006314,-.3223479611761232,-.23107655627789858,-.1472057700818259,-.07035171210706326,0],[-1,-.8740862815291583,-.7497032990976209,-.6297119746181752,-.5161838335958787,-.41036238255751956,-.31277212146489963,-.2233976621705518,-.1418697367979619,-.06762117662323441,0],[-1,-.8702632331800649,-.7430366914122081,-.6213373075161548,-.5072025698095242,-.40171437727184167,-.30517930701410456,-.21736343968190863,-.137710238299109,-.06550774483471955,0],[-1,-.8670016295947213,-.7373984232432306,-.6143173985094293,-.49973884395492807,-.394584953527678,-.2989649949848695,-.21245647317021688,-.13434688362382652,-.0638072667348083,0],[-1,-.8641642839543857,-.732534623168535,-.6083127477059322,-.4934049257184696,-.3885773075899922,-.29376029055315767,-.2083678561173622,-.13155653399373268,-.062401588652553186,0]];let x=function(t){return N.fromValue_noAlloc(t)},U=function(e,t,n){return N.fromComponents(e,t,n)},Y=function(t,n,r){return N.fromComponents_noNormalize(t,n,r)};const Be=function(t,n){const r=n+1,i=Math.ceil(Math.log10(Math.abs(t))),s=Math.round(t*Math.pow(10,r-i))*Math.pow(10,i-r);return parseFloat(s.toFixed(Math.max(r-i,0)))},Wt=function(e){return Math.sign(e)*Math.log10(Math.abs(e))},wi=function(e){if(!isFinite(e))return e;if(e<-50)return e===Math.trunc(e)?Number.NEGATIVE_INFINITY:0;let t=1;for(;e<10;)t=t*e,++e;e-=1;let n=.9189385332046727;n=n+(e+.5)*Math.log(e),n=n-e;const r=e*e;let i=e;return n=n+1/(12*i),i=i*r,n=n+1/(360*i),i=i*r,n=n+1/(1260*i),i=i*r,n=n+1/(1680*i),i=i*r,n=n+1/(1188*i),i=i*r,n=n+691/(360360*i),i=i*r,n=n+7/(1092*i),i=i*r,n=n+3617/(122400*i),Math.exp(n)/t},Fn=.5671432904097838,bn=function(e,t=1e-10){let n,r;if(!Number.isFinite(e)||e===0)return e;if(e===1)return Fn;e<10?n=0:n=Math.log(e)-Math.log(Math.log(e));for(let i=0;i<100;++i){if(r=(e*Math.exp(-n)+n*n)/(n+1),Math.abs(r-n)<t*Math.abs(r))return r;n=r}throw Error(`Iteration failed to converge: ${e.toString()}`)};function yn(e,t=1e-10){let n,r,i,s;if(!Number.isFinite(e.mag)||e.eq(N.dZero))return e;if(e.eq(N.dOne))return N.fromNumber(Fn);n=N.ln(e);for(let a=0;a<100;++a){if(r=n.neg().exp(),i=n.sub(e.mul(r)),s=n.sub(i.div(n.add(1).sub(n.add(2).mul(i).div(N.mul(2,n).add(2))))),N.abs(s.sub(n)).lt(N.abs(s).mul(t)))return s;n=s}throw Error(`Iteration failed to converge: ${e.toString()}`)}const w=class{constructor(e){this.sign=0,this.mag=0,this.layer=0,e instanceof w?this.fromDecimal(e):typeof e=="number"?this.fromNumber(e):typeof e=="string"&&this.fromString(e)}get m(){if(this.sign===0)return 0;if(this.layer===0){const e=Math.floor(Math.log10(this.mag));let t;return this.mag===5e-324?t=5:t=this.mag/yi(e),this.sign*t}else if(this.layer===1){const e=this.mag-Math.floor(this.mag);return this.sign*Math.pow(10,e)}else return this.sign}set m(e){this.layer<=2?this.fromMantissaExponent(e,this.e):(this.sign=Math.sign(e),this.sign===0&&(this.layer=0,this.exponent=0))}get e(){return this.sign===0?0:this.layer===0?Math.floor(Math.log10(this.mag)):this.layer===1?Math.floor(this.mag):this.layer===2?Math.floor(Math.sign(this.mag)*Math.pow(10,Math.abs(this.mag))):this.mag*Number.POSITIVE_INFINITY}set e(e){this.fromMantissaExponent(this.m,e)}get s(){return this.sign}set s(e){e===0?(this.sign=0,this.layer=0,this.mag=0):this.sign=e}get mantissa(){return this.m}set mantissa(e){this.m=e}get exponent(){return this.e}set exponent(e){this.e=e}static fromComponents(e,t,n){return new w().fromComponents(e,t,n)}static fromComponents_noNormalize(e,t,n){return new w().fromComponents_noNormalize(e,t,n)}static fromMantissaExponent(e,t){return new w().fromMantissaExponent(e,t)}static fromMantissaExponent_noNormalize(e,t){return new w().fromMantissaExponent_noNormalize(e,t)}static fromDecimal(e){return new w().fromDecimal(e)}static fromNumber(e){return new w().fromNumber(e)}static fromString(e){return new w().fromString(e)}static fromValue(e){return new w().fromValue(e)}static fromValue_noAlloc(e){if(e instanceof w)return e;if(typeof e=="string"){const t=w.fromStringCache.get(e);return t!==void 0?t:w.fromString(e)}else return typeof e=="number"?w.fromNumber(e):w.dZero}static abs(e){return x(e).abs()}static neg(e){return x(e).neg()}static negate(e){return x(e).neg()}static negated(e){return x(e).neg()}static sign(e){return x(e).sign}static sgn(e){return x(e).sign}static round(e){return x(e).round()}static floor(e){return x(e).floor()}static ceil(e){return x(e).ceil()}static trunc(e){return x(e).trunc()}static add(e,t){return x(e).add(t)}static plus(e,t){return x(e).add(t)}static sub(e,t){return x(e).sub(t)}static subtract(e,t){return x(e).sub(t)}static minus(e,t){return x(e).sub(t)}static mul(e,t){return x(e).mul(t)}static multiply(e,t){return x(e).mul(t)}static times(e,t){return x(e).mul(t)}static div(e,t){return x(e).div(t)}static divide(e,t){return x(e).div(t)}static recip(e){return x(e).recip()}static reciprocal(e){return x(e).recip()}static reciprocate(e){return x(e).reciprocate()}static cmp(e,t){return x(e).cmp(t)}static cmpabs(e,t){return x(e).cmpabs(t)}static compare(e,t){return x(e).cmp(t)}static isNaN(e){return e=x(e),isNaN(e.sign)||isNaN(e.layer)||isNaN(e.mag)}static isFinite(e){return e=x(e),isFinite(e.sign)&&isFinite(e.layer)&&isFinite(e.mag)}static eq(e,t){return x(e).eq(t)}static equals(e,t){return x(e).eq(t)}static neq(e,t){return x(e).neq(t)}static notEquals(e,t){return x(e).notEquals(t)}static lt(e,t){return x(e).lt(t)}static lte(e,t){return x(e).lte(t)}static gt(e,t){return x(e).gt(t)}static gte(e,t){return x(e).gte(t)}static max(e,t){return x(e).max(t)}static min(e,t){return x(e).min(t)}static minabs(e,t){return x(e).minabs(t)}static maxabs(e,t){return x(e).maxabs(t)}static clamp(e,t,n){return x(e).clamp(t,n)}static clampMin(e,t){return x(e).clampMin(t)}static clampMax(e,t){return x(e).clampMax(t)}static cmp_tolerance(e,t,n){return x(e).cmp_tolerance(t,n)}static compare_tolerance(e,t,n){return x(e).cmp_tolerance(t,n)}static eq_tolerance(e,t,n){return x(e).eq_tolerance(t,n)}static equals_tolerance(e,t,n){return x(e).eq_tolerance(t,n)}static neq_tolerance(e,t,n){return x(e).neq_tolerance(t,n)}static notEquals_tolerance(e,t,n){return x(e).notEquals_tolerance(t,n)}static lt_tolerance(e,t,n){return x(e).lt_tolerance(t,n)}static lte_tolerance(e,t,n){return x(e).lte_tolerance(t,n)}static gt_tolerance(e,t,n){return x(e).gt_tolerance(t,n)}static gte_tolerance(e,t,n){return x(e).gte_tolerance(t,n)}static pLog10(e){return x(e).pLog10()}static absLog10(e){return x(e).absLog10()}static log10(e){return x(e).log10()}static log(e,t){return x(e).log(t)}static log2(e){return x(e).log2()}static ln(e){return x(e).ln()}static logarithm(e,t){return x(e).logarithm(t)}static pow(e,t){return x(e).pow(t)}static pow10(e){return x(e).pow10()}static pow_base(e,t){return x(e).pow_base(t)}static root(e,t){return x(e).root(t)}static factorial(e,t){return x(e).factorial()}static gamma(e,t){return x(e).gamma()}static lngamma(e,t){return x(e).lngamma()}static exp(e){return x(e).exp()}static sqr(e){return x(e).sqr()}static sqrt(e){return x(e).sqrt()}static cube(e){return x(e).cube()}static cbrt(e){return x(e).cbrt()}static tetrate(e,t=2,n=Y(1,0,1)){return x(e).tetrate(t,n)}static iteratedexp(e,t=2,n=Y(1,0,1)){return x(e).iteratedexp(t,n)}static iteratedlog(e,t=10,n=1){return x(e).iteratedlog(t,n)}static layeradd10(e,t){return x(e).layeradd10(t)}static layeradd(e,t,n=10){return x(e).layeradd(t,n)}static slog(e,t=10){return x(e).slog(t)}static lambertw(e){return x(e).lambertw()}static ssqrt(e){return x(e).ssqrt()}static pentate(e,t=2,n=Y(1,0,1)){return x(e).pentate(t,n)}static sin(e){return x(e).sin()}static cos(e){return x(e).cos()}static tan(e){return x(e).tan()}static asin(e){return x(e).asin()}static acos(e){return x(e).acos()}static atan(e){return x(e).atan()}static sinh(e){return x(e).sinh()}static cosh(e){return x(e).cosh()}static tanh(e){return x(e).tanh()}static asinh(e){return x(e).asinh()}static acosh(e){return x(e).acosh()}static atanh(e){return x(e).atanh()}static affordGeometricSeries(e,t,n,r){return this.affordGeometricSeries_core(x(e),x(t),x(n),r)}static sumGeometricSeries(e,t,n,r){return this.sumGeometricSeries_core(e,x(t),x(n),r)}static affordArithmeticSeries(e,t,n,r){return this.affordArithmeticSeries_core(x(e),x(t),x(n),x(r))}static sumArithmeticSeries(e,t,n,r){return this.sumArithmeticSeries_core(x(e),x(t),x(n),x(r))}static efficiencyOfPurchase(e,t,n){return this.efficiencyOfPurchase_core(x(e),x(t),x(n))}static randomDecimalForTesting(e){if(Math.random()*20<1)return Y(0,0,0);const t=Math.random()>.5?1:-1;if(Math.random()*20<1)return Y(t,0,1);const n=Math.floor(Math.random()*(e+1));let r=n===0?Math.random()*616-308:Math.random()*16;Math.random()>.9&&(r=Math.trunc(r));let i=Math.pow(10,r);return Math.random()>.9&&(i=Math.trunc(i)),U(t,n,i)}static affordGeometricSeries_core(e,t,n,r){const i=t.mul(n.pow(r));return w.floor(e.div(i).mul(n.sub(1)).add(1).log10().div(n.log10()))}static sumGeometricSeries_core(e,t,n,r){return t.mul(n.pow(r)).mul(w.sub(1,n.pow(e))).div(w.sub(1,n))}static affordArithmeticSeries_core(e,t,n,r){const s=t.add(r.mul(n)).sub(n.div(2)),a=s.pow(2);return s.neg().add(a.add(n.mul(e).mul(2)).sqrt()).div(n).floor()}static sumArithmeticSeries_core(e,t,n,r){const i=t.add(r.mul(n));return e.div(2).mul(i.mul(2).plus(e.sub(1).mul(n)))}static efficiencyOfPurchase_core(e,t,n){return e.div(t).add(e.div(n))}normalize(){if(this.sign===0||this.mag===0&&this.layer===0)return this.sign=0,this.mag=0,this.layer=0,this;if(this.layer===0&&this.mag<0&&(this.mag=-this.mag,this.sign=-this.sign),this.layer===0&&this.mag<vi)return this.layer+=1,this.mag=Math.log10(this.mag),this;let e=Math.abs(this.mag),t=Math.sign(this.mag);if(e>=gi)return this.layer+=1,this.mag=t*Math.log10(e),this;for(;e<pi&&this.layer>0;)this.layer-=1,this.layer===0?this.mag=Math.pow(10,this.mag):(this.mag=t*Math.pow(10,e),e=Math.abs(this.mag),t=Math.sign(this.mag));return this.layer===0&&(this.mag<0?(this.mag=-this.mag,this.sign=-this.sign):this.mag===0&&(this.sign=0)),this}fromComponents(e,t,n){return this.sign=e,this.layer=t,this.mag=n,this.normalize(),this}fromComponents_noNormalize(e,t,n){return this.sign=e,this.layer=t,this.mag=n,this}fromMantissaExponent(e,t){return this.layer=1,this.sign=Math.sign(e),e=Math.abs(e),this.mag=t+Math.log10(e),this.normalize(),this}fromMantissaExponent_noNormalize(e,t){return this.fromMantissaExponent(e,t),this}fromDecimal(e){return this.sign=e.sign,this.layer=e.layer,this.mag=e.mag,this}fromNumber(e){return this.mag=Math.abs(e),this.sign=Math.sign(e),this.layer=0,this.normalize(),this}fromString(e){const t=e,n=w.fromStringCache.get(t);if(n!==void 0)return this.fromDecimal(n);e=e.replace(",","");const r=e.split("^^^");if(r.length===2){const g=parseFloat(r[0]),h=parseFloat(r[1]),S=r[1].split(";");let M=1;if(S.length===2&&(M=parseFloat(S[1]),isFinite(M)||(M=1)),isFinite(g)&&isFinite(h)){const y=w.pentate(g,h,M);return this.sign=y.sign,this.layer=y.layer,this.mag=y.mag,w.fromStringCache.maxSize>=1&&w.fromStringCache.set(t,w.fromDecimal(this)),this}}const i=e.split("^^");if(i.length===2){const g=parseFloat(i[0]),h=parseFloat(i[1]),S=i[1].split(";");let M=1;if(S.length===2&&(M=parseFloat(S[1]),isFinite(M)||(M=1)),isFinite(g)&&isFinite(h)){const y=w.tetrate(g,h,M);return this.sign=y.sign,this.layer=y.layer,this.mag=y.mag,w.fromStringCache.maxSize>=1&&w.fromStringCache.set(t,w.fromDecimal(this)),this}}const s=e.split("^");if(s.length===2){const g=parseFloat(s[0]),h=parseFloat(s[1]);if(isFinite(g)&&isFinite(h)){const S=w.pow(g,h);return this.sign=S.sign,this.layer=S.layer,this.mag=S.mag,w.fromStringCache.maxSize>=1&&w.fromStringCache.set(t,w.fromDecimal(this)),this}}e=e.trim().toLowerCase();let a,o,l=e.split("pt");if(l.length===2){a=10,o=parseFloat(l[0]),l[1]=l[1].replace("(",""),l[1]=l[1].replace(")","");let g=parseFloat(l[1]);if(isFinite(g)||(g=1),isFinite(a)&&isFinite(o)){const h=w.tetrate(a,o,g);return this.sign=h.sign,this.layer=h.layer,this.mag=h.mag,w.fromStringCache.maxSize>=1&&w.fromStringCache.set(t,w.fromDecimal(this)),this}}if(l=e.split("p"),l.length===2){a=10,o=parseFloat(l[0]),l[1]=l[1].replace("(",""),l[1]=l[1].replace(")","");let g=parseFloat(l[1]);if(isFinite(g)||(g=1),isFinite(a)&&isFinite(o)){const h=w.tetrate(a,o,g);return this.sign=h.sign,this.layer=h.layer,this.mag=h.mag,w.fromStringCache.maxSize>=1&&w.fromStringCache.set(t,w.fromDecimal(this)),this}}const v=e.split("e"),p=v.length-1;if(p===0){const g=parseFloat(e);if(isFinite(g))return this.fromNumber(g),w.fromStringCache.size>=1&&w.fromStringCache.set(t,w.fromDecimal(this)),this}else if(p===1){const g=parseFloat(e);if(isFinite(g)&&g!==0)return this.fromNumber(g),w.fromStringCache.maxSize>=1&&w.fromStringCache.set(t,w.fromDecimal(this)),this}const b=e.split("e^");if(b.length===2){this.sign=1,b[0].charAt(0)=="-"&&(this.sign=-1);let g="";for(let h=0;h<b[1].length;++h){const S=b[1].charCodeAt(h);if(S>=43&&S<=57||S===101)g+=b[1].charAt(h);else return this.layer=parseFloat(g),this.mag=parseFloat(b[1].substr(h+1)),this.normalize(),w.fromStringCache.maxSize>=1&&w.fromStringCache.set(t,w.fromDecimal(this)),this}}if(p<1)return this.sign=0,this.layer=0,this.mag=0,w.fromStringCache.maxSize>=1&&w.fromStringCache.set(t,w.fromDecimal(this)),this;const d=parseFloat(v[0]);if(d===0)return this.sign=0,this.layer=0,this.mag=0,w.fromStringCache.maxSize>=1&&w.fromStringCache.set(t,w.fromDecimal(this)),this;let c=parseFloat(v[v.length-1]);if(p>=2){const g=parseFloat(v[v.length-2]);isFinite(g)&&(c*=Math.sign(g),c+=Wt(g))}if(!isFinite(d))this.sign=v[0]==="-"?-1:1,this.layer=p,this.mag=c;else if(p===1)this.sign=Math.sign(d),this.layer=1,this.mag=c+Math.log10(Math.abs(d));else if(this.sign=Math.sign(d),this.layer=p,p===2){const g=w.mul(U(1,2,c),x(d));return this.sign=g.sign,this.layer=g.layer,this.mag=g.mag,w.fromStringCache.maxSize>=1&&w.fromStringCache.set(t,w.fromDecimal(this)),this}else this.mag=c;return this.normalize(),w.fromStringCache.maxSize>=1&&w.fromStringCache.set(t,w.fromDecimal(this)),this}fromValue(e){return e instanceof w?this.fromDecimal(e):typeof e=="number"?this.fromNumber(e):typeof e=="string"?this.fromString(e):(this.sign=0,this.layer=0,this.mag=0,this)}toNumber(){return Number.isFinite(this.layer)?this.layer===0?this.sign*this.mag:this.layer===1?this.sign*Math.pow(10,this.mag):this.mag>0?this.sign>0?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:0:Number.NaN}mantissaWithDecimalPlaces(e){return isNaN(this.m)?Number.NaN:this.m===0?0:Be(this.m,e)}magnitudeWithDecimalPlaces(e){return isNaN(this.mag)?Number.NaN:this.mag===0?0:Be(this.mag,e)}toString(){return isNaN(this.layer)||isNaN(this.sign)||isNaN(this.mag)?"NaN":this.mag===Number.POSITIVE_INFINITY||this.layer===Number.POSITIVE_INFINITY?this.sign===1?"Infinity":"-Infinity":this.layer===0?this.mag<1e21&&this.mag>1e-7||this.mag===0?(this.sign*this.mag).toString():this.m+"e"+this.e:this.layer===1?this.m+"e"+this.e:this.layer<=mn?(this.sign===-1?"-":"")+"e".repeat(this.layer)+this.mag:(this.sign===-1?"-":"")+"(e^"+this.layer+")"+this.mag}toExponential(e){return this.layer===0?(this.sign*this.mag).toExponential(e):this.toStringWithDecimalPlaces(e)}toFixed(e){return this.layer===0?(this.sign*this.mag).toFixed(e):this.toStringWithDecimalPlaces(e)}toPrecision(e){return this.e<=-7?this.toExponential(e-1):e>this.e?this.toFixed(e-this.exponent-1):this.toExponential(e-1)}valueOf(){return this.toString()}toJSON(){return this.toString()}toStringWithDecimalPlaces(e){return this.layer===0?this.mag<1e21&&this.mag>1e-7||this.mag===0?(this.sign*this.mag).toFixed(e):Be(this.m,e)+"e"+Be(this.e,e):this.layer===1?Be(this.m,e)+"e"+Be(this.e,e):this.layer<=mn?(this.sign===-1?"-":"")+"e".repeat(this.layer)+Be(this.mag,e):(this.sign===-1?"-":"")+"(e^"+this.layer+")"+Be(this.mag,e)}abs(){return Y(this.sign===0?0:1,this.layer,this.mag)}neg(){return Y(-this.sign,this.layer,this.mag)}negate(){return this.neg()}negated(){return this.neg()}sgn(){return this.sign}round(){return this.mag<0?w.dZero:this.layer===0?U(this.sign,0,Math.round(this.mag)):this}floor(){return this.mag<0?w.dZero:this.layer===0?U(this.sign,0,Math.floor(this.mag)):this}ceil(){return this.mag<0?w.dZero:this.layer===0?U(this.sign,0,Math.ceil(this.mag)):this}trunc(){return this.mag<0?w.dZero:this.layer===0?U(this.sign,0,Math.trunc(this.mag)):this}add(e){const t=x(e);if(!Number.isFinite(this.layer))return this;if(!Number.isFinite(t.layer)||this.sign===0)return t;if(t.sign===0)return this;if(this.sign===-t.sign&&this.layer===t.layer&&this.mag===t.mag)return Y(0,0,0);let n,r;if(this.layer>=2||t.layer>=2)return this.maxabs(t);if(w.cmpabs(this,t)>0?(n=this,r=t):(n=t,r=this),n.layer===0&&r.layer===0)return w.fromNumber(n.sign*n.mag+r.sign*r.mag);const i=n.layer*Math.sign(n.mag),s=r.layer*Math.sign(r.mag);if(i-s>=2)return n;if(i===0&&s===-1){if(Math.abs(r.mag-Math.log10(n.mag))>Zt)return n;{const a=Math.pow(10,Math.log10(n.mag)-r.mag),o=r.sign+n.sign*a;return U(Math.sign(o),1,r.mag+Math.log10(Math.abs(o)))}}if(i===1&&s===0){if(Math.abs(n.mag-Math.log10(r.mag))>Zt)return n;{const a=Math.pow(10,n.mag-Math.log10(r.mag)),o=r.sign+n.sign*a;return U(Math.sign(o),1,Math.log10(r.mag)+Math.log10(Math.abs(o)))}}if(Math.abs(n.mag-r.mag)>Zt)return n;{const a=Math.pow(10,n.mag-r.mag),o=r.sign+n.sign*a;return U(Math.sign(o),1,r.mag+Math.log10(Math.abs(o)))}}plus(e){return this.add(e)}sub(e){return this.add(x(e).neg())}subtract(e){return this.sub(e)}minus(e){return this.sub(e)}mul(e){const t=x(e);if(!Number.isFinite(this.layer))return this;if(!Number.isFinite(t.layer))return t;if(this.sign===0||t.sign===0)return Y(0,0,0);if(this.layer===t.layer&&this.mag===-t.mag)return Y(this.sign*t.sign,0,1);let n,r;if(this.layer>t.layer||this.layer==t.layer&&Math.abs(this.mag)>Math.abs(t.mag)?(n=this,r=t):(n=t,r=this),n.layer===0&&r.layer===0)return w.fromNumber(n.sign*r.sign*n.mag*r.mag);if(n.layer>=3||n.layer-r.layer>=2)return U(n.sign*r.sign,n.layer,n.mag);if(n.layer===1&&r.layer===0)return U(n.sign*r.sign,1,n.mag+Math.log10(r.mag));if(n.layer===1&&r.layer===1)return U(n.sign*r.sign,1,n.mag+r.mag);if(n.layer===2&&r.layer===1){const i=U(Math.sign(n.mag),n.layer-1,Math.abs(n.mag)).add(U(Math.sign(r.mag),r.layer-1,Math.abs(r.mag)));return U(n.sign*r.sign,i.layer+1,i.sign*i.mag)}if(n.layer===2&&r.layer===2){const i=U(Math.sign(n.mag),n.layer-1,Math.abs(n.mag)).add(U(Math.sign(r.mag),r.layer-1,Math.abs(r.mag)));return U(n.sign*r.sign,i.layer+1,i.sign*i.mag)}throw Error("Bad arguments to mul: "+this+", "+e)}multiply(e){return this.mul(e)}times(e){return this.mul(e)}div(e){const t=x(e);return this.mul(t.recip())}divide(e){return this.div(e)}divideBy(e){return this.div(e)}dividedBy(e){return this.div(e)}recip(){return this.mag===0?w.dNaN:this.layer===0?U(this.sign,0,1/this.mag):U(this.sign,this.layer,-this.mag)}reciprocal(){return this.recip()}reciprocate(){return this.recip()}cmp(e){const t=x(e);return this.sign>t.sign?1:this.sign<t.sign?-1:this.sign*this.cmpabs(e)}cmpabs(e){const t=x(e),n=this.mag>0?this.layer:-this.layer,r=t.mag>0?t.layer:-t.layer;return n>r?1:n<r?-1:this.mag>t.mag?1:this.mag<t.mag?-1:0}compare(e){return this.cmp(e)}isNan(){return isNaN(this.sign)||isNaN(this.layer)||isNaN(this.mag)}isFinite(){return isFinite(this.sign)&&isFinite(this.layer)&&isFinite(this.mag)}eq(e){const t=x(e);return this.sign===t.sign&&this.layer===t.layer&&this.mag===t.mag}equals(e){return this.eq(e)}neq(e){return!this.eq(e)}notEquals(e){return this.neq(e)}lt(e){return this.cmp(e)===-1}lte(e){return!this.gt(e)}gt(e){return this.cmp(e)===1}gte(e){return!this.lt(e)}max(e){const t=x(e);return this.lt(t)?t:this}min(e){const t=x(e);return this.gt(t)?t:this}maxabs(e){const t=x(e);return this.cmpabs(t)<0?t:this}minabs(e){const t=x(e);return this.cmpabs(t)>0?t:this}clamp(e,t){return this.max(e).min(t)}clampMin(e){return this.max(e)}clampMax(e){return this.min(e)}cmp_tolerance(e,t){const n=x(e);return this.eq_tolerance(n,t)?0:this.cmp(n)}compare_tolerance(e,t){return this.cmp_tolerance(e,t)}eq_tolerance(e,t){const n=x(e);if(t==null&&(t=1e-7),this.sign!==n.sign||Math.abs(this.layer-n.layer)>1)return!1;let r=this.mag,i=n.mag;return this.layer>n.layer&&(i=Wt(i)),this.layer<n.layer&&(r=Wt(r)),Math.abs(r-i)<=t*Math.max(Math.abs(r),Math.abs(i))}equals_tolerance(e,t){return this.eq_tolerance(e,t)}neq_tolerance(e,t){return!this.eq_tolerance(e,t)}notEquals_tolerance(e,t){return this.neq_tolerance(e,t)}lt_tolerance(e,t){const n=x(e);return!this.eq_tolerance(n,t)&&this.lt(n)}lte_tolerance(e,t){const n=x(e);return this.eq_tolerance(n,t)||this.lt(n)}gt_tolerance(e,t){const n=x(e);return!this.eq_tolerance(n,t)&&this.gt(n)}gte_tolerance(e,t){const n=x(e);return this.eq_tolerance(n,t)||this.gt(n)}pLog10(){return this.lt(w.dZero)?w.dZero:this.log10()}absLog10(){return this.sign===0?w.dNaN:this.layer>0?U(Math.sign(this.mag),this.layer-1,Math.abs(this.mag)):U(1,0,Math.log10(this.mag))}log10(){return this.sign<=0?w.dNaN:this.layer>0?U(Math.sign(this.mag),this.layer-1,Math.abs(this.mag)):U(this.sign,0,Math.log10(this.mag))}log(e){return e=x(e),this.sign<=0||e.sign<=0||e.sign===1&&e.layer===0&&e.mag===1?w.dNaN:this.layer===0&&e.layer===0?U(this.sign,0,Math.log(this.mag)/Math.log(e.mag)):w.div(this.log10(),e.log10())}log2(){return this.sign<=0?w.dNaN:this.layer===0?U(this.sign,0,Math.log2(this.mag)):this.layer===1?U(Math.sign(this.mag),0,Math.abs(this.mag)*3.321928094887362):this.layer===2?U(Math.sign(this.mag),1,Math.abs(this.mag)+.5213902276543247):U(Math.sign(this.mag),this.layer-1,Math.abs(this.mag))}ln(){return this.sign<=0?w.dNaN:this.layer===0?U(this.sign,0,Math.log(this.mag)):this.layer===1?U(Math.sign(this.mag),0,Math.abs(this.mag)*2.302585092994046):this.layer===2?U(Math.sign(this.mag),1,Math.abs(this.mag)+.36221568869946325):U(Math.sign(this.mag),this.layer-1,Math.abs(this.mag))}logarithm(e){return this.log(e)}pow(e){const t=x(e),n=this,r=t;if(n.sign===0)return r.eq(0)?Y(1,0,1):n;if(n.sign===1&&n.layer===0&&n.mag===1)return n;if(r.sign===0)return Y(1,0,1);if(r.sign===1&&r.layer===0&&r.mag===1)return n;const i=n.absLog10().mul(r).pow10();return this.sign===-1?Math.abs(r.toNumber()%2)%2===1?i.neg():Math.abs(r.toNumber()%2)%2===0?i:w.dNaN:i}pow10(){if(!Number.isFinite(this.layer)||!Number.isFinite(this.mag))return w.dNaN;let e=this;if(e.layer===0){const t=Math.pow(10,e.sign*e.mag);if(Number.isFinite(t)&&Math.abs(t)>=.1)return U(1,0,t);if(e.sign===0)return w.dOne;e=Y(e.sign,e.layer+1,Math.log10(e.mag))}return e.sign>0&&e.mag>=0?U(e.sign,e.layer+1,e.mag):e.sign<0&&e.mag>=0?U(-e.sign,e.layer+1,-e.mag):w.dOne}pow_base(e){return x(e).pow(this)}root(e){const t=x(e);return this.pow(t.recip())}factorial(){return this.mag<0?this.add(1).gamma():this.layer===0?this.add(1).gamma():this.layer===1?w.exp(w.mul(this,w.ln(this).sub(1))):w.exp(this)}gamma(){if(this.mag<0)return this.recip();if(this.layer===0){if(this.lt(Y(1,0,24)))return w.fromNumber(wi(this.sign*this.mag));const e=this.mag-1;let t=.9189385332046727;t=t+(e+.5)*Math.log(e),t=t-e;const n=e*e;let r=e,i=12*r,s=1/i,a=t+s;if(a===t||(t=a,r=r*n,i=360*r,s=1/i,a=t-s,a===t))return w.exp(t);t=a,r=r*n,i=1260*r;let o=1/i;return t=t+o,r=r*n,i=1680*r,o=1/i,t=t-o,w.exp(t)}else return this.layer===1?w.exp(w.mul(this,w.ln(this).sub(1))):w.exp(this)}lngamma(){return this.gamma().ln()}exp(){return this.mag<0?w.dOne:this.layer===0&&this.mag<=709.7?w.fromNumber(Math.exp(this.sign*this.mag)):this.layer===0?U(1,1,this.sign*Math.log10(Math.E)*this.mag):this.layer===1?U(1,2,this.sign*(Math.log10(.4342944819032518)+this.mag)):U(1,this.layer+1,this.sign*this.mag)}sqr(){return this.pow(2)}sqrt(){if(this.layer===0)return w.fromNumber(Math.sqrt(this.sign*this.mag));if(this.layer===1)return U(1,2,Math.log10(this.mag)-.3010299956639812);{const e=w.div(Y(this.sign,this.layer-1,this.mag),Y(1,0,2));return e.layer+=1,e.normalize(),e}}cube(){return this.pow(3)}cbrt(){return this.pow(1/3)}tetrate(e=2,t=Y(1,0,1)){if(e===1)return w.pow(this,t);if(e===0)return new w(t);if(this.eq(w.dOne))return w.dOne;if(this.eq(-1))return w.pow(this,t);if(e===Number.POSITIVE_INFINITY){const i=this.toNumber();if(i<=1.444667861009766&&i>=.06598803584531254){if(i>1.444667861009099)return w.fromNumber(Math.E);const s=w.ln(this).neg();return s.lambertw().div(s)}else return i>1.444667861009766?w.fromNumber(Number.POSITIVE_INFINITY):w.dNaN}if(this.eq(w.dZero)){let i=Math.abs((e+1)%2);return i>1&&(i=2-i),w.fromNumber(i)}if(e<0)return w.iteratedlog(t,this,-e);t=x(t);const n=e;e=Math.trunc(e);const r=n-e;if(this.gt(w.dZero)&&this.lte(1.444667861009766)){e=Math.min(1e4,e);for(let i=0;i<e;++i){const s=t;if(t=this.pow(t),s.eq(t))return t}if(r!=0){const i=this.pow(t);return t.mul(1-r).add(i.mul(r))}return t}r!==0&&(t.eq(w.dOne)?this.gt(10)?t=this.pow(r):(t=w.fromNumber(w.tetrate_critical(this.toNumber(),r)),this.lt(2)&&(t=t.sub(1).mul(this.minus(1)).plus(1))):this.eq(10)?t=t.layeradd10(r):t=t.layeradd(r,this));for(let i=0;i<e;++i){if(t=this.pow(t),!isFinite(t.layer)||!isFinite(t.mag))return t.normalize();if(t.layer-this.layer>3)return Y(t.sign,t.layer+(e-i-1),t.mag);if(i>1e4)return t}return t}iteratedexp(e=2,t=Y(1,0,1)){return this.tetrate(e,t)}iteratedlog(e=10,t=1){if(t<0)return w.tetrate(e,-t,this);e=x(e);let n=w.fromDecimal(this);const r=t;t=Math.trunc(t);const i=r-t;if(n.layer-e.layer>3){const s=Math.min(t,n.layer-e.layer-3);t-=s,n.layer-=s}for(let s=0;s<t;++s){if(n=n.log(e),!isFinite(n.layer)||!isFinite(n.mag))return n.normalize();if(s>1e4)return n}return i>0&&i<1&&(e.eq(10)?n=n.layeradd10(-i):n=n.layeradd(-i,e)),n}slog(e=10,t=100){let n=.001,r=!1,i=!1,s=this.slog_internal(e).toNumber();for(let a=1;a<t;++a){const l=new w(e).tetrate(s).gt(this);if(a>1&&i!=l&&(r=!0),i=l,r?n/=2:n*=2,n=Math.abs(n)*(l?-1:1),s+=n,n===0)break}return w.fromNumber(s)}slog_internal(e=10){if(e=x(e),e.lte(w.dZero)||e.eq(w.dOne))return w.dNaN;if(e.lt(w.dOne))return this.eq(w.dOne)?w.dZero:this.eq(w.dZero)?w.dNegOne:w.dNaN;if(this.mag<0||this.eq(w.dZero))return w.dNegOne;let t=0,n=w.fromDecimal(this);if(n.layer-e.layer>3){const r=n.layer-e.layer-3;t+=r,n.layer-=r}for(let r=0;r<100;++r)if(n.lt(w.dZero))n=w.pow(e,n),t-=1;else{if(n.lte(w.dOne))return w.fromNumber(t+w.slog_critical(e.toNumber(),n.toNumber()));t+=1,n=w.log(n,e)}return w.fromNumber(t)}static slog_critical(e,t){return e>10?t-1:w.critical_section(e,t,Ni)}static tetrate_critical(e,t){return w.critical_section(e,t,_i)}static critical_section(e,t,n){t*=10,t<0&&(t=0),t>10&&(t=10),e<2&&(e=2),e>10&&(e=10);let r=0,i=0;for(let a=0;a<He.length;++a)if(He[a]==e){r=n[a][Math.floor(t)],i=n[a][Math.ceil(t)];break}else if(He[a]<e&&He[a+1]>e){const o=(e-He[a])/(He[a+1]-He[a]);r=n[a][Math.floor(t)]*(1-o)+n[a+1][Math.floor(t)]*o,i=n[a][Math.ceil(t)]*(1-o)+n[a+1][Math.ceil(t)]*o;break}const s=t-Math.floor(t);return r<=0||i<=0?r*(1-s)+i*s:Math.pow(e,Math.log(r)/Math.log(e)*(1-s)+Math.log(i)/Math.log(e)*s)}layeradd10(e){e=w.fromValue_noAlloc(e).toNumber();const t=w.fromDecimal(this);if(e>=1){t.mag<0&&t.layer>0?(t.sign=0,t.mag=0,t.layer=0):t.sign===-1&&t.layer==0&&(t.sign=1,t.mag=-t.mag);const n=Math.trunc(e);e-=n,t.layer+=n}if(e<=-1){const n=Math.trunc(e);if(e-=n,t.layer+=n,t.layer<0)for(let r=0;r<100;++r){if(t.layer++,t.mag=Math.log10(t.mag),!isFinite(t.mag))return t.sign===0&&(t.sign=1),t.layer<0&&(t.layer=0),t.normalize();if(t.layer>=0)break}}for(;t.layer<0;)t.layer++,t.mag=Math.log10(t.mag);return t.sign===0&&(t.sign=1,t.mag===0&&t.layer>=1&&(t.layer-=1,t.mag=1)),t.normalize(),e!==0?t.layeradd(e,10):t}layeradd(e,t){const r=this.slog(t).toNumber()+e;return r>=0?w.tetrate(t,r):Number.isFinite(r)?r>=-1?w.log(w.tetrate(t,r+1),t):w.log(w.log(w.tetrate(t,r+2),t),t):w.dNaN}lambertw(){if(this.lt(-.3678794411710499))throw Error("lambertw is unimplemented for results less than -1, sorry!");if(this.mag<0)return w.fromNumber(bn(this.toNumber()));if(this.layer===0)return w.fromNumber(bn(this.sign*this.mag));if(this.layer===1)return yn(this);if(this.layer===2)return yn(this);if(this.layer>=3)return Y(this.sign,this.layer-1,this.mag);throw new Error("Unhandled behavior in lambertw()")}ssqrt(){if(this.sign==1&&this.layer>=3)return Y(this.sign,this.layer-1,this.mag);const e=this.ln();return e.div(e.lambertw())}pentate(e=2,t=Y(1,0,1)){t=x(t);const n=e;e=Math.trunc(e);const r=n-e;r!==0&&(t.eq(w.dOne)?(++e,t=w.fromNumber(r)):this.eq(10)?t=t.layeradd10(r):t=t.layeradd(r,this));for(let i=0;i<e;++i){if(t=this.tetrate(t.toNumber()),!isFinite(t.layer)||!isFinite(t.mag))return t.normalize();if(i>10)return t}return t}sin(){return this.mag<0?this:this.layer===0?w.fromNumber(Math.sin(this.sign*this.mag)):Y(0,0,0)}cos(){return this.mag<0?w.dOne:this.layer===0?w.fromNumber(Math.cos(this.sign*this.mag)):Y(0,0,0)}tan(){return this.mag<0?this:this.layer===0?w.fromNumber(Math.tan(this.sign*this.mag)):Y(0,0,0)}asin(){return this.mag<0?this:this.layer===0?w.fromNumber(Math.asin(this.sign*this.mag)):Y(Number.NaN,Number.NaN,Number.NaN)}acos(){return this.mag<0?w.fromNumber(Math.acos(this.toNumber())):this.layer===0?w.fromNumber(Math.acos(this.sign*this.mag)):Y(Number.NaN,Number.NaN,Number.NaN)}atan(){return this.mag<0?this:this.layer===0?w.fromNumber(Math.atan(this.sign*this.mag)):w.fromNumber(Math.atan(this.sign*(1/0)))}sinh(){return this.exp().sub(this.negate().exp()).div(2)}cosh(){return this.exp().add(this.negate().exp()).div(2)}tanh(){return this.sinh().div(this.cosh())}asinh(){return w.ln(this.add(this.sqr().add(1).sqrt()))}acosh(){return w.ln(this.add(this.sqr().sub(1).sqrt()))}atanh(){return this.abs().gte(1)?Y(Number.NaN,Number.NaN,Number.NaN):w.ln(this.add(1).div(w.fromNumber(1).sub(this))).div(2)}ascensionPenalty(e){return e===0?this:this.root(w.pow(10,e))}egg(){return this.add(9)}lessThanOrEqualTo(e){return this.cmp(e)<1}lessThan(e){return this.cmp(e)<0}greaterThanOrEqualTo(e){return this.cmp(e)>-1}greaterThan(e){return this.cmp(e)>0}};let N=w;N.fromStringCache=new di(bi);N.dZero=Y(0,0,0);N.dOne=Y(1,0,1);N.dNegOne=Y(-1,0,1);N.dTwo=Y(1,0,2);N.dTen=Y(1,0,10);N.dNaN=Y(Number.NaN,Number.NaN,Number.NaN);N.dInf=Y(1,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY);N.dNegInf=Y(-1,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);N.dNumberMax=U(1,0,Number.MAX_VALUE);N.dNumberMin=U(1,0,Number.MIN_VALUE);x=N.fromValue_noAlloc;U=N.fromComponents;Y=N.fromComponents_noNormalize;N.fromMantissaExponent;N.fromMantissaExponent_noNormalize;const ki=new N(1);function gt(e,t,n=!0){let r=N.log10(e).floor(),i=N.div(e,N.pow(10,r));i.toStringWithDecimalPlaces(t)==="10"&&(i=ki,r=r.add(1));const s=r.gte(1e9)?Ee(r,Math.max(Math.max(t,3),ee.defaultDecimalsShown)):r.gte(1e4)?Rt(r,0):r.toStringWithDecimalPlaces(0);return n?i.toStringWithDecimalPlaces(t)+"e"+s:"e"+s}function Rt(e,t){if(e==null)return"NaN";if(e=new N(e),e.mag<.001)return 0 .toFixed(t);const r=e.toStringWithDecimalPlaces(t).split(".");return r[0]=r[0].replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,"),r.length==1?r[0]:r[0]+"."+r[1]}function Pn(e,t){return e==null?"NaN":(e=new N(e),e.mag<1e-4?0 .toFixed(t):(e.mag<.1&&t!==0&&(t=Math.max(Math.max(t,e.log10().negate().ceil().toNumber()),ee.defaultDecimalsShown)),e.toStringWithDecimalPlaces(t)))}const Si=new N("eeee1000"),Ci=new N("e100000"),_n=new N("e1000");new N(1e9);const Yt=new N(1e6),xi=new N(1e3);new N(.98);const Mi=new N(.001),Ii=new N(0);function Ee(e,t,n){if(t==null&&(t=ee.defaultDecimalsShown),n=n!=null?n:ee.defaultShowSmall,e=new N(e),isNaN(e.sign)||isNaN(e.layer)||isNaN(e.mag))return"NaN";if(e.sign<0)return"-"+Ee(e.neg(),t);if(e.mag===Number.POSITIVE_INFINITY)return"Infinity";if(e.gte(Si)){const r=e.slog();return r.gte(Yt)?"F"+Ee(r.floor()):N.pow(10,r.sub(r.floor())).toStringWithDecimalPlaces(3)+"F"+Rt(r.floor(),0)}else{if(e.gte(Ci))return gt(e,0,!1);if(e.gte(_n))return gt(e,0);if(e.gte(Yt))return gt(e,t);if(e.gte(xi))return Rt(e,0);if(e.gte(Mi)||!n)return Pn(e,t);if(e.eq(Ii))return 0 .toFixed(t)}return e=En(e),e.lt(_n)?gt(e,t).replace(/([^(?:e|F)]*)$/,"-$1"):Ee(e,t)+"\u207B\xB9"}function be(e){return e=new N(e),e.sign<0?"-"+be(e.neg()):e.gte(Yt)?Ee(e):Ee(e,0)}function Tn(e){return N.lt(e,0)?"-"+Tn(N.neg(e)):N.gt(e,2**51)?Ee(N.div(e,31536e3))+"y":(e=new N(e).toNumber(),e<60?Ee(e)+"s":e<3600?be(Math.floor(e/60))+"m "+Ee(e%60)+"s":e<86400?be(Math.floor(e/3600))+"h "+be(Math.floor(e/60)%60)+"m "+be(e%60)+"s":e<31536e3?be(Math.floor(e/84600)%365)+"d "+be(Math.floor(e/3600)%24)+"h "+be(Math.floor(e/60)%60)+"m":be(Math.floor(e/31536e3))+"y "+be(Math.floor(e/84600)%365)+"d "+be(Math.floor(e/3600)%24)+"h")}function $i(e,t,n){e=new N(e);let r=e.toStringWithDecimalPlaces(t);return new N(r).gte(n)&&(r=N.sub(n,Math.pow(.1,t)).toStringWithDecimalPlaces(t)),r}function Li(e,t){return Ee(e,t,!0)}function En(e){let t=N.log10(e).ceil();const n=N.div(e,N.pow(10,t));return t=t.neg(),e=new N(10).pow(t).times(n),e}var Ri=Object.freeze(Object.defineProperty({__proto__:null,default:N,exponentialFormat:gt,commaFormat:Rt,regularFormat:Pn,format:Ee,formatWhole:be,formatTime:Tn,toPlaces:$i,formatSmall:Li,invertOOM:En},Symbol.toStringTag,{value:"Module"}));const{exponentialFormat:Fi,commaFormat:Pi,regularFormat:Ti,format:zn,formatWhole:On,formatTime:en,toPlaces:Ei,formatSmall:zi,invertOOM:Oi}=Ri;window.Decimal=N;window.exponentialFormat=Fi;window.commaFormat=Pi;window.regularFormat=Ti;window.format=zn;window.formatWhole=On;window.formatTime=en;window.toPlaces=Ei;window.formatSmall=zi;window.invertOOM=Oi;function Di(e){let t=e.replace(/([A-Z])/g," $1");return t=t.charAt(0).toUpperCase()+t.slice(1),t}function Ai(e){return(e[0]+e.slice(1).replace(/[A-Z]/g,t=>`-${t}`)).toLowerCase()}function Ft(e){return typeof e=="function"}var G=(e=>(e.Up="Up",e.Down="Down",e.Left="Left",e.Right="Right",e.Default="Up",e))(G||{});const yt=Symbol("DoNotCache");function Z(e,t){const n=e[t];Ft(n)&&n.length===0&&!n[yt]?e[t]=k(n.bind(e)):Ft(n)&&(e[t]=n.bind(e),e[t][yt]=!0)}function Nn(e){return Ft(e)&&!e[yt]&&(e=k(e)),e}const Dt=Symbol("Component"),At=Symbol("GatherProps");let Vi=0;function Dn(e="feature-"){return e+Vi++}var Pt=(e=>(e[e.Visible=0]="Visible",e[e.Hidden=1]="Hidden",e[e.None=2]="None",e))(Pt||{});function Vt(e){const t=u(e);return t!==2&&t!==!1}function ke(e){return e[yt]=!0,e}function ge(e,t,n){e[t]===void 0&&n!=null&&(e[t]=n)}function tn(e,...t){const n=[],r=i=>{Object.keys(i).forEach(s=>{const a=i[s];a!=null&&typeof a=="object"&&(t.includes(a.type)?n.push(a):!(a instanceof N)&&!Pe(a)&&r(a))})};return r(e),n}var ae=window.state=zt({lastTenTicks:[],hasNaN:!1,NaNPath:[],errors:dt([])});const De={variables:{"--foreground":"#dfdfdf","--background":"#0f0f0f","--feature-foreground":"#0f0f0f","--tooltip-background":"rgba(0, 0, 0, 0.75)","--raised-background":"#0f0f0f","--points":"#ffffff","--locked":"#bf8f8f","--highlighted":"#333","--bought":"#77bf5f","--danger":"rgb(220, 53, 69)","--link":"#02f2f2","--outline":"#dfdfdf","--accent1":"#627a82","--accent2":"#658262","--accent3":"#7c6282","--border-radius":"15px","--modal-border":"solid 2px var(--color)","--feature-margin":"0px"},floatingTabs:!1,mergeAdjacent:!0,showPin:!0};var nn=(e=>(e.Classic="classic",e.Paper="paper",e.Nordic="nordic",e.Aqua="aqua",e.Console="console",e))(nn||{}),Te={classic:De,paper:{...De,variables:{...De.variables,"--background":"#2a323d","--feature-foreground":"#000","--raised-background":"#333c4a","--locked":"#3a3e45","--bought":"#5C8A58","--outline":"#333c4a","--border-radius":"4px","--modal-border":"","--feature-margin":"5px"}},nordic:{...De,variables:{...De.variables,"--foreground":"#D8DEE9","--background":"#2E3440","--feature-foreground":"#000","--raised-background":"#3B4252","--points":"#E5E9F0","--locked":"#4c566a","--highlighted":"#434c5e","--bought":"#8FBCBB","--danger":"#D08770","--link":"#88C0D0","--outline":"#3B4252","--accent1":"#B48EAD","--accent2":"#A3BE8C","--accent3":"#EBCB8B","--border-radius":"4px","--modal-border":"solid 2px #3B4252","--feature-margin":"5px"}},aqua:{...De,variables:{...De.variables,"--foreground":"#bfdfff","--background":"#001f3f","--tooltip-background":"rgba(0, 15, 31, 0.75)","--raised-background":"#001f3f","--points":"#dfefff","--locked":"#c4a7b3","--outline":"#bfdfff"}},console:{...De,variables:{...De.variables,"--foreground":"#F2F2F2","--background":"#000000","--feature-foreground":"#13A10E","--raised-background":"#272727","--points":"#F2F2F2","--locked":"#272727","--danger":"#C50F1F","--link":"#3A96DD","--outline":"#13A10E","--accent1":"#10570D","--border-radius":"4px","--modal-border":"solid 2px #13A10E","--feature-margin":"5px"}}};const _e=Mn();"fonts"in document&&(document.fonts.onloadingdone=()=>_e.emit("fontsLoaded"));var ji=Object.freeze(Object.defineProperty({__proto__:null,globalBus:_e},Symbol.toStringTag,{value:"Module"}));function An(e={}){return Object.assign({id:`${ee.id}-0`,name:"Default Save",tabs:ee.initialTabs.slice(),time:Date.now(),autosave:!0,timePlayed:0,keepGoing:!1,modID:ee.id,modVersion:ee.versionNumber,layers:{}},e)}function Se(e){const t=Ue.compressToUTF16($n(e!=null?e:J));return localStorage.setItem((e!=null?e:J).id,t),t}async function Bi(){Zi();try{let e=localStorage.getItem(te.active);if(e==null){await Je(ot());return}if(e[0]!=="{")if(e[0]==="e")e=decodeURIComponent(escape(atob(e)));else if(e[0]==="\u1BE1")e=Ue.decompressFromUTF16(e);else throw"Unable to determine save encoding";const t=JSON.parse(e);if(t.modID!==ee.id){await Je(ot());return}t.id=te.active,await Je(t)}catch(e){console.error(`Failed to load save. Falling back to new save.
`,e),await Je(ot())}}function ot(){const e=It(),t=An({id:e});return Se(t),te.saves.push(e),t}function It(){let e,t=0;do e=`${ee.id}-${t++}`;while(localStorage.getItem(e)!=null);return e}const qi=B(!1);async function Je(e){console.info("Loading save",e),qi.value=!0;const{layers:t,removeLayer:n,addLayer:r}=await bt(()=>Promise.resolve().then(function(){return qo}),void 0),{fixOldSave:i,getInitialLayers:s}=await bt(()=>Promise.resolve().then(function(){return Xd}),void 0);for(const a in t){const o=t[a];o&&n(o)}s(e).forEach(a=>r(a,e)),e=An(e),e.time=Date.now(),e.modVersion!==ee.versionNumber&&(i(e.modVersion,e),e.modVersion=ee.versionNumber),Object.assign(J,e),te.active=J.id,_e.emit("onLoad")}setInterval(()=>{J.autosave&&Se()},1e3);window.onbeforeunload=()=>{J.autosave&&Se()};window.save=Se;const Ui=window.hardReset=async()=>{await Je(ot())};window.deleteLowerSaves=()=>{const e=Object.values(te.saves).indexOf(J.id)+1;Object.values(te.saves).slice(e).forEach(t=>localStorage.removeItem(t)),te.saves=te.saves.slice(0,e)};const _t=dt({active:"",saves:[],showTPS:!0,theme:nn.Nordic,unthrottled:!1,alignUnits:!1});Ve(_t,e=>{const t=Ue.compressToUTF16(JSON.stringify(e));localStorage.setItem(ee.id,t)},{deep:!0});var te=window.settings=_t;window.hardResetSettings=()=>{const e={active:"",saves:[],showTPS:!0,theme:nn.Nordic,alignUnits:!1};_e.emit("loadSettings",e),Object.assign(_t,e),Ui()};function Zi(){try{let e=localStorage.getItem(ee.id);if(e!=null&&e!==""){if(e[0]!=="{")if(e[0]==="e")e=decodeURIComponent(escape(atob(e)));else if(e[0]==="\u1BE1")e=Ue.decompressFromUTF16(e);else{console.warn("Unable to determine settings encoding",e);return}const t=JSON.parse(e);typeof t=="object"&&Object.assign(_t,t)}_e.emit("loadSettings",_t)}catch{}}const Wi=dt([]),Vn=dt([]);function Gi(e){Vn.push(e)}const Hi=dt([]),Yi={class:"table"};A({__name:"Column",setup(e){const t=k(()=>Te[te.theme].mergeAdjacent);return(n,r)=>(_(),C("div",Yi,[m("div",{class:ne(["col",{mergeAdjacent:t.value}])},[ze(n.$slots,"default")],2)]))}});const Ji={class:"table"};A({__name:"Row",setup(e){const t=k(()=>Te[te.theme].mergeAdjacent);return(n,r)=>(_(),C("div",Ji,[m("div",{class:ne(["row",{mergeAdjacent:t.value}])},[ze(n.$slots,"default")],2)]))}});function me(e,t="span"){return typeof e=="function"?A({render:e}):typeof e=="string"?e.length>0?(e=e.trim(),e.charAt(0)!=="<"&&(e=`<${t}>${e}</${t}>`),A({template:e})):A({render:()=>({})}):e}function Qe(e){if(jn(e))return typeof e=="function"?e():me(e);const t=e[Dt];return R(t,e[At](),null)}function Ki(e){if(jn(e))return typeof e=="function"?e():typeof e=="string"?R(X,null,[e]):R(e,null,null);const t=e[Dt];return R(t,e[At](),null)}function jn(e){return typeof e=="string"?!0:typeof e=="object"?e==null?!1:"render"in e||"component"in e:typeof e=="function"&&e[yt]===!0}function Xi(e,t="div"){const n=St();return Ot(()=>{n.value=me(et(e),t)}),n}function jt(e,t="div"){const n=St(null);return Ot(()=>{const r=et(e);n.value=r==""||r==null?null:me(r,t)}),n}function et(e){return u(u(e))}function Fe(...e){return e.includes(Object)||e.push(Object),e}function Qi(e){return Object.keys(e).reduce((t,n)=>(t[Ai(n)]=e[n],t),{})}const es=A({__name:"Context",emits:["updateNodes"],setup(e,{emit:t}){var p;const n=B({}),r=new ResizeObserver(o),i=B(null);Xt(()=>{const b=i.value;b!=null&&r.observe(b)});let s=!0,a=B((p=i.value)==null?void 0:p.getBoundingClientRect());function o(){s&&(s=!1,ht(()=>{var b;a.value=(b=i.value)==null?void 0:b.getBoundingClientRect(),Object.values(n.value).filter(d=>d).forEach(d=>d.rect=d.element.getBoundingClientRect()),t("updateNodes",n.value),s=!0}))}_e.on("fontsLoaded",o);const l={attributes:!1,childList:!0,subtree:!1};Mt(rn,(b,d)=>{const c=new MutationObserver(()=>v(b));c.observe(d,l),n.value[b]={element:d,observer:c,rect:d.getBoundingClientRect()},o()}),Mt(sn,b=>{var d;(d=n.value[b])==null||d.observer.disconnect(),n.value[b]=void 0,o()}),Mt(Un,n),Mt(Zn,a);function v(b){const d=n.value[b];d!=null&&(d.rect=d.element.getBoundingClientRect(),t("updateNodes",n.value))}return(b,d)=>(_(),C(X,null,[ze(b.$slots,"default",{},void 0,!0),m("div",{ref_key:"resizeListener",ref:i,class:"resize-listener"},null,512)],64))}});var Bn=W(es,[["__scopeId","data-v-2b1dc1bc"]]);const ts=["onPointerdown"],ns={class:"modal-wrapper"},rs={class:"modal-container"},is={class:"modal-header"},ss={class:"modal-body"},os={class:"modal-footer"},as=m("div",{class:"modal-default-flex-grow"},null,-1),nt=A({__name:"Modal",props:{modelValue:{type:Boolean}},emits:["update:modelValue"],setup(e,{expose:t,emit:n}){const i=Ce(e),s=k(()=>u(i.modelValue)||o.value);function a(){n("update:modelValue",!1)}const o=B(!1),l=B(null),v=k(()=>{var p,b;return(b=(p=l.value)==null?void 0:p.nodes)!=null?b:null});return t({isOpen:s,nodes:v}),(p,b)=>(_(),O(vr,{to:"#modal-root"},[R(mt,{name:"modal",onBeforeEnter:b[0]||(b[0]=d=>o.value=!0),onAfterLeave:b[1]||(b[1]=d=>o.value=!1)},{default:j(()=>[Qt(m("div",Ze({class:"modal-mask",onPointerdown:ut(a,["self"])},p.$attrs),[m("div",ns,[m("div",rs,[m("div",is,[ze(p.$slots,"header",{shown:s.value},()=>[H(" default header ")])]),m("div",ss,[R(Bn,{ref_key:"contextRef",ref:l},{default:j(()=>[ze(p.$slots,"body",{shown:s.value},()=>[H(" default body ")])]),_:3},512)]),m("div",os,[ze(p.$slots,"footer",{shown:s.value},()=>[m("div",{class:"modal-default-footer"},[as,m("button",{class:"button modal-default-button",onClick:a}," Close ")])])])])])],16,ts),[[pr,p.modelValue]])]),_:3})]))}}),Ye=Symbol("ProxyState");function Ie(e,t={}){const n=t;let r=!1,i=!1;function s(){return r||(i&&console.error("Cyclical dependency detected. Cannot evaluate lazy proxy."),i=!0,Object.assign(n,e.call(n,n)),r=!0),n}return new Proxy(n,{get(a,o){if(o===Ye)return s();const l=s()[o];return l!=null&&typeof l=="object"&&Ke in l?l[Ke]:l},set(a,o,l){return s()[o]=l,!0},has(a,o){return o===Ye?!0:Reflect.has(s(),o)},ownKeys(){return Reflect.ownKeys(s())},getOwnPropertyDescriptor(a,o){return r||(Object.assign(n,e.call(n,n)),r=!0),Object.getOwnPropertyDescriptor(a,o)}})}const qn=N.ln(10);function pt(e){return e}function ls(e,t){return F(t)?t.invert(N.neg(e)):(console.error("Could not invert due to no input being a variable"),0)}function us(e,t){return F(t)?t.isIntegrable()?f.neg(t.getIntegralFormula(e)):(console.error("Could not integrate due to variable not being integrable"),f.constant(0)):(console.error("Could not integrate due to no input being a variable"),f.constant(0))}function cs(e){return f.neg(e)}function ds(e,t,n){return F(t)?t.invert(N.sub(e,le(n))):F(n)?n.invert(N.sub(e,le(t))):(console.error("Could not invert due to no input being a variable"),0)}function fs(e,t,n){var r,i;if(F(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),f.constant(0);const s=t.getIntegralFormula(e);return f.times(n,(r=t.innermostVariable)!=null?r:0).add(s)}else if(F(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),f.constant(0);const s=n.getIntegralFormula(e);return f.times(t,(i=n.innermostVariable)!=null?i:0).add(s)}return console.error("Could not integrate due to no input being a variable"),f.constant(0)}function gs(e,t,n){if(F(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),f.constant(0);const r=t.getIntegralFormula(e);return f.add(r,n)}else if(F(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),f.constant(0);const r=n.getIntegralFormula(e);return f.add(r,t)}return console.error("Could not integrate due to no input being a variable"),f.constant(0)}function ps(e,t,n){return F(t)?t.invert(N.add(e,le(n))):F(n)?n.invert(N.sub(le(t),e)):(console.error("Could not invert due to no input being a variable"),0)}function vs(e,t,n){var r,i;if(F(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),f.constant(0);const s=t.getIntegralFormula(e);return f.sub(s,f.times(n,(r=t.innermostVariable)!=null?r:0))}else if(F(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),f.constant(0);const s=n.getIntegralFormula(e);return f.times(t,(i=n.innermostVariable)!=null?i:0).sub(s)}return console.error("Could not integrate due to no input being a variable"),f.constant(0)}function hs(e,t,n){if(F(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),f.constant(0);const r=t.getIntegralFormula(e);return f.sub(r,n)}else if(F(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),f.constant(0);const r=n.getIntegralFormula(e);return f.sub(r,t)}return console.error("Could not integrate due to no input being a variable"),f.constant(0)}function ms(e,t,n){return F(t)?t.invert(N.div(e,le(n))):F(n)?n.invert(N.div(e,le(t))):(console.error("Could not invert due to no input being a variable"),0)}function bs(e,t,n){if(F(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),f.constant(0);const r=t.getIntegralFormula(e);return f.times(r,n)}else if(F(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),f.constant(0);const r=n.getIntegralFormula(e);return f.times(r,t)}return console.error("Could not integrate due to no input being a variable"),f.constant(0)}function ys(e,t,n){return F(t)?f.div(e,n):F(n)?f.div(e,t):(console.error("Could not apply substitution due to no input being a variable"),f.constant(0))}function _s(e,t,n){return F(t)?t.invert(N.mul(e,le(n))):F(n)?n.invert(N.div(le(t),e)):(console.error("Could not invert due to no input being a variable"),0)}function Ns(e,t,n){if(F(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),f.constant(0);const r=t.getIntegralFormula(e);return f.div(r,n)}else if(F(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),f.constant(0);const r=n.getIntegralFormula(e);return f.div(t,r)}return console.error("Could not integrate due to no input being a variable"),f.constant(0)}function ws(e,t,n){return F(t)?f.mul(e,n):F(n)?f.mul(e,t):(console.error("Could not apply substitution due to no input being a variable"),f.constant(0))}function ks(e,t){return F(t)?t.invert(N.recip(e)):(console.error("Could not invert due to no input being a variable"),0)}function Ss(e,t){if(F(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),f.constant(0);const n=t.getIntegralFormula(e);return f.ln(n)}return console.error("Could not integrate due to no input being a variable"),f.constant(0)}function Cs(e,t){return F(t)?t.invert(N.pow10(e)):(console.error("Could not invert due to no input being a variable"),0)}function xs(e){return N.ln(e).sub(1).times(e).div(qn)}function Ms(e,t){if(F(t)){const n=qn.times(e);return t.invert(n.div(n.div(Math.E).lambertw()))}return console.error("Could not invert due to no input being a variable"),0}function Is(e,t){return F(t)?t.isIntegrable()?new f({inputs:[t.getIntegralFormula(e)],evaluate:xs,invert:Ms}):(console.error("Could not integrate due to variable not being integrable"),f.constant(0)):(console.error("Could not integrate due to no input being a variable"),f.constant(0))}function $s(e,t,n){return F(t)?t.invert(N.pow(le(n),e)):F(n)?n.invert(N.root(le(t),e)):(console.error("Could not invert due to no input being a variable"),0)}function Ls(e,t){return N.ln(e).sub(1).times(e).div(N.ln(t))}function Rs(e,t,n){if(F(t)){const r=N.ln(le(n)).times(e);return t.invert(r.div(r.div(Math.E).lambertw()))}return console.error("Could not invert due to no input being a variable"),0}function Fs(e,t,n){return F(t)?t.isIntegrable()?new f({inputs:[t.getIntegralFormula(e),n],evaluate:Ls,invert:Rs}):(console.error("Could not integrate due to variable not being integrable"),f.constant(0)):(console.error("Could not integrate due to no input being a variable"),f.constant(0))}function Ps(e,t){return F(t)?t.invert(N.pow(2,e)):(console.error("Could not invert due to no input being a variable"),0)}function Ts(e){return N.ln(e).sub(1).times(e).div(N.ln(2))}function Es(e,t){if(F(t)){const n=N.ln(2).times(e);return t.invert(n.div(n.div(Math.E).lambertw()))}return console.error("Could not invert due to no input being a variable"),0}function zs(e,t){return F(t)?t.isIntegrable()?new f({inputs:[t.getIntegralFormula(e)],evaluate:Ts,invert:Es}):(console.error("Could not integrate due to variable not being integrable"),f.constant(0)):(console.error("Could not integrate due to no input being a variable"),f.constant(0))}function Os(e,t){return F(t)?t.invert(N.exp(e)):(console.error("Could not invert due to no input being a variable"),0)}function Ds(e){return N.ln(e).sub(1).times(e)}function As(e,t){return F(t)?t.invert(N.div(e,N.div(e,Math.E).lambertw())):(console.error("Could not invert due to no input being a variable"),0)}function Vs(e,t){return F(t)?t.isIntegrable()?new f({inputs:[t.getIntegralFormula(e)],evaluate:Ds,invert:As}):(console.error("Could not integrate due to variable not being integrable"),f.constant(0)):(console.error("Could not integrate due to no input being a variable"),f.constant(0))}function js(e,t,n){return F(t)?t.invert(N.root(e,le(n))):F(n)?n.invert(N.ln(e).div(N.ln(le(t)))):(console.error("Could not invert due to no input being a variable"),0)}function Bs(e,t,n){if(F(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),f.constant(0);const r=t.getIntegralFormula(e),i=f.add(n,1);return f.pow(r,i).div(i)}else if(F(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),f.constant(0);const r=n.getIntegralFormula(e);return f.pow(t,r).div(f.ln(t))}return console.error("Could not integrate due to no input being a variable"),f.constant(0)}function qs(e,t){return F(t)?t.invert(N.root(e,10)):(console.error("Could not invert due to no input being a variable"),0)}function Us(e,t){if(F(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),f.constant(0);const n=t.getIntegralFormula(e);return f.pow10(n).div(f.ln(10))}return console.error("Could not integrate due to no input being a variable"),f.constant(0)}function Zs(e,t,n){return F(t)?t.invert(N.ln(e).div(N.ln(le(n)))):F(n)?n.invert(N.root(le(t),e)):(console.error("Could not invert due to no input being a variable"),0)}function Ws(e,t,n){if(F(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),f.constant(0);const r=t.getIntegralFormula(e);return f.pow(n,r).div(f.ln(n))}else if(F(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),f.constant(0);const r=n.getIntegralFormula(e),i=f.add(t,1);return f.pow(r,i).div(i)}return console.error("Could not integrate due to no input being a variable"),f.constant(0)}function Gs(e,t,n){return F(t)?t.invert(N.root(e,N.recip(le(n)))):F(n)?n.invert(N.ln(le(t)).div(N.ln(e))):(console.error("Could not invert due to no input being a variable"),0)}function Hs(e,t,n){if(F(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),f.constant(0);const r=t.getIntegralFormula(e);return f.pow(r,f.recip(n).add(1)).times(n).div(f.add(n,1))}return console.error("Could not integrate due to no input being a variable"),f.constant(0)}function Ys(e,t){return F(t)?t.invert(N.ln(e)):(console.error("Could not invert due to no input being a variable"),0)}function Js(e,t){if(F(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),f.constant(0);const n=t.getIntegralFormula(e);return f.exp(n)}return console.error("Could not integrate due to no input being a variable"),f.constant(0)}function Ks(e,t=2,n=N.fromComponents_noNormalize(1,0,1)){const r=N.minabs(t,1e308).toNumber();return N.tetrate(e,r,n)}function Xs(e,t,n,r){return F(t)?t.invert(N.ssqrt(e)):(console.error("Could not invert due to no input being a variable"),0)}function Qs(e,t=2,n=N.fromComponents_noNormalize(1,0,1)){const r=N.minabs(t,1e308).toNumber();return N.iteratedexp(e,r,new N(n))}function eo(e,t,n,r){return F(t)?t.invert(N.iteratedlog(e,Math.E,N.minabs(1e308,le(n)).toNumber())):(console.error("Could not invert due to no input being a variable"),0)}function to(e,t=10,n=2){const r=N.minabs(n,1e308).toNumber();return N.iteratedlog(e,t,r)}function no(e,t=10){const n=N.minabs(t,1e308).toNumber();return N.slog(e,n)}function ro(e,t,n){return F(t)?t.invert(N.tetrate(e,N.minabs(1e308,le(n)).toNumber())):(console.error("Could not invert due to no input being a variable"),0)}function io(e,t,n){const r=N.minabs(t,1e308).toNumber();return N.layeradd(e,r,n)}function so(e,t,n,r){return F(t)?t.invert(N.layeradd(e,N.minabs(1e308,le(n)).negate().toNumber())):(console.error("Could not invert due to no input being a variable"),0)}function oo(e,t){return F(t)?t.invert(N.pow(Math.E,e).times(e)):(console.error("Could not invert due to no input being a variable"),0)}function ao(e,t){return F(t)?t.invert(N.tetrate(e,2)):(console.error("Could not invert due to no input being a variable"),0)}function lo(e,t,n){const r=N.minabs(t,1e308).toNumber();return N.pentate(e,r,n)}function uo(e,t){return F(t)?t.invert(N.asin(e)):(console.error("Could not invert due to no input being a variable"),0)}function co(e,t){if(F(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),f.constant(0);const n=t.getIntegralFormula(e);return f.cos(n).neg()}return console.error("Could not integrate due to no input being a variable"),f.constant(0)}function fo(e,t){return F(t)?t.invert(N.acos(e)):(console.error("Could not invert due to no input being a variable"),0)}function go(e,t){if(F(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),f.constant(0);const n=t.getIntegralFormula(e);return f.sin(n)}return console.error("Could not integrate due to no input being a variable"),f.constant(0)}function po(e,t){return F(t)?t.invert(N.atan(e)):(console.error("Could not invert due to no input being a variable"),0)}function vo(e,t){if(F(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),f.constant(0);const n=t.getIntegralFormula(e);return f.cos(n).ln().neg()}return console.error("Could not integrate due to no input being a variable"),f.constant(0)}function ho(e,t){return F(t)?t.invert(N.sin(e)):(console.error("Could not invert due to no input being a variable"),0)}function mo(e,t){if(F(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),f.constant(0);const n=t.getIntegralFormula(e);return f.asin(n).times(n).add(f.sqrt(f.sub(1,f.pow(n,2))))}return console.error("Could not integrate due to no input being a variable"),f.constant(0)}function bo(e,t){return F(t)?t.invert(N.cos(e)):(console.error("Could not invert due to no input being a variable"),0)}function yo(e,t){if(F(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),f.constant(0);const n=t.getIntegralFormula(e);return f.acos(n).times(n).sub(f.sqrt(f.sub(1,f.pow(n,2))))}return console.error("Could not integrate due to no input being a variable"),f.constant(0)}function _o(e,t){return F(t)?t.invert(N.tan(e)):(console.error("Could not invert due to no input being a variable"),0)}function No(e,t){if(F(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),f.constant(0);const n=t.getIntegralFormula(e);return f.atan(n).times(n).sub(f.ln(f.pow(n,2).add(1)).div(2))}return console.error("Could not integrate due to no input being a variable"),f.constant(0)}function wo(e,t){return F(t)?t.invert(N.asinh(e)):(console.error("Could not invert due to no input being a variable"),0)}function ko(e,t){if(F(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),f.constant(0);const n=t.getIntegralFormula(e);return f.cosh(n)}return console.error("Could not integrate due to no input being a variable"),f.constant(0)}function So(e,t){return F(t)?t.invert(N.acosh(e)):(console.error("Could not invert due to no input being a variable"),0)}function Co(e,t){if(F(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),f.constant(0);const n=t.getIntegralFormula(e);return f.sinh(n)}return console.error("Could not integrate due to no input being a variable"),f.constant(0)}function xo(e,t){return F(t)?t.invert(N.atanh(e)):(console.error("Could not invert due to no input being a variable"),0)}function Mo(e,t){if(F(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),f.constant(0);const n=t.getIntegralFormula(e);return f.cosh(n).ln()}return console.error("Could not integrate due to no input being a variable"),f.constant(0)}function Io(e,t){return F(t)?t.invert(N.sinh(e)):(console.error("Could not invert due to no input being a variable"),0)}function $o(e,t){if(F(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),f.constant(0);const n=t.getIntegralFormula(e);return f.asinh(n).times(n).sub(f.pow(n,2).add(1).sqrt())}return console.error("Could not integrate due to no input being a variable"),f.constant(0)}function Lo(e,t){return F(t)?t.invert(N.cosh(e)):(console.error("Could not invert due to no input being a variable"),0)}function Ro(e,t){if(F(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),f.constant(0);const n=t.getIntegralFormula(e);return f.acosh(n).times(n).sub(f.add(n,1).sqrt().times(f.sub(n,1).sqrt()))}return console.error("Could not integrate due to no input being a variable"),f.constant(0)}function Fo(e,t){return F(t)?t.invert(N.tanh(e)):(console.error("Could not invert due to no input being a variable"),0)}function Po(e,t){if(F(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),f.constant(0);const n=t.getIntegralFormula(e);return f.atanh(n).times(n).add(f.sub(1,f.pow(n,2)).ln().div(2))}return console.error("Could not integrate due to no input being a variable"),f.constant(0)}function ft(e){return(t,n)=>new f({inputs:[t,n],evaluate:e,invert:pt})}function F(e){return e instanceof oe&&e.hasVariable()}function le(e,t){return e instanceof oe?e.evaluate(t):u(e)}function To(){return f.pow(this,2).div(2)}function Eo(){return this}const de=class{constructor(e){this.negate=this.neg,this.negated=this.neg,this.sgn=this.sign,this.plus=this.add,this.subtract=this.sub,this.minus=this.sub,this.multiply=this.mul,this.times=this.mul,this.divide=this.div,this.divideBy=this.div,this.dividedBy=this.div,this.reciprocal=this.recip,this.reciprocate=this.recip,this.logarithm=this.log;let t;"inputs"in e&&(e.inputs=e.inputs.map(n=>typeof n=="object"&&Ke in n?n[Ke]:n)),"variable"in e?(typeof e.variable=="object"&&Ke in e.variable&&(e.variable=e.variable[Ke]),t=this.setupVariable(e)):"evaluate"in e?t=this.setupFormula(e):t=this.setupConstant(e),this.inputs=t.inputs,this.internalVariables=t.internalVariables,this.innermostVariable=t.innermostVariable,this.internalEvaluate=t.internalEvaluate,this.internalInvert=t.internalInvert,this.internalIntegrate=t.internalIntegrate,this.internalIntegrateInner=t.internalIntegrateInner,this.applySubstitution=t.applySubstitution}setupVariable({variable:e}){return{inputs:[e],internalVariables:1,innermostVariable:e,internalIntegrate:To,internalIntegrateInner:Eo,applySubstitution:pt}}setupConstant({inputs:e}){return e.length!==1&&console.error("Evaluate function is required if inputs is not length 1"),{inputs:e,internalVariables:0}}setupFormula(e){var d,c;const{inputs:t,evaluate:n,invert:r,integrate:i,integrateInner:s,applySubstitution:a}=e,o=t.reduce((g,h)=>g+(h instanceof de?h.internalVariables:0),0),l=t.find(g=>g instanceof de&&g.hasVariable()),v=o===1?l==null?void 0:l.innermostVariable:void 0,p=(d=l==null?void 0:l.isInvertible())!=null?d:!1,b=(c=l==null?void 0:l.isIntegrable())!=null?c:!1;return{inputs:t,internalEvaluate:n,internalInvert:p?r:void 0,internalIntegrate:b?i:void 0,internalIntegrateInner:s,applySubstitution:a,innermostVariable:v,internalVariables:o}}isInvertible(){return this.hasVariable()&&(this.internalInvert!=null||this.internalEvaluate==null)}isIntegrable(){return this.hasVariable()&&this.internalIntegrate!=null}isIntegralInvertible(){return this.isIntegrable()?this.getIntegralFormula().isInvertible():!1}hasVariable(){return this.internalVariables===1}evaluate(e){var t,n,r;return(r=(n=(t=this.internalEvaluate)==null?void 0:t.call(this,...this.inputs.map(i=>le(i,e))))!=null?n:this.hasVariable()?e:null)!=null?r:le(this.inputs[0])}equals(e){return this.inputs.length===e.inputs.length&&this.inputs.every((t,n)=>t instanceof de&&e.inputs[n]instanceof de?t.equals(e.inputs[n]):!(t instanceof de)&&!(e.inputs[n]instanceof de)&&N.eq(u(t),u(e.inputs[n])))&&this.internalEvaluate===e.internalEvaluate&&this.internalInvert===e.internalInvert&&this.internalIntegrate===e.internalIntegrate&&this.internalVariables===e.internalVariables}static constant(e){return new f({inputs:[e]})}static variable(e){return new f({variable:e})}static step(e,t,n){const r=n(f.variable(0)),i=Nn(t);function s(o){return N.lt(o,u(i))?o:N.add(r.evaluate(N.sub(o,u(i))),u(i))}function a(o,l){return F(l)&&r.isInvertible()?(N.gt(o,u(i))&&(o=N.add(r.invert(N.sub(o,u(i))),u(i))),l.invert(o)):(console.error("Could not invert due to no input being a variable"),0)}return new f({inputs:[e],evaluate:s,invert:r.isInvertible()&&r.hasVariable()?a:void 0})}static if(e,t,n,r){const i=B(0),s=f.variable(i),a=n(s),o=r==null?void 0:r(s),l=Nn(t);function v(b){return u(l)?(i.value=b,a.evaluate()):o?(i.value=b,o.evaluate()):b}function p(b,d){return!F(d)||!a.isInvertible()||o!=null&&!o.isInvertible()?(console.error("Could not invert due to no input being a variable"),0):u(l)?d.invert(a.invert(b)):o?d.invert(o.invert(b)):d.invert(b)}return new f({inputs:[e],evaluate:v,invert:a.isInvertible()&&a.hasVariable()?p:void 0})}static conditional(e,t,n,r){return f.if(e,t,n,r)}static abs(e){return new f({inputs:[e],evaluate:N.abs})}static neg(e){return new f({inputs:[e],evaluate:N.neg,invert:ls,applySubstitution:cs,integrate:us})}static sign(e){return new f({inputs:[e],evaluate:N.sign})}static round(e){return new f({inputs:[e],evaluate:N.round})}static floor(e){return new f({inputs:[e],evaluate:N.floor})}static ceil(e){return new f({inputs:[e],evaluate:N.ceil})}static trunc(e){return new f({inputs:[e],evaluate:N.trunc})}static add(e,t){return new f({inputs:[e,t],evaluate:N.add,invert:ds,integrate:fs,integrateInner:gs,applySubstitution:pt})}static sub(e,t){return new f({inputs:[e,t],evaluate:N.sub,invert:ps,integrate:vs,integrateInner:hs,applySubstitution:pt})}static mul(e,t){return new f({inputs:[e,t],evaluate:N.mul,invert:ms,integrate:bs,applySubstitution:ys})}static div(e,t){return new f({inputs:[e,t],evaluate:N.div,invert:_s,integrate:Ns,applySubstitution:ws})}static recip(e){return new f({inputs:[e],evaluate:N.recip,invert:ks,integrate:Ss})}static clamp(e,t,n){return new f({inputs:[e,t,n],evaluate:N.clamp,invert:pt})}static pLog10(e){return new f({inputs:[e],evaluate:N.pLog10})}static absLog10(e){return new f({inputs:[e],evaluate:N.absLog10})}static log10(e){return new f({inputs:[e],evaluate:N.log10,invert:Cs,integrate:Is})}static log(e,t){return new f({inputs:[e,t],evaluate:N.log,invert:$s,integrate:Fs})}static log2(e){return new f({inputs:[e],evaluate:N.log2,invert:Ps,integrate:zs})}static ln(e){return new f({inputs:[e],evaluate:N.ln,invert:Os,integrate:Vs})}static pow(e,t){return new f({inputs:[e,t],evaluate:N.pow,invert:js,integrate:Bs})}static pow10(e){return new f({inputs:[e],evaluate:N.pow10,invert:qs,integrate:Us})}static pow_base(e,t){return new f({inputs:[e,t],evaluate:N.pow_base,invert:Zs,integrate:Ws})}static root(e,t){return new f({inputs:[e,t],evaluate:N.root,invert:Gs,integrate:Hs})}static factorial(e){return new f({inputs:[e],evaluate:N.factorial})}static gamma(e){return new f({inputs:[e],evaluate:N.gamma})}static lngamma(e){return new f({inputs:[e],evaluate:N.lngamma})}static exp(e){return new f({inputs:[e],evaluate:N.exp,invert:Ys,integrate:Js})}static sqr(e){return f.pow(e,2)}static sqrt(e){return f.root(e,2)}static cube(e){return f.pow(e,3)}static cbrt(e){return f.root(e,3)}static tetrate(e,t=2,n=N.fromComponents_noNormalize(1,0,1)){return new f({inputs:[e,t,n],evaluate:Ks,invert:Xs})}static iteratedexp(e,t=2,n=N.fromComponents_noNormalize(1,0,1)){return new f({inputs:[e,t,n],evaluate:Qs,invert:eo})}static iteratedlog(e,t=10,n=1){return new f({inputs:[e,t,n],evaluate:to})}static slog(e,t=10){return new f({inputs:[e,t],evaluate:no,invert:ro})}static layeradd10(e,t){return new f({inputs:[e,t],evaluate:N.layeradd10})}static layeradd(e,t,n=10){return new f({inputs:[e,t,n],evaluate:io,invert:so})}static lambertw(e){return new f({inputs:[e],evaluate:N.lambertw,invert:oo})}static ssqrt(e){return new f({inputs:[e],evaluate:N.ssqrt,invert:ao})}static pentate(e,t=2,n=N.fromComponents_noNormalize(1,0,1)){return new f({inputs:[e,t,n],evaluate:lo})}static sin(e){return new f({inputs:[e],evaluate:N.sin,invert:ho,integrate:co})}static cos(e){return new f({inputs:[e],evaluate:N.cos,invert:bo,integrate:go})}static tan(e){return new f({inputs:[e],evaluate:N.tan,invert:_o,integrate:vo})}static asin(e){return new f({inputs:[e],evaluate:N.asin,invert:uo,integrate:mo})}static acos(e){return new f({inputs:[e],evaluate:N.acos,invert:fo,integrate:yo})}static atan(e){return new f({inputs:[e],evaluate:N.atan,invert:po,integrate:No})}static sinh(e){return new f({inputs:[e],evaluate:N.sinh,invert:Io,integrate:ko})}static cosh(e){return new f({inputs:[e],evaluate:N.cosh,invert:Lo,integrate:Co})}static tanh(e){return new f({inputs:[e],evaluate:N.tanh,invert:Fo,integrate:Mo})}static asinh(e){return new f({inputs:[e],evaluate:N.asinh,invert:wo,integrate:$o})}static acosh(e){return new f({inputs:[e],evaluate:N.acosh,invert:So,integrate:Ro})}static atanh(e){return new f({inputs:[e],evaluate:N.atanh,invert:xo,integrate:Po})}step(e,t){return f.step(this,e,t)}if(e,t){return f.if(this,e,t)}conditional(e,t){return f.if(this,e,t)}abs(){return f.abs(this)}neg(){return f.neg(this)}sign(){return f.sign(this)}round(){return f.round(this)}floor(){return f.floor(this)}ceil(){return f.ceil(this)}trunc(){return f.trunc(this)}add(e){return f.add(this,e)}sub(e){return f.sub(this,e)}mul(e){return f.mul(this,e)}div(e){return f.div(this,e)}recip(){return f.recip(this)}max(e){return f.max(this,e)}min(e){return f.min(this,e)}maxabs(e){return f.maxabs(this,e)}minabs(e){return f.minabs(this,e)}clamp(e,t){return f.clamp(this,e,t)}clampMin(e){return f.clampMin(this,e)}clampMax(e){return f.clampMax(this,e)}pLog10(){return f.pLog10(this)}absLog10(){return f.absLog10(this)}log10(){return f.log10(this)}log(e){return f.log(this,e)}log2(){return f.log2(this)}ln(){return f.ln(this)}pow(e){return f.pow(this,e)}pow10(){return f.pow10(this)}pow_base(e){return f.pow_base(this,e)}root(e){return f.root(this,e)}factorial(){return f.factorial(this)}gamma(){return f.gamma(this)}lngamma(){return f.lngamma(this)}exp(){return f.exp(this)}sqr(){return f.pow(this,2)}sqrt(){return f.root(this,2)}cube(){return f.pow(this,3)}cbrt(){return f.root(this,3)}tetrate(e=2,t=N.fromComponents_noNormalize(1,0,1)){return f.tetrate(this,e,t)}iteratedexp(e=2,t=N.fromComponents_noNormalize(1,0,1)){return f.iteratedexp(this,e,t)}iteratedlog(e=10,t=1){return f.iteratedlog(this,e,t)}slog(e=10){return f.slog(this,e)}layeradd10(e){return f.layeradd10(this,e)}layeradd(e,t){return f.layeradd(this,e,t)}lambertw(){return f.lambertw(this)}ssqrt(){return f.ssqrt(this)}pentate(e=2,t=N.fromComponents_noNormalize(1,0,1)){return f.pentate(this,e,t)}sin(){return f.sin(this)}cos(){return f.cos(this)}tan(){return f.tan(this)}asin(){return f.asin(this)}acos(){return f.acos(this)}atan(){return f.atan(this)}sinh(){return f.sinh(this)}cosh(){return f.cosh(this)}tanh(){return f.tanh(this)}asinh(){return f.asinh(this)}acosh(){return f.acosh(this)}atanh(){return f.atanh(this)}};let oe=de;oe.negate=de.neg;oe.negated=de.neg;oe.sgn=de.sign;oe.plus=de.add;oe.subtract=de.sub;oe.minus=de.sub;oe.multiply=de.mul;oe.times=de.mul;oe.divide=de.div;oe.divideBy=de.div;oe.dividedBy=de.div;oe.reciprocal=de.recip;oe.reciprocate=de.recip;oe.max=ft(N.max);oe.min=ft(N.min);oe.minabs=ft(N.minabs);oe.maxabs=ft(N.maxabs);oe.clampMin=ft(N.clampMin);oe.clampMax=ft(N.clampMax);oe.logarithm=de.log;class f extends oe{invert(t){return this.internalInvert&&this.hasVariable()?this.internalInvert.call(this,t,...this.inputs):this.inputs.length===1&&this.hasVariable()?t:(console.error("Cannot invert non-invertible formula"),0)}evaluateIntegral(t){return this.isIntegrable()?this.getIntegralFormula().evaluate(t):(console.error("Cannot evaluate integral of formula without integral"),0)}invertIntegral(t){return!this.isIntegrable()||!this.getIntegralFormula().isInvertible()?(console.error("Cannot invert integral of formula without invertible integral"),0):this.getIntegralFormula().invert(t)}calculateConstantOfIntegration(){const t=this.getIntegralFormula().evaluate(1),n=N.add(this.evaluate(0),this.evaluate(1)).div(2);return N.sub(n,t)}getIntegralFormula(t){if(this.integralFormula!=null&&t==null)return this.integralFormula;if(t==null){if(this.applySubstitution==null){if(t=[],this.internalIntegrate==null)return console.error("Cannot integrate formula with non-integrable operation"),f.constant(0);let n=this.internalIntegrate.call(this,t,...this.inputs);t.forEach(r=>n=r(n)),this.integralFormula=n}else if(this.internalIntegrate)this.integralFormula=this.internalIntegrate.call(this,void 0,...this.inputs);else if(this.inputs.length===1&&this.internalEvaluate==null&&this.hasVariable())this.integralFormula=this;else return console.error("Cannot integrate formula without variable"),f.constant(0);return this.integralFormula}else return this.applySubstitution==null?(console.error("Cannot have two complex operations in an integrable formula"),f.constant(0)):(t.push(n=>this.applySubstitution.call(this,n,...this.inputs)),this.internalIntegrateInner?this.internalIntegrateInner.call(this,t,...this.inputs):this.internalIntegrate?this.internalIntegrate.call(this,t,...this.inputs):this.inputs.length===1&&this.internalEvaluate==null&&this.hasVariable()?this:(console.error("Cannot integrate formula without variable"),f.constant(0)))}}const at=Symbol("PersistentState"),Nt=Symbol("DefaultValue"),Tt=Symbol("StackTrace"),Et=Symbol("Deleted"),Ke=Symbol("NonPersistent"),Xe=Symbol("SaveDataPath"),zo=Symbol("SkipPersistence");function Oo(){var e,t;return(t=(e=new Error().stack)==null?void 0:e.split(`
`).slice(3,5).map(n=>n.trim()).join(`
`))!=null?t:""}function wn(e,t){var n;N.isNaN(t)&&(ae.hasNaN||(J.autosave=!1,ae.hasNaN=!0,ae.NaNPath=e[Xe],ae.NaNPersistent=e),console.error(`Attempted to save NaN value to ${(n=e[Xe])==null?void 0:n.join(".")}`)),e[at].value=t}function wt(e,t=!0){const n=Pe(e)?e:B(e);Pe(e)&&(e=e.value);const r=k({get(){return n.value},set(s){t?wn(i,s):i[at].value=s}});r[Nt]=e;const i={get value(){return n.value},set value(s){t?wn(i,s):i[at].value=s},__v_isRef:!0,[at]:n,[Nt]:e,[Tt]:Oo(),[Et]:!1,[Ke]:r,[Xe]:void 0};return we.length===0?console.warn("Creating a persistent ref outside of a layer. This is not officially supported",i,`
Created at:
`+i[Tt]):tt[we[we.length-1]].add(i),i}function Do(e){return e!=null&&typeof e=="object"&&at in e}function Ao(e){we.length===0?console.warn("Deleting a persistent ref outside of a layer. Ignoring...",e):tt[we[we.length-1]].delete(e),e[Et]=!0}_e.on("addLayer",(e,t)=>{const n=[],r=(i,s=[])=>{let a=!1;return Object.keys(i).forEach(o=>{let l=i[o];if(l!=null&&typeof l=="object"){if(l[zo]===!0)return;if(Ye in l&&(l=l[Ye]),Do(l)){if(a=!0,l[Et]){console.warn("Deleted persistent ref present in returned object. Ignoring...",l,`
Created at:
`+l[Tt]);return}tt[e.id].delete(l);const v=[e.id,...s,o];l[Xe]!=null&&JSON.stringify(v)!==JSON.stringify(l[Xe])&&console.error(`Persistent ref is being saved to \`${v.join(".")}\` when it's already present at \`${l[Xe].join(".")}\`.`,"This can cause unexpected behavior when loading saves between updates."),l[Xe]=v;const p=s.reduce((d,c)=>(c in d||(d[c]={}),d[c]),t),b=p[o];p[o]=l[at],hr(p)?b!=null?p[o]=b:p[o]=l[Nt]:b!=null?p[o].value=b:p[o].value=l[Nt]}else!(l instanceof N)&&!(l instanceof f)&&!Pe(l)&&!n.includes(l)&&(typeof l.type=="symbol"&&n.push(l),r(l,[...s,o])&&(pn(l)&&!pn(i)?console.warn("Found array that contains persistent values when adding layer. Keep in mind changing the order of elements in the array will mess with existing player saves.",Ye in i?i[Ye]:i,o):a=!0))}}),a};r(e[Ye]),tt[e.id].forEach(i=>{i[Et]||console.error(`Created persistent ref in ${e.id} without registering it to the layer!`,`Make sure to include everything persistent in the returned object.

Created at:
`+i[Tt])}),tt[e.id].clear()});const rn=Symbol("RegisterNode"),sn=Symbol("UnregisterNode"),Un=Symbol("Nodes"),Zn=Symbol("Bounds"),Ne=zt({});window.layers=Ne;const tt={},we=[];function Wn(e,t){return Ie(()=>{const n={},r=n.emitter=Mn();if(n.on=r.on.bind(r),n.emit=r.emit.bind(r),n.nodes=B({}),n.id=e,we.push(e),tt[e]=new Set,n.minimized=wt(!1,!1),Object.assign(n,t.call(n,n)),we[we.length-1]==null||we[we.length-1]!==e)throw new Error(`Adding layers stack in invalid state. This should not happen
Stack: ${we}
Trying to pop ${n.id}`);we.pop(),Z(n,"color"),Z(n,"display"),Z(n,"classes"),Z(n,"style"),Z(n,"name"),ge(n,"name",n.id),Z(n,"minWidth"),ge(n,"minWidth",600),Z(n,"minimizable"),ge(n,"minimizable",!0),Z(n,"minimizedDisplay");const i=n.style;return n.style=k(()=>{var a,o;let s=u(n.minWidth);return(typeof s=="number"||!Number.isNaN(parseInt(s)))&&(s=s+"px"),[(a=u(i))!=null?a:"",(o=n.minimized)!=null&&o.value?{flexGrow:"0",flexShrink:"0",width:"60px",minWidth:"",flexBasis:"",margin:"0"}:{flexGrow:"",flexShrink:"",width:"",minWidth:s,flexBasis:s,margin:""}]}),n})}function Gn(e,t){if(console.info("Adding layer",e.id),Ne[e.id]){console.error("Attempted to add layer with same ID as existing layer",e.id,Ne[e.id]);return}ge(t,"layers",{}),t.layers[e.id]==null&&(t.layers[e.id]={}),Ne[e.id]=e,_e.emit("addLayer",e,t.layers[e.id])}function Vo(e){return Ne[e]}function Hn(e){console.info("Removing layer",e.id),_e.emit("removeLayer",e),Ne[e.id]=void 0}function jo(e){Hn(e),Gn(e,J)}function Bo(e){const t=B(!1);return{openModal:()=>t.value=!0,modal:ke(()=>R(nt,{modelValue:t.value,"onUpdate:modelValue":n=>t.value=n},{header:()=>R("h2",null,[u(e.name)]),body:u(e.display)}))}}_e.on("update",function(t){Object.values(Ne).forEach(n=>{n==null||n.emit("preUpdate",t)}),Object.values(Ne).forEach(n=>{n==null||n.emit("update",t)}),Object.values(Ne).forEach(n=>{n==null||n.emit("postUpdate",t)})});var qo=Object.freeze(Object.defineProperty({__proto__:null,RegisterNodeInjectionKey:rn,UnregisterNodeInjectionKey:sn,NodesInjectionKey:Un,BoundsInjectionKey:Zn,layers:Ne,persistentRefs:tt,addingLayers:we,createLayer:Wn,addLayer:Gn,getLayer:Vo,removeLayer:Hn,reloadLayer:jo,setupLayerModal:Bo},Symbol.toStringTag,{value:"Module"}));const Uo=A({components:{Context:Bn,ErrorVue:Rn},props:{index:{type:Number,required:!0},display:{type:Fe(Object,String,Function),required:!0},minimizedDisplay:Fe(Object,String,Function),minimized:{type:Object,required:!0},name:{type:Fe(String),required:!0},color:Fe(String),minimizable:Fe(Boolean),nodes:{type:Object,required:!0}},emits:["setMinimized"],setup(e){const{display:t,index:n,minimized:r,minimizedDisplay:i}=Ce(e),s=Xi(t),a=jt(i),o=k(()=>ee.allowGoBack&&n.value>0&&!et(r));function l(){J.tabs.splice(u(e.index),1/0)}function v(b){e.nodes.value=b}const p=B([]);return mr((b,d,c)=>(console.warn(`Error caught in "${e.name}" layer`,b,d,c),p.value.push(b instanceof Error?b:new Error(JSON.stringify(b))),!1)),{component:s,minimizedComponent:a,showGoBack:o,updateNodes:v,unref:u,goBack:l,errors:p}}}),Zo={key:1};function Wo(e,t,n,r,i,s){const a=Ht("ErrorVue"),o=Ht("Context");return e.errors.length>0?(_(),O(a,{key:0,errors:e.errors},null,8,["errors"])):(_(),C("div",Ze({key:1,class:"layer-container",style:{"--layer-color":e.unref(e.color)}},e.$attrs),[e.showGoBack?(_(),C("button",{key:0,class:"goBack",onClick:t[0]||(t[0]=(...l)=>e.goBack&&e.goBack(...l))},"\u274C")):P("",!0),e.unref(e.minimized)?(_(),C("button",{key:1,class:"layer-tab minimized",onClick:t[1]||(t[1]=l=>e.$emit("setMinimized",!1))},[e.minimizedComponent?(_(),O(se(e.minimizedComponent),{key:0})):(_(),C("div",Zo,q(e.unref(e.name)),1))])):(_(),C("div",{key:2,class:ne(["layer-tab",{showGoBack:e.showGoBack}])},[R(o,{onUpdateNodes:e.updateNodes},{default:j(()=>[(_(),O(se(e.component)))]),_:1},8,["onUpdateNodes"])],2)),e.unref(e.minimizable)?(_(),C("button",{key:3,class:"minimize",onClick:t[2]||(t[2]=l=>e.$emit("setMinimized",!0))}," \u25BC ")):P("",!0)],16))}var Go=W(Uo,[["render",Wo],["__scopeId","data-v-217346d2"]]);const Yn=e=>($e("data-v-4b4bda40"),e=e(),Le(),e),Ho=Yn(()=>m("h2",null,"Changelog",-1)),Yo=Yn(()=>m("details",{open:""},[m("summary",null,[H("v0.0 Initial Commit - "),m("time",null,"2021-09-04")]),H(" This is the first release :D "),m("ul",null,[m("li",{class:"feature"},"Did everything"),m("li",{class:"fix"},"Had some fun"),m("li",{class:"breaking"},"Removed everything"),m("li",{class:"balancing"},"Created some bugs to fix later")])],-1)),Jo=A({__name:"Changelog",setup(e,{expose:t}){const n=B(!1);return t({open(){n.value=!0}}),(r,i)=>(_(),O(nt,{modelValue:n.value,"onUpdate:modelValue":i[0]||(i[0]=s=>n.value=s)},{header:j(()=>[Ho]),body:j(()=>[Yo]),_:1},8,["modelValue"]))}});var Ko=W(Jo,[["__scopeId","data-v-4b4bda40"]]),Xo=A({props:{element:Object,display:{type:Fe(Object,String,Function),required:!0},style:Fe(Object,String,Array),classes:Fe(Object),direction:Fe(String),xoffset:Fe(String),yoffset:Fe(String),pinned:Object},setup(e){const{element:t,display:n,pinned:r}=Ce(e),i=B(!1),s=k(()=>(et(r)||i.value)&&a.value),a=jt(n),o=St(me(ke(()=>{const p=et(t);return p==null?"":Ki(p)})));function l(p){const b=r;p.shiftKey&&b&&(b.value=!b.value,p.stopPropagation(),p.preventDefault())}const v=k(()=>et(r)&&Te[te.theme].showPin);return{Direction:G,isHovered:i,isShown:s,comp:a,elementComp:o,unref:u,togglePinned:l,showPin:v}}});const Qo={key:0,class:"material-icons pinned"};function ea(e,t,n,r,i,s){return _(),C("div",{class:ne(["tooltip-container",{shown:e.isShown}]),onMouseenter:t[0]||(t[0]=a=>e.isHovered=!0),onMouseleave:t[1]||(t[1]=a=>e.isHovered=!1),onClickCapture:t[2]||(t[2]=(...a)=>e.togglePinned&&e.togglePinned(...a))},[ze(e.$slots,"default",{},void 0,!0),e.elementComp?(_(),O(se(e.elementComp),{key:0})):P("",!0),R(mt,{name:"fade"},{default:j(()=>{var a;return[e.isShown?(_(),C("div",{key:0,class:ne(["tooltip",{top:e.unref(e.direction)===e.Direction.Up,left:e.unref(e.direction)===e.Direction.Left,right:e.unref(e.direction)===e.Direction.Right,bottom:e.unref(e.direction)===e.Direction.Down,...e.unref(e.classes)}]),style:re([{"--xoffset":e.unref(e.xoffset)||"0px","--yoffset":e.unref(e.yoffset)||"0px"},(a=e.unref(e.style))!=null?a:{}])},[e.showPin?(_(),C("span",Qo,"push_pin")):P("",!0),e.comp?(_(),O(se(e.comp),{key:1})):P("",!0)],6)):P("",!0)]}),_:1})],34)}var pe=W(Xo,[["render",ea],["__scopeId","data-v-6102fa3a"]]);const rt=e=>($e("data-v-4f97aa40"),e=e(),Le(),e),ta={class:"info-modal-header"},na=["src","alt"],ra={class:"info-modal-title"},ia={key:0},sa={key:0},oa={key:0},aa=rt(()=>m("div",null," Made in Profectus, by thepaperpilot with inspiration from Acameada and Jacorb ",-1)),la=rt(()=>m("br",null,null,-1)),ua=rt(()=>m("br",null,null,-1)),ca=["href"],da=rt(()=>m("span",{class:"material-icons info-modal-discord"},"discord",-1)),fa=rt(()=>m("div",null,[m("a",{href:"https://discord.gg/yJ4fjnjU54",class:"info-modal-discord-link",target:"_blank"},[m("span",{class:"material-icons info-modal-discord"},"discord"),H(" The Paper Pilot Community ")])],-1)),ga=rt(()=>m("div",null,[m("a",{href:"https://discord.gg/F3xveHV",class:"info-modal-discord-link",target:"_blank"},[m("span",{class:"material-icons info-modal-discord"},"discord"),H(" The Modding Tree ")])],-1)),pa=rt(()=>m("br",null,null,-1));var va=A({__name:"Info",props:{changelog:{}},setup(e,{expose:t}){const n=e,{title:r,logo:i,author:s,discordName:a,discordLink:o,versionNumber:l,versionTitle:v}=ee,p=Ce(n),b=B(!1),d=k(()=>en(J.timePlayed)),c=k(()=>me(ke(()=>R(X,null,[Vn.map(Qe)]))));t({open(){b.value=!0}});function g(){var h;(h=u(p.changelog))==null||h.open()}return(h,S)=>(_(),O(nt,{modelValue:b.value,"onUpdate:modelValue":S[0]||(S[0]=M=>b.value=M)},{header:j(()=>[m("div",ta,[u(i)?(_(),C("img",{key:0,class:"info-modal-logo",src:u(i),alt:u(r)},null,8,na)):P("",!0),m("div",ra,[m("h2",null,q(u(r)),1),m("h4",null,[H(" v"+q(u(l)),1),u(v)?(_(),C("span",ia,": "+q(u(v)),1)):P("",!0)])])])]),body:j(({shown:M})=>[M?(_(),C("div",sa,[u(s)?(_(),C("div",oa,"By "+q(u(s)),1)):P("",!0),aa,la,m("div",{class:"link",onClick:g},"Changelog"),ua,m("div",null,[u(o)?(_(),C("a",{key:0,href:u(o),class:"info-modal-discord-link",target:"_blank"},[da,H(" "+q(u(a)),1)],8,ca)):P("",!0)]),fa,ga,pa,m("div",null,"Time Played: "+q(d.value),1),(_(),O(se(c.value)))])):P("",!0)]),_:1},8,["modelValue"]))}});var ha=W(va,[["__scopeId","data-v-4f97aa40"]]);const ma={class:"field"},ba={key:0,class:"field-title"},Jn=A({__name:"Select",props:{title:{type:[String,Object,Function]},modelValue:{},options:{},placeholder:{},closeOnSelect:{type:Boolean}},emits:["update:modelValue"],setup(e,{emit:t}){var a;const n=e,r=jt(We(n,"title"),"span"),i=B((a=n.options.find(o=>o.value===n.modelValue))!=null?a:null);Ve(We(n,"modelValue"),o=>{var l;et(i)!==o&&(i.value=(l=n.options.find(v=>v.value===o))!=null?l:null)});function s(o){t("update:modelValue",o.value)}return(o,l)=>(_(),C("div",ma,[u(r)?(_(),C("span",ba,[(_(),O(se(u(r))))])):P("",!0),R(u(kr),{options:o.options,modelValue:i.value,"onUpdate:modelValue":[l[0]||(l[0]=v=>i.value=v),s],min:1,"label-by":"label",placeholder:o.placeholder,"close-on-select":o.closeOnSelect},null,8,["options","modelValue","placeholder","close-on-select"])]))}});const ya={class:"field"},_a=A({__name:"Toggle",props:{title:{type:[String,Object,Function]},modelValue:{type:Boolean}},emits:["update:modelValue"],setup(e,{emit:t}){const n=e,r=k(()=>{var s;return me((s=u(n.title))!=null?s:"<span></span>","span")}),i=k({get(){return!!n.modelValue},set(s){t("update:modelValue",s)}});return(s,a)=>(_(),C("label",ya,[Qt(m("input",{type:"checkbox",class:"toggle","onUpdate:modelValue":a[0]||(a[0]=o=>i.value=o)},null,512),[[br,i.value]]),(_(),O(se(r.value)))]))}});var qe=W(_a,[["__scopeId","data-v-11046116"]]);const Na=["onClick"],wa=A({__name:"FeedbackButton",props:{left:{type:Boolean}},emits:["click"],setup(e,{emit:t}){const n=B(!1),r=B(null);function i(){t("click"),r.value&&clearTimeout(r.value),n.value=!1,ht(()=>{n.value=!0,r.value=setTimeout(()=>n.value=!1,500)})}return(s,a)=>(_(),C("button",{onClick:ut(i,["stop"]),class:ne(["feedback",{activated:n.value,left:s.left}])},[ze(s.$slots,"default",{},void 0,!0)],10,Na))}});var Kn=W(wa,[["__scopeId","data-v-01a1b95c"]]);const ka={class:"header"},Sa=m("h2",null,"Settings",-1),Ca={class:"option-tabs"},xa={key:0},Ma={key:1};var Ia=A({__name:"Options",setup(e,{expose:t}){const n=B(!1),r=B("behaviour");function i(T){return T==r.value}function s(T){r.value=T}t({isTab:i,setTab:s,save:Se,open(){n.value=!0}});const a=Object.keys(Te).map(T=>({label:Di(T),value:T})),o=k(()=>me(ke(()=>R(X,null,[Wi.map(Qe)])))),{showTPS:l,theme:v,unthrottled:p,alignUnits:b}=Ce(te),{autosave:d}=Ce(J),c=k({get(){return J.devSpeed===0},set(T){J.devSpeed=T?0:null}}),g=ke(()=>R("span",{class:"option-title"},[H("Unthrottled"),R("desc",null,[H("Allow the game to run as fast as possible. Not battery friendly.")])])),h=ke(()=>R("span",{class:"option-title"},[H("Autosave"),R(pe,{display:"Save-specific",direction:G.Right},{default:()=>[H("*")]}),R("desc",null,[H("Automatically save the game every second or when the game is closed.")])])),S=ke(()=>R("span",{class:"option-title"},[H("Pause game"),R(pe,{display:"Save-specific",direction:G.Right},{default:()=>[H("*")]}),R("desc",null,[H("Stop everything from moving.")])])),M=ke(()=>R("span",{class:"option-title"},[H("Theme"),R("desc",null,[H("How the game looks.")])])),y=ke(()=>R("span",{class:"option-title"},[H("Show TPS"),R("desc",null,[H("Show TPS meter at the bottom-left corner of the page.")])])),$=ke(()=>R("span",{class:"option-title"},[H("Align modifier units"),R("desc",null,[H("Align numbers to the beginning of the unit in modifier view.")])]));return(T,V)=>(_(),O(nt,{modelValue:n.value,"onUpdate:modelValue":V[9]||(V[9]=Q=>n.value=Q)},{header:j(()=>[m("div",ka,[Sa,m("div",Ca,[m("button",{class:ne({selected:i("behaviour")}),onClick:V[0]||(V[0]=Q=>s("behaviour"))},"Behaviour",2),m("button",{class:ne({selected:i("appearance")}),onClick:V[1]||(V[1]=Q=>s("appearance"))},"Appearance",2)])])]),body:j(()=>[i("behaviour")?(_(),C("div",xa,[R(qe,{title:u(g),modelValue:u(p),"onUpdate:modelValue":V[2]||(V[2]=Q=>Pe(p)?p.value=Q:null)},null,8,["title","modelValue"]),u(ee).enablePausing?(_(),O(qe,{key:0,title:u(S),modelValue:c.value,"onUpdate:modelValue":V[3]||(V[3]=Q=>c.value=Q)},null,8,["title","modelValue"])):P("",!0),R(qe,{title:u(h),modelValue:u(d),"onUpdate:modelValue":V[4]||(V[4]=Q=>Pe(d)?d.value=Q:null)},null,8,["title","modelValue"]),u(d)?P("",!0):(_(),O(Kn,{key:1,class:"button save-button",onClick:V[5]||(V[5]=Q=>u(Se)())},{default:j(()=>[H("Manually save")]),_:1}))])):P("",!0),i("appearance")?(_(),C("div",Ma,[R(Jn,{title:u(M),options:u(a),modelValue:u(v),"onUpdate:modelValue":V[6]||(V[6]=Q=>Pe(v)?v.value=Q:null)},null,8,["title","options","modelValue"]),(_(),O(se(o.value))),R(qe,{title:u(y),modelValue:u(l),"onUpdate:modelValue":V[7]||(V[7]=Q=>Pe(l)?l.value=Q:null)},null,8,["title","modelValue"]),R(qe,{title:u($),modelValue:u(b),"onUpdate:modelValue":V[8]||(V[8]=Q=>Pe(b)?b.value=Q:null)},null,8,["title","modelValue"])])):P("",!0)]),_:1},8,["modelValue"]))}});const $a=["onSubmit"],La={class:"field"},Ra={key:0,class:"field-title"},Fa=["placeholder"],Pa=A({__name:"Text",props:{title:{type:[String,Object,Function]},modelValue:{},textArea:{type:Boolean},placeholder:{},maxHeight:{},submitOnBlur:{type:Boolean}},emits:["update:modelValue","submit","cancel"],setup(e,{emit:t}){const n=e,r=jt(We(n,"title"),"span"),i=St(null);Xt(()=>{var l;(l=i.value)==null||l.focus()});const s=k({get(){var l;return(l=u(n.modelValue))!=null?l:""},set(l){t("update:modelValue",l)}});function a(){t("submit")}function o(){n.submitOnBlur!==!1?t("submit"):t("cancel")}return(l,v)=>(_(),C("form",{onSubmit:ut(a,["prevent"])},[m("div",La,[u(r)?(_(),C("span",Ra,[(_(),O(se(u(r))))])):P("",!0),l.textArea?(_(),O(u(Cr),{key:1,modelValue:s.value,"onUpdate:modelValue":v[0]||(v[0]=p=>s.value=p),placeholder:l.placeholder,maxHeight:l.maxHeight,onBlur:o,ref_key:"field",ref:i},null,8,["modelValue","placeholder","maxHeight"])):Qt((_(),C("input",{key:2,type:"text","onUpdate:modelValue":v[1]||(v[1]=p=>s.value=p),placeholder:l.placeholder,class:ne({fullWidth:!l.title}),onBlur:o,ref_key:"field",ref:i},null,42,Fa)),[[yr,s.value]])])],40,$a))}});var Xn=W(Pa,[["__scopeId","data-v-90bd4994"]]);const Ta={key:0},Ea=["onClick","disabled"],za={key:0},Oa=["onClick"],Da=A({__name:"DangerButton",props:{disabled:{type:Boolean},skipConfirm:{type:Boolean}},emits:["click","confirmingChanged"],setup(e,{emit:t}){const r=Ce(e),i=B(!1);Ve(i,o=>{t("confirmingChanged",o)});function s(){if(u(r.skipConfirm)){t("click");return}i.value&&t("click"),i.value=!i.value}function a(){i.value=!1}return(o,l)=>(_(),C("span",{class:ne(["container",{confirming:i.value}])},[i.value?(_(),C("span",Ta,"Are you sure?")):P("",!0),m("button",{onClick:ut(s,["stop"]),class:"button danger",disabled:o.disabled},[i.value?(_(),C("span",za,"Yes")):ze(o.$slots,"default",{key:1},void 0,!0)],8,Ea),i.value?(_(),C("button",{key:1,class:"button",onClick:ut(a,["stop"])},"No",8,Oa)):P("",!0)],2))}});var Aa=W(Da,[["__scopeId","data-v-87fc344c"]]);const je=e=>($e("data-v-d864a08c"),e=e(),Le(),e),Va=je(()=>m("div",{class:"handle material-icons"},"drag_handle",-1)),ja={key:0,class:"actions"},Ba=je(()=>m("span",{class:"material-icons"},"content_paste",-1)),qa=je(()=>m("span",{class:"material-icons"},"content_copy",-1)),Ua=je(()=>m("span",{class:"material-icons"},"edit",-1)),Za=je(()=>m("span",{class:"material-icons",style:{margin:"-2px"}},"delete",-1)),Wa={key:1,class:"actions"},Ga=je(()=>m("span",{class:"material-icons"},"check",-1)),Ha=je(()=>m("span",{class:"material-icons"},"close",-1)),Ya={key:2,class:"details"},Ja={class:"save-version"},Ka=je(()=>m("br",null,null,-1)),Xa={key:0},Qa={key:3,class:"details"},el={key:4,class:"details error"},tl=je(()=>m("br",null,null,-1)),nl=A({__name:"Save",props:{save:{}},emits:["export","open","duplicate","delete","editName"],setup(e,{emit:t}){const n=e,{save:r}=Ce(n),i=new Intl.DateTimeFormat("en-US",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"}),s=B(!1),a=B(!1),o=B("");Ve(s,()=>{var b;return o.value=(b=r.value.name)!=null?b:""});const l=k(()=>r.value!=null&&r.value.id===J.id),v=k(()=>{var b;return l.value?J.time:(b=r.value!=null&&r.value.time)!=null?b:0});function p(){t("editName",o.value),s.value=!1}return(b,d)=>(_(),C("div",{class:ne(["save",{active:l.value}])},[Va,s.value?(_(),C("div",Wa,[m("button",{onClick:p,class:"button"},[R(pe,{display:"Save",direction:u(G).Left,class:"info"},{default:j(()=>[Ga]),_:1},8,["direction"])]),m("button",{onClick:d[5]||(d[5]=c=>s.value=!s.value),class:"button"},[R(pe,{display:"Cancel",direction:u(G).Left,class:"info"},{default:j(()=>[Ha]),_:1},8,["direction"])])])):(_(),C("div",ja,[u(r).error==null&&!a.value?(_(),O(Kn,{key:0,onClick:d[0]||(d[0]=c=>t("export")),class:"button",left:""},{default:j(()=>[R(pe,{display:"Export",direction:u(G).Left,class:"info"},{default:j(()=>[Ba]),_:1},8,["direction"])]),_:1})):P("",!0),u(r).error==null&&!a.value?(_(),C("button",{key:1,onClick:d[1]||(d[1]=c=>t("duplicate")),class:"button"},[R(pe,{display:"Duplicate",direction:u(G).Left,class:"info"},{default:j(()=>[qa]),_:1},8,["direction"])])):P("",!0),u(r).error==null&&!a.value?(_(),C("button",{key:2,onClick:d[2]||(d[2]=c=>s.value=!s.value),class:"button"},[R(pe,{display:"Edit Name",direction:u(G).Left,class:"info"},{default:j(()=>[Ua]),_:1},8,["direction"])])):P("",!0),R(Aa,{disabled:l.value,onClick:d[3]||(d[3]=c=>t("delete")),onConfirmingChanged:d[4]||(d[4]=c=>a.value=c)},{default:j(()=>[R(pe,{display:"Delete",direction:u(G).Left,class:"info"},{default:j(()=>[Za]),_:1},8,["direction"])]),_:1},8,["disabled"])])),u(r).error==null&&!s.value?(_(),C("div",Ya,[m("button",{class:"button open",onClick:d[6]||(d[6]=c=>t("open"))},[m("h3",null,q(u(r).name),1)]),m("span",Ja,"v"+q(u(r).modVersion),1),Ka,v.value?(_(),C("div",Xa,"Last played "+q(u(i).format(v.value)),1)):P("",!0)])):u(r).error==null&&s.value?(_(),C("div",Qa,[R(Xn,{modelValue:o.value,"onUpdate:modelValue":d[7]||(d[7]=c=>o.value=c),class:"editname",onSubmit:p},null,8,["modelValue"])])):(_(),C("div",el,[H(" Error: Failed to load save with id "+q(u(r).id),1),tl,H(q(u(r).error),1)]))],2))}});var rl=W(nl,[["__scopeId","data-v-d864a08c"]]);const on=e=>($e("data-v-2a4275be"),e=e(),Le(),e),il=on(()=>m("h2",null,"Saves Manager",-1)),sl={class:"modal-footer"},ol={class:"field"},al=on(()=>m("span",{class:"field-title"},"Create Save",-1)),ll={class:"field-buttons"},ul={class:"footer"},cl=on(()=>m("div",{style:{"flex-grow":"1"}},null,-1)),dl=A({__name:"SavesManager",setup(e,{expose:t}){const n=B(!1),r=B(null);t({open(){n.value=!0}});const i=B(!1),s=B(""),a=B(null);Ve(s,y=>{y?ht(()=>{try{if(y[0]!=="{")if(y[0]==="e")y=decodeURIComponent(escape(atob(y)));else if(y[0]==="\u1BE1")y=Ue.decompressFromUTF16(y);else{console.warn("Unable to determine preset encoding",y),i.value=!0;return}const $=JSON.parse(y);if(typeof $!="object"){i.value=!0;return}const T=It();$.id=T,Se($),s.value="",i.value=!1,te.saves.push(T)}catch{i.value=!0}}):i.value=!1});let o={},l=B(Object.keys(o).reduce((y,$)=>(y.push({label:$.split("/").slice(-1)[0].slice(0,-4),value:o[$]}),y),[]));const v=zt({});function p(y){if(v[y]==null){let $=localStorage.getItem(y);if($==null)v[y]={error:"Save doesn't exist in localStorage",id:y};else if($==="dW5kZWZpbmVk")v[y]={error:"Save is undefined",id:y};else try{if($[0]!=="{")if($[0]==="e")$=decodeURIComponent(escape(atob($)));else if($[0]==="\u1BE1")$=Ue.decompressFromUTF16($);else return console.warn("Unable to determine preset encoding",$),i.value=!0,v[y]={error:"Unable to determine preset encoding",id:y},v[y];v[y]={...JSON.parse($),id:y}}catch(T){v[y]={error:T,id:y},console.warn(`SavesManager: Failed to load info about save with id ${y}:
${T}
${$}`)}}return v[y]}Ve(n,y=>{y&&Object.keys(v).forEach($=>delete v[$])});const b=k(()=>te.saves.reduce((y,$)=>(y[$]=p($),y),{}));function d(y){let $;switch(J.id===y?$=$n(J):$=JSON.stringify(b.value[y]),ee.exportEncoding){default:console.warn(`Unknown save encoding: ${ee.exportEncoding}. Defaulting to lz`);case"lz":$=Ue.compressToUTF16($);break;case"base64":$=btoa(unescape(encodeURIComponent($)));break;case"plain":break}const T=document.createElement("textarea");T.value=$,document.body.appendChild(T),T.select(),T.setSelectionRange(0,99999),document.execCommand("copy"),document.body.removeChild(T)}function c(y){J.id===y&&Se();const $={...b.value[y],id:It()};Se($),te.saves.push($.id)}function g(y){te.saves=te.saves.filter($=>$!==y),localStorage.removeItem(y),v[y]=void 0}function h(y){b.value[J.id].time=J.time,Se(),v[J.id]=void 0,Je(b.value[y]),v[y]=void 0}function S(y){if(a.value=y,ht(()=>{a.value=null}),y[0]!=="{")if(y[0]==="e")y=decodeURIComponent(escape(atob(y)));else if(y[0]==="\u1BE1")y=Ue.decompressFromUTF16(y);else{console.warn("Unable to determine preset encoding",y);return}const $=JSON.parse(y);$.id=It(),Se($),te.saves.push($.id),h($.id)}function M(y,$){const T=b.value[y];T!=null&&(T.name=$,J.id===y?(J.name=$,Se()):(Se(T),v[y]=void 0))}return(y,$)=>(_(),O(nt,{modelValue:n.value,"onUpdate:modelValue":$[4]||($[4]=T=>n.value=T),ref_key:"modal",ref:r},{header:j(()=>[il]),body:j(({shown:T})=>[T?(_(),O(u(Sr),{key:0,list:u(te).saves,handle:".handle",itemKey:V=>V},{item:j(({element:V})=>[R(rl,{save:b.value[V],onOpen:Q=>h(V),onExport:Q=>d(V),onEditName:Q=>M(V,Q),onDuplicate:Q=>c(V),onDelete:Q=>g(V)},null,8,["save","onOpen","onExport","onEditName","onDuplicate","onDelete"])]),_:1},8,["list","itemKey"])):P("",!0)]),footer:j(()=>[m("div",sl,[R(Xn,{modelValue:s.value,"onUpdate:modelValue":$[0]||($[0]=T=>s.value=T),title:"Import Save",placeholder:"Paste your save here!",class:ne({importingFailed:i.value})},null,8,["modelValue","class"]),m("div",ol,[al,m("div",ll,[m("button",{class:"button",onClick:$[1]||($[1]=T=>h(u(ot)().id))},"New Game"),Object.keys(u(l)).length>0?(_(),O(Jn,{key:0,options:u(l),modelValue:a.value,"onUpdate:modelValue":$[2]||($[2]=T=>S(T)),closeOnSelect:"",placeholder:"Select preset",class:"presets"},null,8,["options","modelValue"])):P("",!0)])]),m("div",ul,[cl,m("button",{class:"button modal-default-button",onClick:$[3]||($[3]=T=>n.value=!1)}," Close ")])])]),_:1},8,["modelValue"]))}});var Qn=W(dl,[["__scopeId","data-v-2a4275be"]]);const Re=e=>($e("data-v-106a74bf"),e=e(),Le(),e),fl=["src","alt"],gl={key:1,class:"title"},pl={style:{"flex-grow":"1",cursor:"unset"}},vl={key:0,style:{"text-shadow":"5px 0 10px var(--link), -3px 0 12px var(--foreground)"}},hl={class:"discord"},ml={class:"discord-links"},bl={key:0},yl=["href"],_l=Re(()=>m("li",null,[m("a",{href:"https://discord.gg/yJ4fjnjU54",target:"_blank"},"The Paper Pilot Community")],-1)),Nl=Re(()=>m("li",null,[m("a",{href:"https://discord.gg/F3xveHV",target:"_blank"},"The Modding Tree")],-1)),wl={href:"https://forums.moddingtree.com/",target:"_blank"},kl=Re(()=>m("span",{class:"material-icons"},"forum",-1)),Sl=Re(()=>m("span",{class:"material-icons"},"info",-1)),Cl=Re(()=>m("span",{class:"material-icons"},"library_books",-1)),xl=Re(()=>m("span",{class:"material-icons"},"settings",-1)),Ml=Re(()=>m("span",{class:"material-icons"},"library_books",-1)),Il=Re(()=>m("span",{class:"material-icons"},"settings",-1)),$l=Re(()=>m("span",{class:"material-icons"},"info",-1)),Ll={href:"https://forums.moddingtree.com/",target:"_blank"},Rl=Re(()=>m("span",{class:"material-icons"},"forum",-1)),Fl={class:"discord"},Pl={class:"discord-links"},Tl={key:0},El=["href"],zl=Re(()=>m("li",null,[m("a",{href:"https://discord.gg/yJ4fjnjU54",target:"_blank"},"The Paper Pilot Community")],-1)),Ol=Re(()=>m("li",null,[m("a",{href:"https://discord.gg/F3xveHV",target:"_blank"},"The Modding Tree")],-1)),Dl=A({__name:"Nav",setup(e){const t=B(null),n=B(null),r=B(null),i=B(null),{useHeader:s,banner:a,title:o,discordName:l,discordLink:v,versionNumber:p}=ee;function b(){window.open(v,"mywindow")}return(d,c)=>(_(),C(X,null,[u(s)?(_(),C("div",Ze({key:0,class:"nav"},d.$attrs),[u(a)?(_(),C("img",{key:0,src:u(a),class:"banner",alt:u(o)},null,8,fl)):(_(),C("div",gl,q(u(o)),1)),m("div",{onClick:c[0]||(c[0]=g=>{var h;return(h=i.value)==null?void 0:h.open()}),class:"version-container"},[R(pe,{display:"Changelog",direction:u(G).Down,class:"version"},{default:j(()=>[m("span",null,"v"+q(u(p)),1)]),_:1},8,["direction"])]),m("div",pl,[u(J).devSpeed===0?(_(),C("div",vl,"Game Paused!")):P("",!0)]),m("div",hl,[m("span",{onClick:b,class:"material-icons"},"discord"),m("ul",ml,[u(v)?(_(),C("li",bl,[m("a",{href:u(v),target:"_blank"},q(u(l)),9,yl)])):P("",!0),_l,Nl])]),m("div",null,[m("a",wl,[R(pe,{display:"Forums",direction:u(G).Down,yoffset:"5px"},{default:j(()=>[kl]),_:1},8,["direction"])])]),m("div",{onClick:c[1]||(c[1]=g=>{var h;return(h=t.value)==null?void 0:h.open()})},[R(pe,{display:"Info",direction:u(G).Down,class:"info"},{default:j(()=>[Sl]),_:1},8,["direction"])]),m("div",{onClick:c[2]||(c[2]=g=>{var h;return(h=n.value)==null?void 0:h.open()})},[R(pe,{display:"Saves",direction:u(G).Down,xoffset:"-20px"},{default:j(()=>[Cl]),_:1},8,["direction"])]),m("div",{onClick:c[3]||(c[3]=g=>{var h;return(h=r.value)==null?void 0:h.open()})},[R(pe,{display:"Settings",direction:u(G).Down,xoffset:"-66px"},{default:j(()=>[xl]),_:1},8,["direction"])])],16)):(_(),C("div",Ze({key:1,class:"overlay-nav"},d.$attrs),[m("div",{onClick:c[4]||(c[4]=g=>{var h;return(h=i.value)==null?void 0:h.open()}),class:"version-container"},[R(pe,{display:"Changelog",direction:u(G).Right,xoffset:"25%",class:"version"},{default:j(()=>[m("span",null,"v"+q(u(p)),1)]),_:1},8,["direction"])]),m("div",{onClick:c[5]||(c[5]=g=>{var h;return(h=n.value)==null?void 0:h.open()})},[R(pe,{display:"Saves",direction:u(G).Right},{default:j(()=>[Ml]),_:1},8,["direction"])]),m("div",{onClick:c[6]||(c[6]=g=>{var h;return(h=r.value)==null?void 0:h.open()})},[R(pe,{display:"Settings",direction:u(G).Right},{default:j(()=>[Il]),_:1},8,["direction"])]),m("div",{onClick:c[7]||(c[7]=g=>{var h;return(h=t.value)==null?void 0:h.open()})},[R(pe,{display:"Info",direction:u(G).Right},{default:j(()=>[$l]),_:1},8,["direction"])]),m("div",null,[m("a",Ll,[R(pe,{display:"Forums",direction:u(G).Right,xoffset:"7px"},{default:j(()=>[Rl]),_:1},8,["direction"])])]),m("div",Fl,[m("span",{onClick:b,class:"material-icons"},"discord"),m("ul",Pl,[u(v)?(_(),C("li",Tl,[m("a",{href:u(v),target:"_blank"},q(u(l)),9,El)])):P("",!0),zl,Ol])])],16)),R(ha,{ref_key:"info",ref:t,changelog:i.value},null,8,["changelog"]),R(Qn,{ref_key:"savesManager",ref:n},null,512),R(Ia,{ref_key:"options",ref:r},null,512),R(Ko,{ref_key:"changelog",ref:i},null,512)],64))}});var er=W(Dl,[["__scopeId","data-v-106a74bf"]]);const Al={class:"inner-tab"},Vl=A({__name:"Game",setup(e){const t=We(J,"tabs"),n=k(()=>Object.keys(Ne)),r=ee.useHeader;function i(s){const{display:a,minimized:o,name:l,color:v,minimizable:p,nodes:b,minimizedDisplay:d}=s;return{display:a,minimized:o,name:l,color:v,minimizable:p,nodes:b,minimizedDisplay:d}}return(s,a)=>(_(),C("div",{class:ne(["tabs-container",{useHeader:u(r)}])},[(_(!0),C(X,null,he(t.value,(o,l)=>{var v,p;return _(),C("div",{key:l,class:ne(["tab",u((v=u(Ne)[o])==null?void 0:v.classes)]),style:re(u((p=u(Ne)[o])==null?void 0:p.style))},[l===0&&!u(r)?(_(),O(er,{key:0})):P("",!0),m("div",Al,[n.value.includes(o)?(_(),O(Go,Ze({key:0},i(u(Ne)[o]),{index:l,onSetMinimized:b=>u(Ne)[o].minimized.value=b}),null,16,["index","onSetMinimized"])):(_(),O(se(o),{key:1,index:l},null,8,["index"]))])],6)}),128))],2))}});var jl=W(Vl,[["__scopeId","data-v-88992ffc"]]);const Bl=["x1","y1","x2","y2"],ql=["x1","y1","x2","y2"],Ul=A({__name:"BoardLink",props:{link:{},dragging:{},dragged:{}},setup(e){const t=e,n=Ce(t),r=k(()=>{var h,S,M,y,$,T,V;const g={...n.link.value.startNode.position};return n.link.value.offsetStart&&(g.x+=u(n.link.value.offsetStart).x,g.y+=u(n.link.value.offsetStart).y),((h=n.dragging)==null?void 0:h.value)===n.link.value.startNode&&(g.x+=(y=(M=(S=n.dragged)==null?void 0:S.value)==null?void 0:M.x)!=null?y:0,g.y+=(V=(T=($=n.dragged)==null?void 0:$.value)==null?void 0:T.y)!=null?V:0),g}),i=k(()=>{var h,S,M,y,$,T,V;const g={...n.link.value.endNode.position};return n.link.value.offsetEnd&&(g.x+=u(n.link.value.offsetEnd).x,g.y+=u(n.link.value.offsetEnd).y),((h=n.dragging)==null?void 0:h.value)===n.link.value.endNode&&(g.x+=(y=(M=(S=n.dragged)==null?void 0:S.value)==null?void 0:M.x)!=null?y:0,g.y+=(V=(T=($=n.dragged)==null?void 0:$.value)==null?void 0:T.y)!=null?V:0),g}),s=k(()=>Qi(t.link)),a=k(()=>i.value.x-r.value.x),o=k(()=>Math.abs(a.value)),l=k(()=>i.value.y-r.value.y),v=k(()=>Math.abs(l.value)),p=k(()=>Math.min(o.value,v.value)),b=k(()=>Math.max(o.value,v.value)-p.value),d=k(()=>p.value>b.value),c=k(()=>d.value?{x:r.value.x+(a.value>0?p.value:-p.value),y:r.value.y+(l.value>0?p.value:-p.value)}:{x:i.value.x-(a.value>0?p.value:-p.value),y:i.value.y-(l.value>0?p.value:-p.value)});return(g,h)=>(_(),C(X,null,[m("line",Ze({class:"link"},s.value,{class:{pulsing:g.link.pulsing},x1:r.value.x,y1:r.value.y,x2:c.value.x,y2:c.value.y,"stroke-linecap":"round"}),null,16,Bl),m("line",Ze({class:"link"},s.value,{class:{pulsing:g.link.pulsing},x1:c.value.x,y1:c.value.y,x2:i.value.x,y2:i.value.y,"stroke-linecap":"round"}),null,16,ql)],64))}});var Zl=W(Ul,[["__scopeId","data-v-78507cb5"]]);const Wl={key:0},Gl=["transform","onMousedown","onTouchstartPassive","onMouseup","onTouchend"],Hl=["fill","stroke-width","stroke"],Yl=["fill"],Jl=A({__name:"BoardNodeAction",props:{node:{},nodeType:{},actions:{},isSelected:{type:Boolean},selectedAction:{}},emits:["clickAction"],setup(e,{emit:t}){const r=Ce(e),i=k(()=>z(r.nodeType.value.size,u(r.node))),s=k(()=>{var p;return(p=z(r.nodeType.value.outlineColor,u(r.node)))!=null?p:Te[te.theme].variables["--outline"]}),a=k(()=>{var p;return(p=z(r.nodeType.value.titleColor,u(r.node)))!=null?p:Te[te.theme].variables["--foreground"]}),o=k(()=>z(r.nodeType.value.actionDistance,u(r.node)));function l(p,b){t("clickAction",b.id),p.preventDefault(),p.stopPropagation()}function v(p,b){var d;((d=u(r.selectedAction))==null?void 0:d.id)===b.id&&(p.preventDefault(),p.stopPropagation())}return(p,b)=>(_(),O(mt,{name:"actions",appear:""},{default:j(()=>[p.isSelected&&p.actions?(_(),C("g",Wl,[(_(!0),C(X,null,he(p.actions,(d,c)=>{var g,h;return _(),C("g",{key:d.id,class:ne(["action",{selected:((g=p.selectedAction)==null?void 0:g.id)===d.id}]),transform:`translate(
                        ${(-i.value-10)*Math.sin(((p.actions.length-1)/2-c)*o.value)},
                        ${(i.value+10)*Math.cos(((p.actions.length-1)/2-c)*o.value)}
                    )`,onMousedown:S=>l(S,d),onTouchstartPassive:S=>l(S,d),onMouseup:S=>v(S,d),onTouchend:ut(S=>v(S,d),["stop"])},[m("circle",{fill:u(z)(d.fillColor,p.node),r:"5","stroke-width":((h=p.selectedAction)==null?void 0:h.id)===d.id?1:0,stroke:s.value},null,8,Hl),m("text",{fill:a.value,class:"material-icons"},q(u(z)(d.icon,p.node)),9,Yl)],42,Gl)}),128))])):P("",!0)]),_:1}))}});var Kl=W(Jl,[["__scopeId","data-v-8b91ff32"]]);const Xl=["r","fill","stroke"],Ql=["r","fill","stroke"],eu=["r","fill"],tu=["r","stroke-dasharray","stroke-dashoffset","stroke"],nu=A({__name:"CircleNode",props:{receivingNode:{type:Boolean},canAccept:{type:Boolean},size:{},progress:{},progressDisplay:{},progressColor:{},backgroundColor:{},fillColor:{},outlineColor:{}},setup(e){return(t,n)=>(_(),C("g",null,[t.canAccept?(_(),C("circle",{key:0,class:"receiver",r:t.size+8,fill:t.backgroundColor,stroke:t.receivingNode?"#0F0":"#0F03","stroke-width":2},null,8,Xl)):P("",!0),m("circle",{class:"body",r:t.size,fill:t.fillColor,stroke:t.outlineColor,"stroke-width":4},null,8,Ql),t.progressDisplay===u(dn).Fill?(_(),C("circle",{key:1,class:"progress progressFill",r:Math.max(t.size*t.progress-2,0),fill:t.progressColor},null,8,eu)):(_(),C("circle",{key:2,r:t.size+4.5,class:"progress progressRing",fill:"transparent","stroke-dasharray":(t.size+4.5)*2*Math.PI,"stroke-width":5,"stroke-dashoffset":(t.size+4.5)*2*Math.PI-t.progress*(t.size+4.5)*2*Math.PI,stroke:t.progressColor},null,8,tu))]))}});var ru=W(nu,[["__scopeId","data-v-4e08eac2"]]);const iu={transform:"rotate(45, 0, 0)"},su=["width","height","transform","fill","stroke"],ou=["width","height","transform","fill","stroke"],au=["width","height","transform","fill"],lu=["width","height","transform","stroke-dasharray","stroke-dashoffset","stroke"],uu=A({__name:"DiamondNode",props:{receivingNode:{type:Boolean},canAccept:{type:Boolean},size:{},progress:{},progressDisplay:{},progressColor:{},backgroundColor:{},fillColor:{},outlineColor:{}},setup(e){const t=Math.sqrt(2);return(n,r)=>(_(),C("g",iu,[n.canAccept?(_(),C("rect",{key:0,class:"receiver",width:n.size*u(t)+16,height:n.size*u(t)+16,transform:`translate(${-(n.size*u(t)+16)/2}, ${-(n.size*u(t)+16)/2})`,fill:n.backgroundColor,stroke:n.receivingNode?"#0F0":"#0F03","stroke-width":2},null,8,su)):P("",!0),m("rect",{class:"body",width:n.size*u(t),height:n.size*u(t),transform:`translate(${-n.size*u(t)/2}, ${-n.size*u(t)/2})`,fill:n.fillColor,stroke:n.outlineColor,"stroke-width":4},null,8,ou),n.progressDisplay===u(dn).Fill?(_(),C("rect",{key:1,class:"progress progressFill",width:Math.max(n.size*u(t)*n.progress-2,0),height:Math.max(n.size*u(t)*n.progress-2,0),transform:`translate(${-Math.max(n.size*u(t)*n.progress-2,0)/2}, ${-Math.max(n.size*u(t)*n.progress-2,0)/2})`,fill:n.progressColor},null,8,au)):(_(),C("rect",{key:2,class:"progress progressDiamond",width:n.size*u(t)+9,height:n.size*u(t)+9,transform:`translate(${-(n.size*u(t)+9)/2}, ${-(n.size*u(t)+9)/2})`,fill:"transparent","stroke-dasharray":(n.size*u(t)+9)*4,"stroke-width":5,"stroke-dashoffset":(n.size*u(t)+9)*4-n.progress*(n.size*u(t)+9)*4,stroke:n.progressColor},null,8,lu))]))}});var cu=W(uu,[["__scopeId","data-v-6838efb6"]]);function tr(e,t=!1){var r,i,s;const n=K[e.type];switch(n.alignment){case ve.Friendly:{if(n.building){const a=z(n.building,e);e.buildMaterials=Object.fromEntries(Object.entries(a.cost).map(([o,l])=>[o,t?0:l])),a.storage&&(e.storage=a.storage.map(o=>{var l;return{resource:I.Empty,amount:(l=o.default)!=null?l:0}})),a.recipes&&(e.recipeTime=0,a.recipes.filter(o=>o.unlocked===void 0||z(o.unlocked,e)).length===1&&(e.activeRecipe=a.recipes.indexOf(a.recipes.find(o=>o.unlocked===void 0||z(o.unlocked,e)))))}e.type===D.Analyzer&&(e.state={timeLeft:0,index:4,0:{resource:I.ConsumptionResearch,amount:0},1:{resource:I.LogisticalResearch,amount:0},2:{resource:I.BalisticsResearch,amount:0},3:{resource:I.RampancyResearch,amount:0},4:{resource:I.CircularResearch,amount:0}});break}case ve.Neutral:break;case ve.Hostile:break}(r=e.connectedNodes)!=null||(e.connectedNodes=[]),(i=e.distance)!=null||(e.distance=-1),(s=e.buildMaterials)!=null||(e.buildMaterials={})}function ue(e){return tr(e,!0),e}function Jt(e){return tr(e),{...e,id:rd(L.board)}}k(()=>L.board.nodes.value[0]);function du(){const e=[ue({position:{x:0,y:0},type:D.Core,distance:0}),ue({position:{x:-100,y:0},type:D.Scrap}),ue({position:{x:-400,y:60},type:D.Scrap}),ue({position:{x:-190,y:270},type:D.Scrap}),ue({position:{x:310,y:-170},type:D.Scrap}),ue({position:{x:220,y:400},type:D.Scrap}),ue({position:{x:-40,y:490},type:D.Scrap}),ue({position:{x:-20,y:-250},type:D.Scrap}),ue({position:{x:-450,y:290},type:D.Scrap}),ue({position:{x:500,y:10},type:D.Scrap}),ue({position:{x:380,y:230},type:D.Scrap}),ue({position:{x:-180,y:-430},type:D.Scrap}),ue({position:{x:-280,y:-270},type:D.Scrap}),ue({position:{x:250,y:-380},type:D.Scrap}),ue({position:{x:10,y:-520},type:D.Scrap}),ue({position:{x:160,y:180},type:D.Scrap}),ue({position:{x:-210,y:-60},type:D.Scrap}),ue({position:{x:-490,y:-180},type:D.Scrap}),ue({position:{x:440,y:-310},type:D.Scrap}),ue({position:{x:-270,y:460},type:D.Scrap}),ue({position:{x:0,y:0},type:D.ContainmentRing})];return e[0].storage[0]={resource:I.Nanites,amount:ye.core.storage[0].limit},e[1].storage=[{resource:I.Scrap,amount:45}],e[2].storage=[{resource:I.Scrap,amount:55}],e[3].storage=[{resource:I.Scrap,amount:95}],e[4].storage=[{resource:I.Scrap,amount:100}],e[5].storage=[{resource:I.Scrap,amount:95}],e[6].storage=[{resource:I.Scrap,amount:45}],e[7].storage=[{resource:I.Scrap,amount:95}],e[8].storage=[{resource:I.Scrap,amount:95}],e[9].storage=[{resource:I.Scrap,amount:50}],e[10].storage=[{resource:I.Scrap,amount:35}],e[11].storage=[{resource:I.Scrap,amount:95}],e[12].storage=[{resource:I.Scrap,amount:40}],e[13].storage=[{resource:I.Scrap,amount:35}],e[14].storage=[{resource:I.Scrap,amount:55}],e[15].storage=[{resource:I.Scrap,amount:55}],e[16].storage=[{resource:I.Scrap,amount:40}],e[17].storage=[{resource:I.Scrap,amount:80}],e[18].storage=[{resource:I.Scrap,amount:95}],e[19].storage=[{resource:I.Scrap,amount:90}],e[20].state={durability:1800,angle:0,size:600},fu(e),e}function fu(e){for(let t=0;t<e.length;t++)for(let n=t+1;n<e.length;n++)ln(e[t],e[n])&&(e[t].connectedNodes.push(n),e[n].connectedNodes.push(t))}function gu(e,t){for(const r of e)r.distance=-1;t.distance=0;const n=[t];for(;n.length>0;){const r=n.shift();for(const i of r.connectedNodes.map(s=>L.idToNodeMap.value[s]))i.distance>=0&&i.distance<=r.distance+1||(i.distance=r.distance+1,!Object.values(r.buildMaterials).some(s=>s>0)&&z(K[i.type].building,r).transferDistance!==void 0&&n.push(i))}}const lt=k(()=>{let e=1/0;for(const t of L.board.nodes.value){if(K[t.type].alignment!==ve.Hostile||t.type!==D.ContainmentRing)continue;const n=t.state.size;n<e&&(e=n)}return e});function kn(e){const t=z(K[e.type].size,e),n=Math.sqrt(e.position.x*e.position.x+e.position.y*e.position.y);if(n+t>=lt.value||e.type===D.Bore&&n<lt.value-100)return!1;if(e.type===D.Scrap){if(Kt.value===void 0)return!1;const r=Kt.value;if((e.position.x-r.position.x)**2+(e.position.y-r.position.y)**2>100**2)return!1}for(const r of L.board.nodes.value){const i=z(K[r.type].size,r),s=t+i;if(!(Math.abs(e.position.x-r.position.x)>=s)&&!(Math.abs(e.position.y-r.position.y)>=s))return!1}return!0}function an(e){const t=L.board.nodes.value.filter(n=>ln(n,e));for(const n of t)n.connectedNodes.push(e.id),e.connectedNodes.push(n.id);L.board.nodes.value.push(e),L.dirty.value=!0}function pu(e){const t=z(K[e.type].building,e);if(t!==void 0){const r=Object.values(t.cost).reduce((i,s)=>i+s);for(const i of L.board.nodes.value.filter(s=>s.type===D.Analyzer).filter(s=>s!==e)){if((e.position.x-i.position.x)**2+(e.position.y-i.position.y)**2>100**2)continue;const a=i.state;a[1].amount+=r,a[1].amount>100&&(a[1].amount=100)}}const n=L.board.nodes.value.filter(r=>ln(r,e));for(const r of n)r.connectedNodes.includes(e.id)||r.connectedNodes.push(e.id),e.connectedNodes.includes(r.id)||e.connectedNodes.push(r.id);L.dirty.value=!0}function $t(e){L.board.state.value.nodes=L.board.state.value.nodes.filter(i=>i.id!==e.id);const t=K[e.type].alignment,r=L.board.nodes.value.filter(i=>K[i.type].alignment===t);for(const i of r)i.connectedNodes=i.connectedNodes.filter(s=>s!==e.id);L.dirty.value=!0}function Sn(e){const t=z(K[e.type].building,e);return t===void 0||t.transferDistance===void 0||Object.values(e.buildMaterials).some(n=>n>0)?0:t.transferDistance}function ln(e,t){if(K[e.type].alignment!==K[t.type].alignment)return!1;const n=Math.abs(e.position.x-t.position.x)+Math.abs(e.position.y-t.position.y);return n<=Sn(e)||n<=Sn(t)}const vu=k(()=>L.board.nodes.value.filter(e=>e.transferRoute).map(e=>e.transferRoute)),Gt=k(()=>{var t,n,r,i;const e={};for(const s of L.board.nodes.value)e[s.id]={};for(const s of vu.value)for(let a=0;a<s.path.length-1;a++){const o=s.path[a],l=s.path[a+1];(n=(t=e[o])[l])!=null||(t[l]=0),e[o][l]+=1,(i=(r=e[l])[o])!=null||(r[o]=0),e[l][o]+=1}return e}),hu=k(()=>L.research.buildSpeed10.researched.value?144:L.research.buildSpeed9.researched.value?89:L.research.buildSpeed8.researched.value?55:L.research.buildSpeed7.researched.value?34:L.research.buildSpeed6.researched.value?21:L.research.buildSpeed5.researched.value?13:L.research.buildSpeed4.researched.value?8:L.research.buildSpeed3.researched.value?5:L.research.buildSpeed2.researched.value?3:L.research.buildSpeed.researched.value?2:1),un=k(()=>L.research.transferSpeed10.researched.value?144:L.research.transferSpeed9.researched.value?89:L.research.transferSpeed8.researched.value?55:L.research.transferSpeed7.researched.value?34:L.research.transferSpeed6.researched.value?21:L.research.transferSpeed5.researched.value?13:L.research.transferSpeed4.researched.value?8:L.research.transferSpeed3.researched.value?5:L.research.transferSpeed2.researched.value?3:L.research.transferSpeed.researched.value?2:1);let ve=function(e){return e.Friendly="friendly",e.Neutral="neutral",e.Hostile="hostile",e}({}),D=function(e){return e.Core="core",e.Extractor="extractor",e.Router="router",e.Foundry="foundry",e.Analyzer="analyzer",e.Researcher="researcher",e.Bore="bore",e.Scrap="scrap",e.ContainmentRing="containmentRing",e}({});const K=Ie(()=>{const e={id:"delete-node",visibility:!0,icon:"\u{1F5D1}\uFE0F",tooltip(){return{text:"Remove this node",color:"var(--foreground)"}},onClick(r){$t(r)}},t={id:"place-scrap",visibility(r){return!(r.state in L.idToNodeMap.value)},icon:"\u{1F517}",tooltip(){return{text:"Pick the output scrap pile location",color:"var(--foreground)"}},onClick(r){Kt.value=r;const i=Jt({position:{x:0,y:0},type:D.Scrap});i.storage=[{resource:I.Scrap,amount:0}],r.state=i.id,L.board.draggingNode.value=i}},n={[ve.Friendly]:{[D.Core]:{size:20,shape:()=>ce.Core,building:ye.core},[D.Extractor]:{size:10,shape:()=>ce.Extractor,building:ye.extractor,onStoreEmpty(r){$t(r)},actions:[e]},[D.Router]:{size:10,shape:()=>ce.Router,building:ye.router,actions:[e]},[D.Foundry]:{size:15,shape:()=>ce.Foundry,building:ye.foundry,actions:[e]},[D.Analyzer]:{size:15,shape:()=>ce.Analyzer,building:ye.analyzer,update(r,i){const s=z(K[r.type].building,r);if(s===void 0||Object.values(r.buildMaterials).some(o=>o>0))return;const a=r.state;if(a.timeLeft>0&&(a.timeLeft-=i,a.timeLeft<=0)){a.timeLeft=0;const l=(s.storage[a.index].limit==="node"?r.storage[a.index].limit:s.storage[a.index].limit)-r.storage[a.index].amount;r.storage[a.index].amount+=Math.min(1,a[a.index].amount,l),r.storage[a.index].resource=a[a.index].resource,a[a.index].amount-=Math.min(1,a[a.index].amount,l)}if(a.timeLeft===0)for(let o=a.index+1;o<a.index+6;o++){const l=o%5,v=r.storage[l],p=s.storage[l];if(!(a[l].amount<1||(p.limit==="node"?v.limit:p.limit)-v.amount<1)){a.timeLeft=1,a.index=l;return}}},actions:[e]},[D.Researcher]:{size:15,shape:()=>ce.Researcher,building:ye.researcher,update(r,i){Nu(r,i)},actions:[e]},[D.Bore]:{size:20,shape:()=>ce.Bore,building:ye.bore,update(r,i){if(r.storage[0].amount<i||r.state===void 0)return;if(!(r.state in L.idToNodeMap.value)){r.state=void 0;return}if(r.position.x**2+r.position.y**2<(lt.value-100)**2)return;r.storage[0].amount-=i;const s=L.idToNodeMap.value[r.state].storage[0];s.resource=I.Scrap,s.amount+=i*1.5,s.amount>s.limit&&(s.limit=s.amount);const o=L.board.nodes.value.find(l=>l.type===D.ContainmentRing).state;o.durability-=i;for(const l of L.board.nodes.value.filter(v=>v.type===D.Analyzer)){if((r.position.x-l.position.x)**2+(r.position.y-l.position.y)**2>100**2)continue;const p=l.state;p[2].amount+=i,p[2].amount>100&&(p[2].amount=100)}},actions:[t,e]}},[ve.Neutral]:{[D.Scrap]:{size:15,shape:()=>ce.Scrap,label:r=>{let i=!1;if(L.board.selectedNode.value===r&&(i=!0),L.board.draggingNode.value!=null&&Lt(r,L.board.draggingNode.value)&&(i=!0),i){const s=r.storage[0];return{text:`${ct[s.resource].name}: ${s.amount}`}}}}},[ve.Hostile]:{[D.ContainmentRing]:{size:0,shape:()=>ce.ContainmentRing,durability(r){const i=r.state;return i===void 0?1800:180*10**(i.size/600)},update(r,i){const s=r.state;if(s.durability<=0){$t(r);const a=1+r.state.size/600,o=Jt({position:{x:0,y:0},type:D.ContainmentRing});o.state={durability:180*10**a,angle:0,size:600*a},an(o);return}s.angle+=i*Math.PI/30,s.angle%=2*Math.PI}}}};for(const r of Object.values(n[ve.Friendly]))r.canAccept=Lt,r.onDrop=Cn,r.alignment=ve.Friendly;for(const r of Object.values(n[ve.Neutral]))r.canAccept=Lt,r.onDrop=Cn,r.alignment=ve.Neutral;for(const r of Object.values(n[ve.Hostile]))r.alignment=ve.Hostile,r.onClick=i=>{};return{...n[ve.Friendly],...n[ve.Neutral],...n[ve.Hostile]}});function Lt(e,t){const n=z(K[t.type].building,t);return n===void 0||n.buildableOn===void 0?!1:n.buildableOn.includes(e.type)}function Cn(e,t){var r;if(!Lt(e,t))return;t.position=e.position;const n=z(K[t.type].building,t);(r=n==null?void 0:n.onBuild)==null||r.call(n,t,e),$t(e),an(t)}function kt(e,t,n=[],r=new Set){r.add(e.id);const i=e.connectedNodes.filter(s=>!r.has(s));for(const s of i)r.add(s);for(const s of i.map(a=>L.idToNodeMap.value[a])){if(Object.values(s.buildMaterials).some(o=>o>0))continue;const a=nr(s,t,[e.id,...n],r);if(a!==void 0)return a}}function nr(e,t,n,r){const i=z(K[e.type].building,e);if(i===void 0)return;if(i.storage!==void 0)for(let a=0;a<e.storage.length;a++){if(i.storage[a].type!=="output")continue;const o=e.storage[a];if(o.resource===t&&!(o.amount<=0))return{resource:t,path:[e.id,...n],store:a}}if(i.transferDistance===void 0)return;const s=e.connectedNodes.filter(a=>!r.has(a));for(const a of s)r.add(a);for(const a of s.map(o=>L.idToNodeMap.value[o])){if(Object.values(a.buildMaterials).some(l=>l>0))continue;const o=nr(a,t,[e.id,...n],r);if(o!==void 0)return o}}let I=function(e){return e.Empty="empty",e.Nanites="nanites",e.Scrap="scrap",e.Plates="plates",e.ConsumptionResearch="consumption",e.LogisticalResearch="logistics",e.BalisticsResearch="balistics",e.RampancyResearch="rampancy",e.CircularResearch="circularLogic",e}({});const cn=k(()=>{const e=L.board.nodes.value,t={};for(const n of e){const r=K[n.type];if(!(r.alignment!==ve.Friendly||!r.building||!z(r.building,n).storage)&&!Object.values(n.buildMaterials).some(s=>s>0))for(const s of n.storage)t[s.resource]===void 0&&(t[s.resource]=0),t[s.resource]+=s.amount}return t}),ct={[I.Empty]:{name:"Empty",symbol:"",visibility:!1},[I.Nanites]:{name:"Nanites",symbol:"\u{1F517}&#xFE0E;"},[I.Scrap]:{name:"Scrap",symbol:'<div style="transform: rotate(45deg)">\u{1F4CE}&#xFE0E;</div>'},[I.Plates]:{name:"Metal Plates",symbol:'<div style="transform: rotate(45deg)">\u{1F536}&#xFE0E;</div>'},[I.ConsumptionResearch]:{name:"Consumption Reports",symbol:"\u{1F50C}&#xFE0E;"},[I.LogisticalResearch]:{name:"Logistical Notes",symbol:"\u{1F529}&#xFE0E;"},[I.BalisticsResearch]:{name:"Balistics Tests",symbol:"\u{1F536}&#xFE0E;"},[I.RampancyResearch]:{name:"Rampant Studies",symbol:'<div style="transform: rotate(45deg)">\u{1F4A2}&#xFE0E;</div>'},[I.CircularResearch]:{name:"Circular Logic",symbol:"\u{1F300}&#xFE0E;"}};let Kt=B(void 0);const ye={core:Ie(()=>({cost:{},transferDistance:200,storage:[{resources:[I.Nanites],limit:100,default:100,type:"output"},{resources:[I.Scrap],limit:1,type:"input"}],recipes:[{input:{[I.Scrap]:1},output:{[I.Nanites]:1},duration:1}]})),extractor:Ie(()=>({buildableOn:[D.Scrap],cost:{[I.Nanites]:10},storage:[{resources:[I.Scrap],limit:"node",type:"output"}],display:{name:"Extractor",description:"Extract scrap from ruined nodes"},onBuild(e,t){if(t===void 0)return;e.storage[0]=t.storage[0],e.storage[0].limit=t.storage[0].amount;const n=L.board.nodes.value.filter(r=>r.type===D.Bore).find(r=>r.state===t.id);n!==void 0&&(n.state=e.id)}})),router:Ie(()=>({cost:{[I.Nanites]:5},transferDistance:100,display:{name:"Router",description:"Transfer resources to further-away nodes"}})),foundry:Ie(()=>({cost:{[I.Nanites]:25},display:{name:"Foundry",description:"Form clusters of nanites into structural materials"},storage:[{resources:[I.Nanites],limit:10,type:"input"},{resources:[I.Plates],limit:5,type:"output"}],recipes:[{input:{[I.Nanites]:10},output:{[I.Plates]:1},duration:10}]})),analyzer:Ie(()=>({cost:{[I.Nanites]:25,[I.Plates]:5},display:{name:"Analyzer",description:"Computational attachement module, produces data based on surrounding activity"},storage:[{resources:[I.ConsumptionResearch],limit:100,type:"output"},{resources:[I.LogisticalResearch],limit:100,type:"output"},{resources:[I.BalisticsResearch],limit:100,type:"output"},{resources:[I.RampancyResearch],limit:100,type:"output"},{resources:[I.CircularResearch],limit:100,type:"output"}]})),researcher:Ie(()=>({cost:{[I.Nanites]:25,[I.Plates]:5},display:{name:"Researcher",description:"Process data to improve and iterate upon nanite structures and design"},storage:[{resources:[I.ConsumptionResearch],limit:100,type:"input"},{resources:[I.LogisticalResearch],limit:100,type:"input"},{resources:[I.BalisticsResearch],limit:100,type:"input"},{resources:[I.RampancyResearch],limit:100,type:"input"},{resources:[I.CircularResearch],limit:100,type:"input"}]})),bore:Ie(()=>({cost:{[I.Nanites]:25,[I.Plates]:5},display:{name:"Nanite Bore",description:"Send a stream of nanites to break down nearby hardened structures"},storage:[{resources:[I.Nanites],limit:15,type:"input"}]}))};function mu(e,t){var s,a;if(e.activeRecipe===void 0)return;const n=z(K[e.type].building,e);if(n===void 0||n.storage===void 0||n.recipes===void 0)return;const r=n.storage,i=n.recipes[e.activeRecipe];if(e.recipeTime>0){if(e.recipeTime-=t,e.recipeTime<=0){e.recipeTime=0;const o=[],l=e.storage.map((v,p)=>[v,p]).filter((v,p)=>r[p].type==="output");for(const[v,p]of Object.entries(i.output)){const b=(s=l.find(([d,c])=>d.resource===v))==null?void 0:s[0];b===void 0?o.push(v):b.amount+=p}for(const v of o){const p=(a=l.find(([b,d])=>b.resource===I.Empty&&r[d].resources.includes(v)))==null?void 0:a[0];if(p===void 0){console.error(`Node ${e.id} storage too full for recipe!`,e,n);return}p.resource=v,p.amount+=i.output[v]}for(const v of L.board.nodes.value.filter(p=>p.type===D.Analyzer)){if((e.position.x-v.position.x)**2+(e.position.y-v.position.y)**2>100**2)continue;const b=v.state;b[0].amount+=i.duration,b[0].amount>100&&(b[0].amount=100)}}}else{const o=[];for(let p=0;p<e.storage.length;p++)r[p].type==="output"&&o.push([e.storage[p],r[p]]);for(const p of Object.keys(i.output)){const b=o.find(d=>d[0].resource===p);if(b!==void 0&&b[0].amount+i.output[p]>(b[1].limit==="node"?b[0].limit:b[1].limit))return}const l=e.storage.filter((p,b)=>r[b].type==="input"),v={};for(const[p,b]of Object.entries(i.input)){for(let c=0;c<e.storage.length;c++)r[c].type;const d=l.find(c=>c.resource===p);if(d===void 0||d.amount<b)return;v[p]=d}if(Object.keys(v).length!==Object.keys(i.input).length)return;for(const[p,b]of Object.entries(v))b.amount-=i.input[p],b.amount<=0&&(b.amount=0,b.resource=I.Empty);e.recipeTime=i.duration}}function bu(e,t){if(!(e.distance<0)&&!Object.values(e.buildMaterials).every(n=>n===0))if(e.transferRoute===void 0){for(const n of Object.keys(e.buildMaterials).filter(r=>e.buildMaterials[r]>0))if(e.transferRoute=kt(e,n),e.transferRoute!==void 0)return}else{for(const a of e.transferRoute.path)if(!(a in L.idToNodeMap.value&&L.idToNodeMap.value[a].distance>=0)){delete e.transferRoute;return}const n=L.idToNodeMap.value[e.transferRoute.path[0]],{resource:r,store:i}=e.transferRoute,s=Math.min(n.storage[i].amount,e.buildMaterials[r],hu.value*t);e.buildMaterials[r]-=s,n.storage[i].amount-=s,n.storage[i].amount<=0&&(n.storage[i].amount=0,n.storage[i].resource=I.Empty,delete e.transferRoute),e.buildMaterials[r]<=0&&(e.buildMaterials[r]=0,Object.values(e.buildMaterials).every(a=>a===0)&&pu(e),delete e.transferRoute)}}function yu(e,t){var r,i;if(e.distance<0||e.type!==D.Bore||Object.values(e.buildMaterials).some(s=>s>0))return;const n=z(K[e.type].building,e);if(n!==void 0&&n.storage!==void 0)if(e.transferRoute===void 0){if(e.storage[0].amount>=n.storage[0].limit||(e.transferRoute=kt(e,n.storage[0].resources[0]),e.transferRoute!==void 0))return}else{for(const b of e.transferRoute.path)if(!(b in L.idToNodeMap.value&&L.idToNodeMap.value[b].distance>=0)){delete e.transferRoute;return}const s=L.idToNodeMap.value[e.transferRoute.path[0]],{resource:a,store:o}=e.transferRoute,l=n.storage[0].limit==="node"?e.storage[0].limit:n.storage[0].limit,v=l-e.storage[0].amount,p=Math.min(s.storage[o].amount,v,un.value*t);e.storage[0].resource=a,e.storage[0].amount+=p,s.storage[o].amount-=p,s.storage[o].amount<=0&&(s.storage[o].amount=0,s.storage[o].resource=I.Empty,(i=(r=K[s.type]).onStoreEmpty)==null||i.call(r,s,o),delete e.transferRoute),l-e.storage[0].amount<=0&&(e.storage[0].amount=l,delete e.transferRoute)}}function _u(e,t){var i,s;if(e.distance<0||Object.values(e.buildMaterials).some(a=>a>0)||e.activeRecipe===void 0)return;const n=z(K[e.type].building,e);if(n===void 0||n.storage===void 0||n.recipes===void 0)return;const r=[];for(let a=0;a<e.storage.length;a++)n.storage[a].type==="input"&&r.push([e.storage[a],n.storage[a]]);if(e.transferRoute===void 0){const a=n.recipes[e.activeRecipe].input,o=[],l=[],v=[];for(let p=0;p<r.length;p++)for(const[b,d]of Object.entries(a))if(!o.includes(b)&&!l.includes(b)&&!v.includes(b)&&r[p][0].resource===b){if(r[p][0].amount>=d){const c=e.storage[p],g=n.storage[p];c.amount>=(g.limit==="node"?c.limit:g.limit)?o.push(b):l.push(b)}else v.push(b);break}v.push(...Object.keys(a).filter(p=>!o.includes(p)).filter(p=>!l.includes(p)).filter(p=>!v.includes(p)));for(const p of v)if(e.transferRoute=kt(e,p),e.transferRoute!==void 0)return;for(const p of l)if(e.transferRoute=kt(e,p),e.transferRoute!==void 0)return}else{for(const c of e.transferRoute.path)if(!(c in L.idToNodeMap.value&&L.idToNodeMap.value[c].distance>=0)){delete e.transferRoute;return}const a=L.idToNodeMap.value[e.transferRoute.path[0]],{resource:o,store:l}=e.transferRoute;let v=r.find(([c,g])=>c.resource===o);if(v===void 0&&(v=r.find(([c,g])=>c.resource===I.Empty&&g.resources.includes(o))),v===void 0){delete e.transferRoute;return}const p=v[1].limit==="node"?v[0].limit:v[1].limit,b=p-v[0].amount,d=Math.min(a.storage[l].amount,b,un.value*t);v[0].resource=o,v[0].amount+=d,a.storage[l].amount-=d,a.storage[l].amount<=0&&(a.storage[l].amount=0,a.storage[l].resource=I.Empty,(s=(i=K[a.type]).onStoreEmpty)==null||s.call(i,a,l),delete e.transferRoute),p-v[0].amount<=0&&(v[0].amount=p,delete e.transferRoute)}}function Nu(e,t){var i,s;if(e.distance<0||e.type!==D.Researcher||Object.values(e.buildMaterials).some(a=>a>0))return;const n=z(K[e.type].building,e);if(n===void 0||n.storage===void 0)return;const r=[];for(let a=0;a<e.storage.length;a++)n.storage[a].type==="input"&&r.push([e.storage[a],n.storage[a]]);if(e.transferRoute===void 0){for(const[a,o]of r)if((o.limit==="node"?a.limit:o.limit)-a.amount>=1&&(e.transferRoute=kt(e,o.resources[0]),e.transferRoute!==void 0))return}else{for(const c of e.transferRoute.path)if(!(c in L.idToNodeMap.value&&L.idToNodeMap.value[c].distance>=0)){delete e.transferRoute;return}const a=L.idToNodeMap.value[e.transferRoute.path[0]],{resource:o,store:l}=e.transferRoute;let v=r.find(([c,g])=>c.resource===o);if(v===void 0&&(v=r.find(([c,g])=>c.resource===I.Empty&&g.resources.includes(o))),v===void 0){delete e.transferRoute;return}const p=v[1].limit==="node"?v[0].limit:v[1].limit,b=p-v[0].amount,d=Math.min(a.storage[l].amount,b,un.value*t);v[0].resource=o,v[0].amount+=d,a.storage[l].amount-=d,a.storage[l].amount<=0&&(a.storage[l].amount=0,a.storage[l].resource=I.Empty,(s=(i=K[a.type]).onStoreEmpty)==null||s.call(i,a,l),delete e.transferRoute),p-v[0].amount<=0&&(v[0].amount=p,delete e.transferRoute)}}function wu(e,t,n){if(!(t.distance<0)&&t.type===D.Researcher&&!Object.values(t.buildMaterials).some(r=>r>0))for(const r of t.storage){if(r.amount<=0||e.progress.value[r.resource]===void 0||e.progress.value[r.resource]<=0)continue;const i=Math.min(r.amount,e.progress.value[r.resource],1*n);e.progress.value[r.resource]-=i,e.progress.value[r.resource]<0&&(e.progress.value[r.resource]=0),r.amount-=i,r.amount<0&&(r.amount=0,r.resource=I.Empty)}}function ku(){for(const e of L.board.nodes.value)if(e.storage!==void 0)for(const t of e.storage)t.resource!==I.Empty&&(t.amount>.98||(t.amount=Math.round(t.amount*100)/100,t.amount<=0&&(t.amount=0,t.resource=I.Empty)))}const Su=["d"],Cu=["width","height","transform","stroke"],xu=["d"],Mu=["width","height","transform","stroke"],Iu=["d"],Ae=2,$u=A({__name:"Core",props:{node:{},size:{},placing:{type:Boolean}},setup(e){const t=e,n=Math.sqrt(2),r=k(()=>{var c;return(c=t.size)!=null?c:10}),i=k(()=>-r.value*n/2),s=k(()=>2*i.value+Ae),a=k(()=>2*i.value-Ae),o=k(()=>{if(t.node===void 0)return"var(--outline)";const c=t.node;return Object.values(c.buildMaterials).some(g=>g>0)?"var(--locked)":c.distance===-1?"var(--danger)":"var(--outline)"}),l=k(()=>{var S;const c=ye.core.storage;if(t.node===void 0)return Array.from({length:c.length}).fill(0);const g=t.node,h=[];for(let M=0;M<c.length;M++){const y=c[M];h[M]=g.storage[M].amount/(y.limit==="node"?(S=g.storage[M].limit)!=null?S:1:y.limit),h[M]<0&&(h[M]=0),h[M]>1&&(h[M]=1)}return h}),v=k(()=>{const c=l.value[0],g=s.value/2,h={x:-g/2,y:-g/2};return(c<.5?["M",h.x,h.y,"L",h.x+g*c*2,h.y,"L",h.x,h.y+g*c*2,"Z"]:["M",h.x,h.y,"L",h.x+g,h.y,"L",h.x+g,h.y+g*(c-.5)*2,"L",h.x+g*(c-.5)*2,h.y+g,"L",h.x,h.y+g,"Z"]).join(" ")}),p=k(()=>{const c=l.value[1],g={x:-s.value/2,y:-s.value/2};return(c<.5?["M",g.x,g.y,"L",g.x,g.y+s.value*c*2,"L",g.x+s.value*c*2,g.y,"Z"]:["M",g.x,g.y,"L",g.x,g.y+s.value,"L",g.x+s.value*(c-.5)*2,g.y+s.value,"L",g.x+s.value,g.y+s.value*(c-.5)*2,"L",g.x+s.value,g.y,"Z"]).join(" ")}),b=k(()=>{if(t.node===void 0||t.node.activeRecipe===void 0||t.node.recipeTime<=0)return 0;const c=z(K[t.node.type].building,t.node);return c===void 0||c.recipes===void 0?0:Math.max(0,1-t.node.recipeTime/c.recipes[t.node.activeRecipe].duration)}),d=k(()=>{const c=-a.value/2+Ae,g={x:c,y:c};if(b.value<.25){const h=b.value*4;return["M",0,0,"L",g.x,g.y,"L",g.x,g.y-2*c*h,"Z"].join(" ")}else if(b.value<.5){const h=(b.value-.25)*4;return["M",0,0,"L",g.x,g.y,"L",g.x,-g.y,"L",g.x-2*c*h,-g.y,"Z"].join(" ")}else if(b.value<.75){const h=(b.value-.5)*4;return["M",0,0,"L",g.x,g.y,"L",g.x,-g.y,"L",-g.x,-g.y,"L",-g.x,-g.y+2*c*h,"Z"].join(" ")}else{const h=b.value>1?1:(b.value-.75)*4;return["M",0,0,"L",g.x,g.y,"L",g.x,-g.y,"L",-g.x,-g.y,"L",-g.x,g.y,"L",-g.x+2*c*h,g.y,"Z"].join(" ")}});return(c,g)=>(_(),C("g",{transform:"rotate(45, 0, 0)",style:re({opacity:c.placing?.5:1})},[b.value>0?(_(),C("path",{key:0,class:"progress",d:d.value,fill:"var(--foreground)"},null,8,Su)):P("",!0),m("rect",{class:"body",width:r.value*u(n),height:r.value*u(n),transform:`translate(${i.value} ${i.value})`,fill:"var(--locked)",stroke:o.value,"stroke-width":Ae},null,8,Cu),l.value[1]>0?(_(),C("path",{key:1,class:"storage",d:p.value,fill:"var(--accent1)"},null,8,xu)):P("",!0),m("rect",{class:"storage",width:-s.value/2+Ae,height:-s.value/2+Ae,transform:`translate(${s.value/4-Ae/2} ${s.value/4-Ae/2})`,fill:"var(--locked)",stroke:o.value,"stroke-width":Ae},null,8,Mu),l.value[0]>0?(_(),C("path",{key:2,class:"storage",d:v.value,fill:"var(--outline)"},null,8,Iu)):P("",!0)],4))}});var Lu=W($u,[["__scopeId","data-v-36fca5be"]]);const Ru=["r","stroke"],Fu={key:0,transform:"rotate(90, 0, 0) scale(1, -1)"},Pu=["r","stroke-dashoffset"],Tu=A({__name:"Router",props:{node:{},size:{},placing:{type:Boolean}},emits:["select-building","place-building"],setup(e,{emit:t}){const n=e,r=k(()=>{if(n.node===void 0||L.board.draggingNode.value===n.node)return"var(--outline)";const a=n.node;return Object.values(a.buildMaterials).some(o=>o>0)?"var(--locked)":a.distance===-1?"var(--danger)":"var(--outline)"}),i=k(()=>{if(n.node===void 0||Object.values(n.node.buildMaterials).every(v=>v===0))return 0;const a=z(K[n.node.type].building,n.node);if(a===void 0)return 0;const o=Object.values(a.cost).reduce((v,p)=>v+p,0);if(o===0)return 0;const l=Object.values(n.node.buildMaterials).reduce((v,p)=>v+p,0);return Math.max(0,1-l/o)});function s(){n.node?L.board.draggingNode.value===n.node&&t("place-building",n.node):t("select-building")}return(a,o)=>{var l,v;return _(),C("g",{onMouseup:s,onTouchendPassive:s,style:re({opacity:a.placing?.5:1})},[m("circle",{class:"body",r:(l=a.size)!=null?l:10,fill:"var(--locked)",stroke:r.value,"stroke-width":"2"},null,8,Ru),i.value>0?(_(),C("g",Fu,[m("circle",{class:"build",r:(v=a.size)!=null?v:10,fill:"none",stroke:"var(--outline)","stroke-width":"2",pathLength:"1","stroke-dasharray":"1","stroke-dashoffset":1-i.value},null,8,Pu)])):P("",!0)],36)}}});var rr=W(Tu,[["__scopeId","data-v-75feb0ba"]]);const Eu=["stroke"],zu=["x1","x2","y2"],Ou=["x1","x2","y2"],Du=["x1","x2","y2"],Au=["x1","x2","y2"],Vu=["y1","y2","x2"],ju=["y1","y2","x2"],Bu=["y1","y2","x2"],qu=["y1","y2","x2"],Uu=A({__name:"Target",props:{size:{},stroke:{}},setup(e){const t=e,n=k(()=>{var r;return(r=t.stroke)!=null?r:"var(--outline)"});return(r,i)=>(_(),C("g",{stroke:n.value,"stroke-width":"2","stroke-linecap":"square"},[m("line",{x1:r.size,x2:r.size*1.25,y1:0,y2:r.size/4},null,8,zu),m("line",{x1:r.size,x2:r.size*1.25,y1:0,y2:-r.size/4},null,8,Ou),m("line",{x1:-r.size,x2:-r.size*1.25,y1:0,y2:r.size/4},null,8,Du),m("line",{x1:-r.size,x2:-r.size*1.25,y1:0,y2:-r.size/4},null,8,Au),m("line",{y1:r.size,y2:r.size*1.25,x1:0,x2:r.size/4},null,8,Vu),m("line",{y1:r.size,y2:r.size*1.25,x1:0,x2:-r.size/4},null,8,ju),m("line",{y1:-r.size,y2:-r.size*1.25,x1:0,x2:r.size/4},null,8,Bu),m("line",{y1:-r.size,y2:-r.size*1.25,x1:0,x2:-r.size/4},null,8,qu)],8,Eu))}}),Zu=["width","height","transform"],ir=A({__name:"Scrap",props:{node:{},size:{},canAccept:{type:Boolean},placing:{type:Boolean}},emits:["place-building"],setup(e,{emit:t}){const n=e,r=k(()=>{var a;return(a=n.size)!=null?a:10}),i=k(()=>-r.value/2);function s(){n.node&&L.board.draggingNode.value===n.node&&t("place-building",n.node)}return(a,o)=>(_(),C("g",{onMouseup:s,onTouchendPassive:s,style:re({opacity:a.placing?.5:1})},[a.canAccept?(_(),O(Uu,{key:0,size:r.value},null,8,["size"])):P("",!0),m("rect",{class:"body",width:r.value,height:r.value,transform:`translate(${i.value} ${i.value})`,fill:"var(--locked)",stroke:"var(--highlighted)","stroke-width":"2"},null,8,Zu)],36))}});const Wu=["width","height","transform","stroke"],Gu={key:0},Hu=["d"],Yu=["width","height","transform"],Ju=["d"],Ku=A({__name:"Extractor",props:{node:{},size:{},placing:{type:Boolean}},emits:["select-building","place-building"],setup(e,{emit:t}){const n=e,r=Math.sqrt(2),i=k(()=>{var d;return(d=n.size)!=null?d:10}),s=k(()=>-i.value*r/2),a=k(()=>{if(n.node===void 0||L.board.draggingNode.value===n.node)return"var(--outline)";const d=n.node;return Object.values(d.buildMaterials).some(c=>c>0)?"var(--locked)":d.distance===-1?"var(--danger)":"var(--outline)"}),o=k(()=>{if(n.node===void 0)return 0;const d=n.node;return d.storage[0].amount/d.storage[0].limit}),l=k(()=>{const d=2*s.value+2;if(o.value<.5){const c={x:-d/2,y:-d/2};return["M",c.x,c.y,"L",c.x+d*o.value*2,c.y,"L",c.x,c.y+d*o.value*2,"Z"].join(" ")}else{const c={x:-d/2,y:-d/2};return["M",c.x,c.y,"L",c.x+d,c.y,"L",c.x+d,c.y+d*(o.value-.5)*2,"L",c.x+d*(o.value-.5)*2,c.y+d,"L",c.x,c.y+d,"Z"].join(" ")}}),v=k(()=>{if(n.node===void 0||Object.values(n.node.buildMaterials).every(h=>h===0))return 0;const d=z(K[n.node.type].building,n.node);if(d===void 0)return 0;const c=Object.values(d.cost).reduce((h,S)=>h+S,0);if(c===0)return 0;const g=Object.values(n.node.buildMaterials).reduce((h,S)=>h+S,0);return Math.max(0,1-g/c)}),p=k(()=>{const d=-s.value+2,c={x:d,y:d};if(v.value<.25){const g=v.value*4;return["M",0,0,"L",c.x,c.y,"L",c.x,c.y-2*d*g,"Z"].join(" ")}else if(v.value<.5){const g=(v.value-.25)*4;return["M",0,0,"L",c.x,c.y,"L",c.x,-c.y,"L",c.x-2*d*g,-c.y,"Z"].join(" ")}else if(v.value<.75){const g=(v.value-.5)*4;return["M",0,0,"L",c.x,c.y,"L",c.x,-c.y,"L",-c.x,-c.y,"L",-c.x,-c.y+2*d*g,"Z"].join(" ")}else{const g=v.value>1?1:(v.value-.75)*4;return["M",0,0,"L",c.x,c.y,"L",c.x,-c.y,"L",-c.x,-c.y,"L",-c.x,c.y,"L",-c.x+2*d*g,c.y,"Z"].join(" ")}});function b(){n.node?L.board.draggingNode.value===n.node&&t("place-building",n.node):t("select-building")}return(d,c)=>(_(),C(X,null,[d.node!==void 0&&u(L).board.draggingNode.value!==d.node?(_(),O(ir,{key:0,size:u(z)(u(K)[u(D).Scrap].size,d.node)},null,8,["size"])):P("",!0),m("g",{transform:"rotate(45, 0, 0)",onMouseup:b,onTouchendPassive:b,style:re({opacity:d.placing?.5:1})},[m("rect",{class:"body",width:i.value*u(r),height:i.value*u(r),transform:`translate(${s.value} ${s.value})`,fill:"var(--locked)",stroke:a.value,"stroke-width":"2"},null,8,Wu),v.value>0?(_(),C("g",Gu,[m("path",{class:"build",d:p.value,fill:"var(--outline)"},null,8,Hu),m("rect",{class:"build",width:i.value*u(r)-2,height:i.value*u(r)-2,transform:`translate(${s.value+1} ${s.value+1})`,fill:"var(--locked)"},null,8,Yu)])):P("",!0),o.value>0?(_(),C("path",{key:1,class:"storage",d:l.value,fill:"var(--accent1)"},null,8,Ju)):P("",!0)],36)],64))}});var sr=W(Ku,[["__scopeId","data-v-58d6e9f2"]]);const Xu=["width","height","transform","stroke"],Qu={key:0},ec=["d"],tc=["width","height","transform"],nc=["d"],rc=["d"],ic=["d"],sc={transform:"rotate(135, 0, 0)"},oc=["width","height","transform"],ac=["d","stroke"],lc=A({__name:"Foundry",props:{node:{},size:{},placing:{type:Boolean}},emits:["select-building","place-building"],setup(e,{emit:t}){const n=e,r=Math.sqrt(2),i=k(()=>{var S;return(S=n.size)!=null?S:15}),s=k(()=>-i.value*r/2),a=k(()=>{if(n.node===void 0||L.board.draggingNode.value===n.node)return"var(--outline)";const S=n.node;return Object.values(S.buildMaterials).some(M=>M>0)?"var(--locked)":S.distance===-1?"var(--danger)":"var(--outline)"}),o=k(()=>{const S=i.value/12*r,M={x:-s.value-1,y:-s.value-1};return["M",M.x,M.y,"M",M.x+S,M.y-S,"A",S,S,0,0,1,M.x-S,M.y+S,"L",-M.x-S,-M.y+S,"A",S,S,0,0,1,-M.x+S,-M.y-S,"Z"].join(" ")}),l=k(()=>{if(n.node===void 0||n.node.activeRecipe===void 0||n.node.recipeTime<=0)return 0;const S=z(K[n.node.type].building,n.node);return S===void 0||S.recipes===void 0?0:Math.max(0,1-n.node.recipeTime/S.recipes[n.node.activeRecipe].duration)}),v=k(()=>({width:i.value/6*r,height:1.5*i.value*r})),p=k(()=>{if(n.node===void 0||Object.values(n.node.buildMaterials).every($=>$===0))return 0;const S=z(K[n.node.type].building,n.node);if(S===void 0)return 0;const M=Object.values(S.cost).reduce(($,T)=>$+T,0);if(M===0)return 0;const y=Object.values(n.node.buildMaterials).reduce(($,T)=>$+T,0);return Math.max(0,1-y/M)}),b=k(()=>{const S=-s.value+1,M={x:S,y:S};if(p.value<.25){const y=p.value*4;return["M",0,0,"L",M.x,M.y,"L",M.x,M.y-2*S*y,"Z"].join(" ")}else if(p.value<.5){const y=(p.value-.25)*4;return["M",0,0,"L",M.x,M.y,"L",M.x,-M.y,"L",M.x-2*S*y,-M.y,"Z"].join(" ")}else if(p.value<.75){const y=(p.value-.5)*4;return["M",0,0,"L",M.x,M.y,"L",M.x,-M.y,"L",-M.x,-M.y,"L",-M.x,-M.y+2*S*y,"Z"].join(" ")}else{const y=p.value>1?1:(p.value-.75)*4;return["M",0,0,"L",M.x,M.y,"L",M.x,-M.y,"L",-M.x,-M.y,"L",-M.x,M.y,"L",-M.x+2*S*y,M.y,"Z"].join(" ")}}),d=k(()=>{var $;const S=ye.foundry.storage;if(n.node===void 0)return Array.from({length:S.length}).fill(0);const M=n.node,y=[];for(let T=0;T<S.length;T++){const V=S[T];y[T]=M.storage[T].amount/(V.limit==="node"?($=M.storage[T].limit)!=null?$:1:V.limit),y[T]<0&&(y[T]=0),y[T]>1&&(y[T]=1)}return y}),c=k(()=>{const S=d.value[0],M=2*s.value+2,y={x:-M/2,y:-M/2};return(S<.5?["M",y.x,y.y,"L",y.x+M*S*2,y.y,"L",y.x+M*S,y.y+M*S,"Z"]:["M",y.x,y.y,"L",y.x+M,y.y,"L",y.x+M,y.y+M*(S-.5)*2,"L",M*(S-.5),M*(S-.5),"Z"]).join(" ")}),g=k(()=>{const S=d.value[1],M=2*s.value+2,y={x:-M/2,y:-M/2};return(S<.5?["M",y.x,y.y,"L",y.x,y.y+M*S*2,"L",y.x+M*S,y.y+M*S,"Z"]:["M",y.x,y.y,"L",y.x,y.y+M,"L",y.x+M*(S-.5)*2,y.y+M,"L",M*(S-.5),M*(S-.5),"Z"]).join(" ")});function h(){n.node?L.board.draggingNode.value===n.node&&t("place-building",n.node):t("select-building")}return(S,M)=>(_(),C("g",{transform:"rotate(45, 0, 0)",onMouseup:h,onTouchendPassive:h,style:re({opacity:S.placing?.5:1})},[m("rect",{class:"body",width:i.value*u(r),height:i.value*u(r),transform:`translate(${s.value} ${s.value})`,fill:"var(--locked)",stroke:a.value,"stroke-width":"2"},null,8,Xu),p.value>0?(_(),C("g",Qu,[m("path",{class:"build",d:b.value,fill:"var(--outline)"},null,8,ec),m("rect",{class:"build",width:i.value*u(r)-2,height:i.value*u(r)-2,transform:`translate(${s.value+1} ${s.value+1})`,fill:"var(--locked)"},null,8,tc)])):P("",!0),d.value[0]>0?(_(),C("path",{key:1,class:"storage",d:c.value,fill:"var(--accent1)"},null,8,nc)):P("",!0),d.value[1]>0?(_(),C("path",{key:2,class:"storage",d:g.value,fill:"var(--accent1)"},null,8,rc)):P("",!0),m("path",{class:"body",d:o.value,fill:"var(--locked)"},null,8,ic),m("g",sc,[l.value>0?(_(),C("rect",{key:0,class:"progress",width:v.value.width,height:v.value.height*l.value,transform:`translate(${-v.value.width/2} ${-v.value.height/2})`,fill:"var(--foreground)"},null,8,oc)):P("",!0)]),m("path",{class:"body",d:o.value,stroke:a.value,"stroke-width":"2",fill:"none"},null,8,ac)],36))}});var or=W(lc,[["__scopeId","data-v-5b7e5245"]]);const uc={transform:"rotate(45, 0, 0)"},cc=["width","height","transform","stroke"],dc=["width","height","stroke"],fc=["d"],gc=["d"],pc=["width","height","transform"],vc=["width","height","transform"],hc=["r","stroke"],mc={key:0,transform:"rotate(90, 0, 0) scale(1, -1)"},bc=["r","stroke-dashoffset"],yc=["r"],it=.05,_c=A({__name:"Analyzer",props:{node:{},size:{},placing:{type:Boolean}},emits:["select-building","place-building"],setup(e,{emit:t}){const n=e,r=Math.sqrt(2),i=k(()=>{var d;return(d=n.size)!=null?d:15}),s=k(()=>n.placing?!0:n.node===void 0?!1:L.board.selectedNode.value===n.node),a=k(()=>{if(n.node===void 0||L.board.draggingNode.value===n.node)return"var(--outline)";const d=n.node;return Object.values(d.buildMaterials).some(c=>c>0)?"var(--locked)":d.distance===-1?"var(--danger)":"var(--outline)"}),o=k(()=>{if(n.node===void 0||Object.values(n.node.buildMaterials).every(h=>h===0))return 0;const d=z(K[n.node.type].building,n.node);if(d===void 0)return 0;const c=Object.values(d.cost).reduce((h,S)=>h+S,0);if(c===0)return 0;const g=Object.values(n.node.buildMaterials).reduce((h,S)=>h+S,0);return Math.max(0,1-g/c)}),l=k(()=>{if(n.node===void 0||n.node.state===void 0)return 0;const d=n.node.state.timeLeft;return d<=0||d>=1?0:1-d}),v=k(()=>{const d=i.value*r/2;let c=(l.value-it)*2,g=(l.value+it)*2,h=[];return c<0&&(c=0),g>1&&(g=1),c<.25?(h.push("M",0,d*c*4),g>.25?h.push("L",0,d,"L",d*(g-.25)*4,d):h.push("L",0,d*g*4)):c<.5?(h.push("M",d*(c-.25)*4,d),g>.5?h.push("L",d,d,"L",d,d-d*(g-.5)*4):h.push("L",d*(g-.25)*4,d)):c<.75?(h.push("M",d,d-d*(c-.5)*4),g>.75?h.push("L",d,0,"L",d-d*(g-.75)*4,0):h.push("L",d,d-d*(g-.5)*4)):h.push("M",d-d*(c-.75)*4,0,"L",d-d*(g-.75)*4,0),h.push("L",d/2,d/2,"Z"),h.join(" ")}),p=k(()=>{const d=i.value*r/2;let c=(l.value-.5-it)*2,g=(l.value-.5+it)*2,h=[];return c<0&&(c=0),g>1&&(g=1),c<.25?(h.push("M",0,d*c*4),g>.25?h.push("L",0,d,"L",d*(g-.25)*4,d):h.push("L",0,d*g*4)):c<.5?(h.push("M",d*(c-.25)*4,d),g>.5?h.push("L",d,d,"L",d,d-d*(g-.5)*4):h.push("L",d*(g-.25)*4,d)):c<.75?(h.push("M",d,d-d*(c-.5)*4),g>.75?h.push("L",d,0,"L",d-d*(g-.75)*4,0):h.push("L",d,d-d*(g-.5)*4)):h.push("M",d-d*(c-.75)*4,0,"L",d-d*(g-.75)*4,0),h.push("L",d/2,d/2,"Z"),h.join(" ")});function b(){n.node?L.board.draggingNode.value===n.node&&t("place-building",n.node):t("select-building")}return(d,c)=>(_(),C("g",{onMouseup:b,onTouchendPassive:b,style:re({opacity:d.placing?.5:1})},[m("g",uc,[m("rect",{class:"body",width:i.value*u(r)/2,height:i.value*u(r)/2,transform:`translate(${-i.value*u(r)/2} ${-i.value*u(r)/2})`,fill:"var(--locked)",stroke:a.value,"stroke-width":"2"},null,8,cc),m("rect",{class:"body",width:i.value*u(r)/2,height:i.value*u(r)/2,fill:"var(--locked)",stroke:a.value,"stroke-width":"2"},null,8,dc),l.value>0&&l.value<.5+it?(_(),C("path",{key:0,class:"progress",d:v.value,stroke:"var(--foreground)","stroke-width":"2"},null,8,fc)):P("",!0),l.value>.5-it?(_(),C("path",{key:1,class:"progress",transform:"rotate(90, 0, 0) scale(-1, 1)",d:p.value,stroke:"var(--foreground)","stroke-width":"2"},null,8,gc)):P("",!0),m("rect",{class:"body",width:i.value*u(r)/2-2,height:i.value*u(r)/2-2,transform:`translate(${-i.value*u(r)/2+1} ${-i.value*u(r)/2+1})`,fill:"var(--locked)"},null,8,pc),m("rect",{class:"body",width:i.value*u(r)/2-2,height:i.value*u(r)/2-2,transform:"translate(1 1)",fill:"var(--locked)"},null,8,vc)]),m("circle",{class:"body",r:i.value/2,fill:"var(--locked)",stroke:a.value,"stroke-width":"2"},null,8,hc),o.value>0?(_(),C("g",mc,[m("circle",{class:"build",r:i.value/2,fill:"none",stroke:"var(--outline)","stroke-width":"2",pathLength:"1","stroke-dasharray":"1","stroke-dashoffset":1-o.value},null,8,bc)])):P("",!0),s.value?(_(),C("circle",{key:1,r:n.node!==void 0&&u(L).board.selectedNode.value===n.node?100/1.2:100,fill:"none",stroke:"var(--outline)","stroke-width":"2"},null,8,yc)):P("",!0)],36))}});var ar=W(_c,[["__scopeId","data-v-57da2d56"]]);const Nc=["r","transform","stroke"],wc=["r","transform","stroke"],kc=["r","transform","stroke"],Sc=["r","transform","stroke"],Cc=["width","height","transform","stroke"],xc={key:0},Mc=["d"],Ic=["width","height","transform"],$c=A({__name:"Researcher",props:{node:{},size:{},placing:{type:Boolean}},emits:["select-building","place-building"],setup(e,{emit:t}){const n=e,r=Math.sqrt(2),i=k(()=>{var c;return(c=n.size)!=null?c:15}),s=k(()=>-i.value*r/2),a=k(()=>{if(n.node===void 0||L.board.draggingNode.value===n.node)return"var(--outline)";const c=n.node;return Object.values(c.buildMaterials).some(g=>g>0)?"var(--locked)":c.distance===-1?"var(--danger)":"var(--outline)"}),o=k(()=>{if(n.node===void 0||Object.values(n.node.buildMaterials).every(S=>S===0))return 0;const c=z(K[n.node.type].building,n.node);if(c===void 0)return 0;const g=Object.values(c.cost).reduce((S,M)=>S+M,0);if(g===0)return 0;const h=Object.values(n.node.buildMaterials).reduce((S,M)=>S+M,0);return Math.max(0,1-h/g)}),l=k(()=>{const c=-s.value+1,g={x:c,y:c};if(o.value<.25){const h=o.value*4;return["M",0,0,"L",g.x,g.y,"L",g.x,g.y-2*c*h,"Z"].join(" ")}else if(o.value<.5){const h=(o.value-.25)*4;return["M",0,0,"L",g.x,g.y,"L",g.x,-g.y,"L",g.x-2*c*h,-g.y,"Z"].join(" ")}else if(o.value<.75){const h=(o.value-.5)*4;return["M",0,0,"L",g.x,g.y,"L",g.x,-g.y,"L",-g.x,-g.y,"L",-g.x,-g.y+2*c*h,"Z"].join(" ")}else{const h=o.value>1?1:(o.value-.75)*4;return["M",0,0,"L",g.x,g.y,"L",g.x,-g.y,"L",-g.x,-g.y,"L",-g.x,g.y,"L",-g.x+2*c*h,g.y,"Z"].join(" ")}}),v=k(()=>n.node===void 0||L.activeResearch.value==="none"?0:n.node.storage.filter(c=>c.amount>0).length),p=k(()=>{switch(v.value){default:return[];case 1:return["pulsing","pulse-one"];case 2:return["pulsing","pulse-two"];case 3:return["pulsing","pulse-three"];case 4:return["pulsing","pulse-four"];case 5:return["pulsing","pulse-five"]}}),b=k(()=>{switch(v.value){default:return[];case 1:return[{animationDelay:"-0.625s"},{animationDelay:"-1.25s"},{animationDelay:"-1.875s"}];case 2:return[{animationDelay:"-0.5s"},{animationDelay:"-1s"},{animationDelay:"-1.5s"}];case 3:return[{animationDelay:"-0.375s"},{animationDelay:"-0.75s"},{animationDelay:"-1.125s"}];case 4:return[{animationDelay:"-0.25s"},{animationDelay:"-0.5s"},{animationDelay:"-0.75s"}];case 5:return[{animationDelay:"-0.125s"},{animationDelay:"-0.25s"},{animationDelay:"-0.375s"}]}});function d(){n.node?L.board.draggingNode.value===n.node&&t("place-building",n.node):t("select-building")}return(c,g)=>(_(),C("g",{transform:"rotate(45, 0, 0)",onMouseup:d,onTouchendPassive:d,style:re({opacity:c.placing?.5:1})},[m("circle",{class:ne(["body",p.value]),r:i.value/u(r)/2,transform:`translate(${s.value} 0)`,fill:"var(--locked)",stroke:a.value,"stroke-width":"2"},null,10,Nc),m("circle",{class:ne(["body",p.value]),style:re(b.value[0]),r:i.value/u(r)/2,transform:`translate(0 ${s.value})`,fill:"var(--locked)",stroke:a.value,"stroke-width":"2"},null,14,wc),m("circle",{class:ne(["body",p.value]),style:re(b.value[1]),r:i.value/u(r)/2,transform:`translate(${-s.value} 0)`,fill:"var(--locked)",stroke:a.value,"stroke-width":"2"},null,14,kc),m("circle",{class:ne(["body",p.value]),style:re(b.value[2]),r:i.value/u(r)/2,transform:`translate(0 ${-s.value})`,fill:"var(--locked)",stroke:a.value,"stroke-width":"2"},null,14,Sc),m("rect",{class:"body",width:i.value*u(r),height:i.value*u(r),transform:`translate(${s.value} ${s.value})`,fill:"var(--locked)",stroke:a.value,"stroke-width":"2"},null,8,Cc),o.value>0?(_(),C("g",xc,[m("path",{class:"build",d:l.value,fill:"var(--outline)"},null,8,Mc),m("rect",{class:"build",width:i.value*u(r)-2,height:i.value*u(r)-2,transform:`translate(${s.value+1} ${s.value+1})`,fill:"var(--locked)"},null,8,Ic)])):P("",!0)],36))}});var lr=W($c,[["__scopeId","data-v-a428cb44"]]);const Lc={transform:"rotate(45, 0, 0)"},Rc=["width","height","transform","stroke"],Fc=["r","stroke"],Pc={key:0,transform:"rotate(90, 0, 0) scale(1, -1)"},Tc=["r","stroke-dashoffset"],Ec={key:1},zc=["d"],ur=A({__name:"Bore",props:{node:{},size:{},placing:{type:Boolean}},emits:["select-building","place-building"],setup(e,{emit:t}){const n=e,r=Math.sqrt(2),i=k(()=>{var p;return(p=n.size)!=null?p:20}),s=k(()=>{if(n.node===void 0||L.board.draggingNode.value===n.node)return"var(--outline)";const p=n.node;return Object.values(p.buildMaterials).some(b=>b>0)?"var(--locked)":p.distance===-1?"var(--danger)":"var(--outline)"}),a=k(()=>{if(n.node===void 0||Object.values(n.node.buildMaterials).every(c=>c===0))return 0;const p=z(K[n.node.type].building,n.node);if(p===void 0)return 0;const b=Object.values(p.cost).reduce((c,g)=>c+g,0);if(b===0)return 0;const d=Object.values(n.node.buildMaterials).reduce((c,g)=>c+g,0);return Math.max(0,1-d/b)}),o=k(()=>{if(n.node===void 0)return 0;const p=n.node,b=z(K[p.type].building,p);return b===void 0?0:p.storage[0].amount/b.storage[0].limit}),l=k(()=>{const p=i.value/r-2,b=2*p*(o.value-.5),d=Math.sqrt(p*p-b*b);return o.value>=1?["M",p,0,"A",p,p,0,0,0,-p,0,"A",p,p,0,0,0,p,0].join(" "):o.value<.5?["M",-d,-b,"A",p,p,0,0,0,d,-b,"Z"].join(" "):["M",-d,-b,"A",p,p,0,1,0,d,-b,"Z"].join(" ")});function v(){n.node?L.board.draggingNode.value===n.node&&t("place-building",n.node):t("select-building")}return(p,b)=>(_(),C("g",{onMouseup:v,onTouchendPassive:v,style:re({opacity:p.placing?.5:1})},[m("g",Lc,[m("rect",{class:"body",width:i.value*u(r),height:i.value*u(r),transform:`translate(${-i.value*u(r)/2} ${-i.value*u(r)/2})`,fill:"var(--locked)",stroke:s.value,"stroke-width":"2"},null,8,Rc)]),m("circle",{class:"body",r:i.value/u(r)-1,fill:"var(--locked)",stroke:s.value,"stroke-width":"2"},null,8,Fc),a.value>0?(_(),C("g",Pc,[m("circle",{class:"build",r:i.value/u(r)-1,fill:"none",stroke:"var(--outline)","stroke-width":"2",pathLength:"1","stroke-dasharray":"1","stroke-dashoffset":1-a.value},null,8,Tc)])):P("",!0),o.value>0?(_(),C("g",Ec,[m("path",{class:"storage",d:l.value,fill:"var(--accent1)"},null,8,zc)])):P("",!0)],36))}});const Oc=["transform"],Dc=["d"],Ac=["d"],Vc=A({__name:"ContainmentRing",props:{node:{},size:{}},setup(e){const t=e,n=k(()=>{var c;return(c=t.node.state.origin)!=null?c:{x:0,y:0}}),r=k(()=>{var c;return(c=t.node.state.size)!=null?c:600}),i=k(()=>r.value),s=k(()=>i.value+50),a=k(()=>t.node.state),o=k(()=>a.value.angle),l=k(()=>o.value*180/Math.PI),v=k(()=>{const c=z(K[t.node.type].durability,t.node);return a.value.durability/c}),p=Math.PI/360/2,b=k(()=>{const c=Math.PI/4,g={x:Math.cos(p),y:Math.sin(p)},h={x:Math.cos(c-p),y:Math.sin(c-p)},S=[{x:s.value*g.x,y:s.value*g.y},{x:s.value*h.x,y:s.value*h.y},{x:i.value*h.x,y:i.value*h.y},{x:i.value*g.x,y:i.value*g.y}];return["M",S[0].x,S[0].y,"A",s.value,s.value,0,0,1,S[1].x,S[1].y,"L",S[2].x,S[2].y,"A",i.value,i.value,0,0,0,S[3].x,S[3].y,"Z"].join(" ")}),d=k(()=>{const c=i.value+1,g=s.value-1,h=Math.PI/4,S=h*v.value,M=(h-S)/2+p+Math.PI/360/8,y=M+S-2*p-2*Math.PI/360/8,$={x:Math.cos(M),y:Math.sin(M)},T={x:Math.cos(y),y:Math.sin(y)},V=[{x:g*$.x,y:g*$.y},{x:g*T.x,y:g*T.y},{x:c*T.x,y:c*T.y},{x:c*$.x,y:c*$.y}];return["M",V[0].x,V[0].y,"A",g,g,0,0,1,V[1].x,V[1].y,"L",V[2].x,V[2].y,"A",c,c,0,0,0,V[3].x,V[3].y,"Z"].join(" ")});return(c,g)=>(_(),C(X,null,he(8,h=>m("g",{transform:`translate(${n.value.x}, ${n.value.y}) rotate(${l.value+h*45})`},[m("path",{class:"body",d:b.value,fill:"var(--locked)",stroke:"var(--link)","stroke-width":"2"},null,8,Dc),m("path",{class:"health",d:d.value,fill:"#2A6DA1"},null,8,Ac)],8,Oc)),64))}});var jc=W(Vc,[["__scopeId","data-v-1055c0ee"]]);const Bc=["transform"],qc=["fill"],Uc={key:0},Zc=["fill","y"],Wc=["fill","y"],Gc=A({__name:"BoardNode",props:{node:{},nodeType:{},dragging:{},dragged:{},hasDragged:{type:Boolean},receivingNode:{type:Boolean},isSelected:{type:Boolean},selectedAction:{}},emits:["mouseDown","endDragging","clickAction","place-building"],setup(e,{emit:t}){const r=Ce(e),i=k(()=>z(r.nodeType.value.draggable,u(r.node)));Ve(i,E=>{const fe=u(r.node);u(r.dragging)===fe&&!E&&t("endDragging",fe)});const s=k(()=>{var fe;const E=u(r.node);return(fe=z(r.nodeType.value.actions,E))==null?void 0:fe.filter(Oe=>Vt(z(Oe.visibility,E)))}),a=k(()=>{var fe;const E=u(r.node);if(z(r.nodeType.value.draggable,E)&&((fe=u(r.dragging))==null?void 0:fe.id)===E.id&&u(r.dragged)!=null){const{x:Oe,y:xe}=u(r.dragged);return{x:E.position.x+Math.round(Oe/25)*25,y:E.position.y+Math.round(xe/25)*25}}return E.position}),o=k(()=>z(r.nodeType.value.shape,u(r.node))),l=k(()=>z(r.nodeType.value.title,u(r.node))),v=k(()=>{var E;return(E=r.isSelected.value?u(r.selectedAction)&&z(u(r.selectedAction).tooltip,u(r.node)):null)!=null?E:z(r.nodeType.value.label,u(r.node))}),p=k(()=>{var E,fe;return z((fe=(E=u(r.selectedAction))==null?void 0:E.confirmationLabel)!=null?fe:{text:"Click again to confirm"},u(r.node))}),b=k(()=>z(r.nodeType.value.size,u(r.node))),d=k(()=>{var E;return(E=z(r.nodeType.value.progress,u(r.node)))!=null?E:0}),c=k(()=>Te[te.theme].variables["--background"]),g=k(()=>{var E;return(E=z(r.nodeType.value.outlineColor,u(r.node)))!=null?E:Te[te.theme].variables["--outline"]}),h=k(()=>{var E;return(E=z(r.nodeType.value.fillColor,u(r.node)))!=null?E:Te[te.theme].variables["--raised-background"]}),S=k(()=>z(r.nodeType.value.progressColor,u(r.node))),M=k(()=>{var E;return(E=z(r.nodeType.value.titleColor,u(r.node)))!=null?E:Te[te.theme].variables["--foreground"]}),y=k(()=>z(r.nodeType.value.progressDisplay,u(r.node))),$=k(()=>r.dragging.value!=null&&u(r.hasDragged)&&z(r.nodeType.value.canAccept,u(r.node),r.dragging.value)),T=k(()=>z(r.nodeType.value.classes,u(r.node)));function V(E){t("mouseDown",E,r.node.value,i.value)}function Q(E){var fe,Oe,xe;(fe=r.hasDragged)!=null&&fe.value||(t("endDragging",r.node.value),(xe=(Oe=r.nodeType.value).onClick)==null||xe.call(Oe,r.node.value),E.stopPropagation())}const xt=k(()=>L.board.draggingNode.value!==r.node.value?!1:!kn(r.node.value));function Ge(E){const fe=z(K[E.type].building,E);fe!==void 0&&fe.buildableOn!==void 0||!kn(E)||(an(E),L.board.draggingNode.value=null,t("place-building"))}return(E,fe)=>{var Oe;return _(),C("g",{class:ne(["boardnode",{[E.node.type]:!0,isSelected:E.isSelected,isDraggable:i.value,invalidPlacement:xt.value,...T.value}]),transform:`translate(${a.value.x},${a.value.y})${E.isSelected?" scale(1.2)":""}`},[R(Kl,{actions:(Oe=s.value)!=null?Oe:[],"is-selected":E.isSelected,node:E.node,"node-type":E.nodeType,"selected-action":E.selectedAction,onClickAction:fe[0]||(fe[0]=xe=>t("clickAction",xe))},null,8,["actions","is-selected","node","node-type","selected-action"]),m("g",{class:"node-container",onMousedown:V,onTouchstartPassive:V,onMouseup:Q,onTouchendPassive:Q},[o.value===u(ce).Circle?(_(),O(ru,{key:0,receivingNode:E.receivingNode,canAccept:$.value,size:b.value,progress:d.value,progressDisplay:y.value,progressColor:S.value,backgroundColor:c.value,fillColor:h.value,outlineColor:g.value},null,8,["receivingNode","canAccept","size","progress","progressDisplay","progressColor","backgroundColor","fillColor","outlineColor"])):o.value===u(ce).Diamond?(_(),O(cu,{key:1,receivingNode:E.receivingNode,canAccept:$.value,size:b.value,progress:d.value,progressDisplay:y.value,progressColor:S.value,backgroundColor:c.value,fillColor:h.value,outlineColor:g.value},null,8,["receivingNode","canAccept","size","progress","progressDisplay","progressColor","backgroundColor","fillColor","outlineColor"])):o.value===u(ce).Core?(_(),O(Lu,{key:2,node:E.node,size:b.value,placing:u(L).board.draggingNode.value===E.node},null,8,["node","size","placing"])):o.value===u(ce).Router?(_(),O(rr,{key:3,node:E.node,size:b.value,placing:u(L).board.draggingNode.value===E.node,onPlaceBuilding:Ge},null,8,["node","size","placing"])):o.value===u(ce).Extractor?(_(),O(sr,{key:4,node:E.node,size:b.value,placing:u(L).board.draggingNode.value===E.node,onPlaceBuilding:Ge},null,8,["node","size","placing"])):o.value===u(ce).Foundry?(_(),O(or,{key:5,node:E.node,size:b.value,placing:u(L).board.draggingNode.value===E.node,onPlaceBuilding:Ge},null,8,["node","size","placing"])):o.value===u(ce).Analyzer?(_(),O(ar,{key:6,node:E.node,size:b.value,placing:u(L).board.draggingNode.value===E.node,onPlaceBuilding:Ge},null,8,["node","size","placing"])):o.value===u(ce).Researcher?(_(),O(lr,{key:7,node:E.node,size:b.value,placing:u(L).board.draggingNode.value===E.node,onPlaceBuilding:Ge},null,8,["node","size","placing"])):o.value===u(ce).Bore?(_(),O(ur,{key:8,node:E.node,size:b.value,placing:u(L).board.draggingNode.value===E.node,onPlaceBuilding:Ge},null,8,["node","size","placing"])):o.value===u(ce).Scrap?(_(),O(ir,{key:9,node:E.node,size:b.value,canAccept:$.value,placing:u(L).board.draggingNode.value===E.node,onPlaceBuilding:Ge},null,8,["node","size","canAccept","placing"])):o.value===u(ce).ContainmentRing?(_(),O(jc,{key:10,node:E.node,size:b.value},null,8,["node","size"])):P("",!0),m("text",{fill:M.value,class:"node-title"},q(l.value),9,qc)],32),R(mt,{name:"fade",appear:""},{default:j(()=>{var xe;return[v.value?(_(),C("g",Uc,[m("text",{fill:(xe=v.value.color)!=null?xe:M.value,class:ne(["node-title",{pulsing:v.value.pulsing}]),y:-b.value-10},q(v.value.text),11,Zc)])):P("",!0)]}),_:1}),R(mt,{name:"fade",appear:""},{default:j(()=>{var xe;return[E.isSelected&&E.selectedAction?(_(),C("text",{key:0,fill:(xe=p.value.color)!=null?xe:M.value,class:ne(["node-title",{pulsing:p.value.pulsing}]),y:b.value+30},q(p.value.text),11,Wc)):P("",!0)]}),_:1})],10,Bc)}}});var Hc=W(Gc,[["__scopeId","data-v-717e4984"]]);const Yc={class:"stage",width:"100%",height:"100%"},Jc={class:"g1"},Kc={style:{opacity:"0.4"}},Xc=["transform"],Qc=["d"],ed=["x1","y1","x2","y2"],Me=10,td=A({__name:"Board",props:{nodes:{},types:{},state:{},visibility:{},width:{},height:{},style:{},classes:{},links:{},selectedAction:{},selectedNode:{},draggingNode:{},receivingNode:{},mousePosition:{},setReceivingNode:{type:Function},setDraggingNode:{type:Function}},setup(e){const n=Ce(e),r=B({x:0,y:0}),i=B({x:0,y:0}),s=B(!1),a=B(null),o=k(()=>{const h=n.nodes.value.slice();if(n.selectedNode.value){const S=h.splice(h.indexOf(n.selectedNode.value),1)[0];h.push(S)}return n.draggingNode.value&&h.push(n.draggingNode.value),h});Ot(()=>{const h=n.draggingNode.value;if(h==null)return null;const S={x:h.position.x,y:h.position.y};let M=Number.MAX_VALUE;n.setReceivingNode.value(n.nodes.value.reduce((y,$)=>{if($.id===h.id)return y;const T=n.types.value[$.type];if(!z(T.canAccept,$,h))return y;const Q=Math.pow(S.x-$.position.x,2)+Math.pow(S.y-$.position.y,2);let xt=z(T.size,$);return Q>M||Q>xt*xt?y:(M=Q,$)},null))});function l(h){h.setTransformOrigin(null),h.moveTo(a.value.$el.clientWidth/2,a.value.$el.clientHeight/2),h.on("panstart",S=>{v&&(S.pause(),S.resume(),setTimeout(()=>v=!1,50))}),h.on("pan",S=>{v&&(S.pause(),S.resume())})}let v=!1;function p(){v=!0}function b(h,S=null){if(n.draggingNode.value==null){h.preventDefault(),h.stopPropagation();let M,y;if("touches"in h)if(h.touches.length===1)M=h.touches[0].clientX,y=h.touches[0].clientY;else return;else M=h.clientX,y=h.clientY;r.value={x:M,y},i.value={x:0,y:0},s.value=!1}S!=null&&(n.state.value.selectedNode=null,n.state.value.selectedAction=null)}function d(h){const{x:S,y:M,scale:y}=a.value.panZoomInstance.getTransform();let $,T;if("touches"in h)if(h.touches.length===1)$=h.touches[0].clientX,T=h.touches[0].clientY;else{c(n.draggingNode.value),n.mousePosition.value=null;return}else $=h.clientX,T=h.clientY;n.mousePosition.value={x:($-S)/y,y:(T-M)/y},i.value={x:i.value.x+($-r.value.x)/y,y:i.value.y+(T-r.value.y)/y},r.value={x:$,y:T},(Math.abs(i.value.x)>10||Math.abs(i.value.y)>10)&&(s.value=!0),n.draggingNode.value!=null&&(h.preventDefault(),h.stopPropagation(),n.draggingNode.value.position={x:Math.round((n.mousePosition.value.x-300/y)/Me)*Me,y:Math.round((n.mousePosition.value.y-50/y)/Me)*Me})}function c(h){var S,M;if(n.draggingNode.value!=null&&n.draggingNode.value===h){n.receivingNode.value==null&&(n.draggingNode.value.position.x+=Math.round(i.value.x/Me)*Me,n.draggingNode.value.position.y+=Math.round(i.value.y/Me)*Me);const y=n.nodes.value;y.push(y.splice(y.indexOf(n.draggingNode.value),1)[0]),n.receivingNode.value&&((M=(S=n.types.value[n.receivingNode.value.type]).onDrop)==null||M.call(S,n.receivingNode.value,n.draggingNode.value)),n.setDraggingNode.value(null)}else s.value||(n.state.value.selectedNode=null,n.state.value.selectedAction=null)}function g(h,S){n.state.value.selectedAction===S?u(n.selectedAction).onClick(u(n.selectedNode)):n.state.value={...n.state.value,selectedAction:S}}return(h,S)=>{const M=Ht("panZoom");return u(Vt)(h.visibility)?(_(),O(M,{key:0,style:re([{width:h.width,height:h.height},h.style]),class:ne(h.classes),selector:".g1",options:{initialZoom:1.5,minZoom:.1,maxZoom:5,zoomDoubleClickSpeed:1},ref_key:"stage",ref:a,onInit:l,onMousemove:d,onTouchmovePassive:d,onMousedown:S[0]||(S[0]=y=>b(y)),onTouchstartPassive:S[1]||(S[1]=y=>b(y)),onMouseup:S[2]||(S[2]=()=>c(u(h.draggingNode))),onTouchendPassive:S[3]||(S[3]=()=>c(u(h.draggingNode)))},{default:j(()=>[(_(),C("svg",Yc,[m("g",Jc,[m("g",Kc,[R(Ut,{name:"transfer",duration:500,appear:""},{default:j(()=>[(_(!0),C(X,null,he(o.value,y=>(_(),C("g",{key:y.id,style:{"transition-duration":"0s"}},[h.types[y.type].building!==void 0?(_(),C(X,{key:0},[u(z)(h.types[y.type].building,y).transferDistance!==void 0&&y.distance!==-1&&Object.values(y.buildMaterials).every($=>$===0)?(_(),C("g",{key:0,transform:`translate(${y.position.x} ${y.position.y})`},[m("path",{d:`M ${u(z)(h.types[y.type].building,y).transferDistance+Me/2} 0
                                            L 0 ${u(z)(h.types[y.type].building,y).transferDistance+Me/2}
                                            L -${u(z)(h.types[y.type].building,y).transferDistance+Me/2} 0
                                            L 0 -${u(z)(h.types[y.type].building,y).transferDistance+Me/2}
                                            Z
                                        `,fill:"var(--accent1)"},null,8,Qc)],8,Xc)):P("",!0)],64)):P("",!0)]))),128))]),_:1})]),R(Ut,{name:"link",appear:""},{default:j(()=>[(_(!0),C(X,null,he(u(h.links)||[],y=>(_(),C("g",{key:y.stroke==="var(--accent1)"?`${y.startNode.id}-${y.endNode.id}`:`${y.startNode.id}-${y.endNode.id}-transfer`},[y.startNode.distance>=0&&y.endNode.distance>=0?(_(),O(Zl,{key:0,link:y,dragging:u(h.draggingNode),dragged:y.startNode===u(h.draggingNode)||y.endNode===u(h.draggingNode)?i.value:void 0},null,8,["link","dragging","dragged"])):P("",!0)]))),128)),(_(!0),C(X,null,he(o.value.filter(y=>y.type===u(D).Bore),y=>(_(),C("g",{key:y.id},[y.storage[0].amount>0&&y.position.x**2+y.position.y**2>=(u(lt)-100)**2&&y.state!==void 0?(_(),C("line",{key:0,x1:y.position.x,y1:y.position.y,x2:y.position.x*Math.sqrt(u(lt)**2/(y.position.x**2+y.position.y**2)),y2:y.position.y*Math.sqrt(u(lt)**2/(y.position.x**2+y.position.y**2)),stroke:"var(--foreground)","stroke-width":""},null,8,ed)):P("",!0)]))),128))]),_:1}),R(Ut,{name:"grow",duration:500,appear:""},{default:j(()=>[(_(!0),C(X,null,he(o.value,y=>(_(),C("g",{key:y.id,style:{"transition-duration":"0s"}},[R(Hc,{node:y,nodeType:h.types[y.type],dragging:u(h.draggingNode),dragged:u(h.draggingNode)===y?i.value:void 0,hasDragged:u(h.draggingNode)==null?!1:s.value,receivingNode:u(h.receivingNode)===y,isSelected:u(h.selectedNode)===y,selectedAction:u(h.selectedNode)===y?u(h.selectedAction):null,onMouseDown:b,onEndDragging:c,onClickAction:$=>g(y,$),onPlaceBuilding:p},null,8,["node","nodeType","dragging","dragged","hasDragged","receivingNode","isSelected","selectedAction","onClickAction"])]))),128))]),_:1})])]))]),_:1},8,["style","class"])):P("",!0)}}});_e.on("setupVue",e=>xr.install(e));const cr=Symbol("Board");var dn=(e=>(e.Outline="Outline",e.Fill="Fill",e))(dn||{}),ce=(e=>(e.Circle="Circle",e.Diamond="Triangle",e.Core="Core",e.Router="Router",e.Extractor="Extractor",e.Foundry="Foundry",e.Analyzer="Analyzer",e.Researcher="Researcher",e.Bore="Bore",e.Scrap="Scrap",e.ContainmentRing="ContainmentRing",e))(ce||{});function nd(e){const t=wt({nodes:[],selectedNode:null,selectedAction:null},!1);return Ie(n=>{const r=e.call(n,n);r.id=Dn("board-"),r.type=cr,r[Dt]=td,r.state?(Ao(t),Z(r,"state")):(t[Nt]={nodes:r.startNodes().map((o,l)=>(o.id=l,o)),selectedNode:null,selectedAction:null},r.state=t),r.nodes=k(()=>u(a.state).nodes),r.selectedNode=k({get(){return a.nodes.value.find(o=>o.id===u(a.state).selectedNode)||null},set(o){var l,v;Pe(a.state)?a.state.value={...a.state.value,selectedNode:(l=o==null?void 0:o.id)!=null?l:null}:a.state.selectedNode=(v=o==null?void 0:o.id)!=null?v:null}}),r.selectedAction=k({get(){const o=a.selectedNode.value;if(o==null)return null;const l=a.types[o.type];return l.actions==null?null:l.actions.find(v=>v.id===u(a.state).selectedAction)||null},set(o){var l,v;Pe(a.state)?a.state.value={...a.state.value,selectedAction:(l=o==null?void 0:o.id)!=null?l:null}:a.state.selectedAction=(v=o==null?void 0:o.id)!=null?v:null}}),r.mousePosition=B(null),r.links?Z(r,"links"):r.links=k(()=>a.selectedAction.value==null?null:a.selectedAction.value.links&&a.selectedNode.value?z(a.selectedAction.value.links,a.selectedNode.value):null),r.draggingNode=B(null),r.receivingNode=B(null),Z(r,"visibility"),ge(r,"visibility",Pt.Visible),Z(r,"width"),ge(r,"width","100%"),Z(r,"height"),ge(r,"height","100%"),Z(r,"classes"),Z(r,"style");for(const o in r.types){const l=r.types[o];if(Z(l,"title"),Z(l,"label"),Z(l,"size"),ge(l,"size",50),Z(l,"style"),Z(l,"classes"),Z(l,"draggable"),ge(l,"draggable",!1),Z(l,"shape"),ge(l,"shape","Circle"),Z(l,"canAccept"),ge(l,"canAccept",!1),Z(l,"progress"),Z(l,"progressDisplay"),ge(l,"progressDisplay","Fill"),Z(l,"progressColor"),ge(l,"progressColor","none"),Z(l,"fillColor"),Z(l,"outlineColor"),Z(l,"titleColor"),Z(l,"actionDistance"),ge(l,"actionDistance",Math.PI/6),l.nodes=k(()=>u(a.state).nodes.filter(v=>v.type===o)),ge(l,"onClick",function(v){u(a.state).selectedNode=v.id}),l.actions)for(const v of l.actions)Z(v,"visibility"),ge(v,"visibility",Pt.Visible),Z(v,"icon"),Z(v,"fillColor"),Z(v,"tooltip"),Z(v,"confirmationLabel"),ge(v,"confirmationLabel",{text:"Click again to confirm"}),Z(v,"links")}function i(o){r.draggingNode.value=o}function s(o){r.receivingNode.value=o}r.placeInAvailableSpace=function(o,l=100,v=G.Right){const p=a.nodes.value.slice().filter(b=>b===o||(v===G.Down||v===G.Up)&&Math.abs(b.position.x-o.position.x)>l||(v===G.Left||v===G.Right)&&Math.abs(b.position.y-o.position.y)>l?!1:!(v===G.Right&&b.position.x<o.position.x-l||v===G.Left&&b.position.x>o.position.x+l||v===G.Up&&b.position.y>o.position.y+l||v===G.Down&&b.position.y<o.position.y-l)).sort(v===G.Right?(b,d)=>b.position.x-d.position.x:v===G.Left?(b,d)=>d.position.x-b.position.x:v===G.Up?(b,d)=>d.position.y-b.position.y:(b,d)=>b.position.y-d.position.y);for(let b=0;b<p.length;b++){const d=p[b],c=v===G.Right||v===G.Left?Math.abs(o.position.x-d.position.x):Math.abs(o.position.y-d.position.y);if(c<l)v===G.Right?o.position.x=d.position.x+l:v===G.Left?o.position.x=d.position.x-l:v===G.Up?o.position.y=d.position.y-l:v===G.Down&&(o.position.y=d.position.y+l);else if(b>0&&c>l)break}},r[At]=function(){const{nodes:o,types:l,state:v,visibility:p,width:b,height:d,style:c,classes:g,links:h,selectedAction:S,selectedNode:M,mousePosition:y,draggingNode:$,receivingNode:T}=this;return{nodes:o,types:l,state:v,visibility:p,width:b,height:d,style:u(c),classes:g,links:h,selectedAction:S,selectedNode:M,mousePosition:y,draggingNode:$,receivingNode:T,setDraggingNode:i,setReceivingNode:s}};const a=r;return a})}function z(e,t,...n){return Ft(e)?e(t,...n):u(e)}function rd(e){return Math.max(0,...e.nodes.value.map(t=>t.id))+1}const vt={};_e.on("addLayer",e=>{const t=tn(e,cr);vt[e.id]=e.on("postUpdate",n=>{t.forEach(r=>{Object.values(r.types).forEach(i=>i.nodes.value.forEach(s=>{var a;return(a=i.update)==null?void 0:a.call(i,s,n)}))})})});_e.on("removeLayer",e=>{var t;(t=vt[e.id])==null||t.call(vt),vt[e.id]=void 0});const dr=e=>($e("data-v-5e2d38ce"),e=e(),Le(),e),id=dr(()=>m("div",{class:"key"},"Ctrl",-1)),sd=dr(()=>m("div",{class:"key"},"Shift",-1)),od={class:"key"},ad=A({__name:"Hotkey",props:{hotkey:{}},setup(e){const t=e;let n="",r=!1,i=!1,s=!1;return Ot(()=>{n=t.hotkey.key,r=n.startsWith("ctrl+"),r&&(n=n.slice(5)),i=n.startsWith("shift+"),i&&(n=n.slice(6)),s=n.length==1&&n.toLowerCase()!=n.toUpperCase(),s&&(n=n.toUpperCase())}),(a,o)=>(_(),C(X,null,[u(r)?(_(),C(X,{key:0},[id,H("+")],64)):P("",!0),u(i)?(_(),C(X,{key:1},[sd,H("+")],64)):P("",!0),m("div",od,q(u(n)),1)],64))}});var ld=W(ad,[["__scopeId","data-v-5e2d38ce"]]);const Bt=zt({}),fn=Symbol("Hotkey"),xn=[")","!","@","#","$","%","^","&","*","("];function ud(e){return Ie(t=>{const n=e.call(t,t);return n.type=fn,Z(n,"enabled"),ge(n,"enabled",!0),Z(n,"description"),n})}_e.on("addLayer",e=>{tn(e,fn).forEach(t=>{Bt[t.key]=t})});_e.on("removeLayer",e=>{tn(e,fn).forEach(t=>{Bt[t.key]=void 0})});document.onkeydown=function(e){var r;if(((r=e.target)==null?void 0:r.tagName)==="INPUT"||gn.value&&!J.keepGoing)return;let t=e.key;xn.includes(t)?t="shift+"+xn.indexOf(t):e.shiftKey&&(t="shift+"+t),e.ctrlKey&&(t="ctrl+"+t);const n=Bt[t];n&&u(n.enabled)&&(e.preventDefault(),n.onPress())};Gi(ke(()=>{const e=Object.values(Bt).filter(t=>u(t==null?void 0:t.enabled));return e.length===0?"":R("div",null,[R("br",null,null),R("h4",null,[H("Hotkeys")]),R("div",{style:"column-count: 2"},[e.map(t=>R("div",null,[R(ld,{hotkey:t},null),H(" "),t==null?void 0:t.description]))])])}));const fr=A({__name:"Spacer",props:{width:{default:"8px"},height:{default:"17px"}},setup(e){return(t,n)=>(_(),C("div",{style:re({width:t.width,height:t.height})},null,4))}});const cd={class:"build-element-row"},dd={class:"build-element-column"},fd={class:"build-element-cost"},gd=A({__name:"BuildTabElement",props:{component:{type:[Object,Function]},type:{},building:{},selected:{}},emits:["select-building"],setup(e,{emit:t}){const n=e,r=k(()=>{var o,l;return me((l=(o=n.building.display)==null?void 0:o.name)!=null?l:"","h3")}),i=k(()=>{var o,l;return me((l=(o=n.building.display)==null?void 0:o.description)!=null?l:"","div")}),s=k(()=>{let o=[];for(const l in ct)l in n.building.cost&&n.building.cost[l]>0&&o.push([l,me(ct[l].symbol),n.building.cost[l]]);return o});function a(){t("select-building",n.type)}return(o,l)=>(_(),C("div",cd,[(_(),C("svg",{width:"100px",height:"100px",viewBox:"-30 -30 60 60",class:ne({selected:o.selected===o.type})},[(_(),O(se(o.component),{onSelectBuilding:a},null,32))],2)),m("div",dd,[(_(),O(se(r.value))),(_(),O(se(i.value))),m("div",fd,[(_(!0),C(X,null,he(s.value,([v,p,b])=>(_(),C("div",{class:"cost-element",style:re({color:u(cn)[v]>=b?"var(--feature-foreground)":void 0})},[(_(),O(se(p))),m("span",null,q(u(be)(b)),1)],4))),256))])])]))}});var st=W(gd,[["__scopeId","data-v-30e387df"]]);const pd=e=>($e("data-v-32f49cfb"),e=e(),Le(),e),vd={class:"build-tab"},hd=pd(()=>m("h3",null,"Buildings",-1)),md={class:"scroll"},bd={class:"build-column"},yd=A({__name:"BuildTab",setup(e){const t=k(()=>{var r;return(r=L.board.draggingNode.value)==null?void 0:r.type});function n(r){const i=L.board.draggingNode,s=i.value;s===null||s.type!==r?i.value=Jt({position:{x:0,y:0},type:r}):i.value=null}return(r,i)=>(_(),C("div",vd,[hd,R(fr),m("div",md,[m("div",bd,[R(st,{type:u(D).Extractor,building:u(ye).extractor,component:sr,selected:t.value,onSelectBuilding:n},null,8,["type","building","selected"]),R(st,{type:u(D).Router,building:u(ye).router,component:rr,selected:t.value,onSelectBuilding:n},null,8,["type","building","selected"]),R(st,{type:u(D).Foundry,building:u(ye).foundry,component:or,selected:t.value,onSelectBuilding:n},null,8,["type","building","selected"]),R(st,{type:u(D).Analyzer,building:u(ye).analyzer,component:ar,selected:t.value,onSelectBuilding:n},null,8,["type","building","selected"]),R(st,{type:u(D).Researcher,building:u(ye).researcher,component:lr,selected:t.value,onSelectBuilding:n},null,8,["type","building","selected"]),u(L).research.bore.researched.value?(_(),O(st,{key:0,type:u(D).Bore,building:u(ye).bore,component:ur,selected:t.value,onSelectBuilding:n},null,8,["type","building","selected"])):P("",!0)])])]))}});var _d=W(yd,[["__scopeId","data-v-32f49cfb"]]);const Nd=e=>($e("data-v-f70b8e7e"),e=e(),Le(),e),wd={id:"research-tab"},kd=Nd(()=>m("h3",null,"Materials",-1)),Sd=A({__name:"ResourceTab",setup(e){return(t,n)=>(_(),C("div",wd,[kd,(_(!0),C(X,null,he(u(ct),(r,i)=>{var s,a;return _(),C(X,{key:i},[u(Vt)((s=r.visibility)!=null?s:!0)?(_(),C("div",{key:0,style:re({color:(a=r.color)!=null?a:"var(--feature-foreground)"})},[m("div",null,[(_(),O(se(u(me)(r.symbol))))]),m("div",null,[(_(),O(se(u(me)(r.name)))),H(":")]),m("div",null,q(u(be)(u(cn)[i])),1)],4)):P("",!0)],64)}),128))]))}});var Cd=W(Sd,[["__scopeId","data-v-f70b8e7e"]]);const xd=A({__name:"VerticalRule",props:{height:{}},setup(e){return(t,n)=>(_(),C("div",{class:"vr",style:re({height:t.height})},null,4))}});var Md=W(xd,[["__scopeId","data-v-5e0a978a"]]);const gr=e=>($e("data-v-1f3e0f02"),e=e(),Le(),e),Id={class:"research-tab"},$d=gr(()=>m("h3",null,"Research",-1)),Ld={class:"research-row"},Rd={class:"current-project"},Fd={key:1,class:"current"},Pd=gr(()=>m("h3",null,"Select a Research Project",-1)),Td=[Pd],Ed={class:"scroll"},zd={class:"research-block"},Od=A({__name:"ResearchTab",setup(e){const t=k(()=>Object.values(L.research).filter(s=>Vt(s.visibility))),n=k(()=>t.value.find(s=>s.id===L.activeResearch.value)),r=k(()=>t.value.filter(s=>!u(s.researched)).filter(s=>s.id!==L.activeResearch.value)),i=k(()=>t.value.filter(s=>u(s.researched)));return(s,a)=>(_(),C("div",Id,[$d,R(fr),m("div",Ld,[m("div",Rd,[H(" Current Project "),n.value!==void 0?(_(),O(se(u(Qe)(n.value)),{key:0,class:"current"})):(_(),C("div",Fd,Td))]),R(Md),m("div",Ed,[m("div",zd,[(_(!0),C(X,null,he(r.value,o=>(_(),O(se(u(Qe)(o))))),256)),(_(!0),C(X,null,he(i.value,o=>(_(),O(se(u(Qe)(o))))),256))])])])]))}});var Dd=W(Od,[["__scopeId","data-v-1f3e0f02"]]);const Ad={class:"map-tab"},Vd={class:"map-column"},jd=A({__name:"MapTab",setup(e){return(t,n)=>(_(),C("div",Ad,[R(_d),m("div",Vd,[ze(t.$slots,"default",{},void 0,!0),R(Dd)]),R(Cd)]))}});var Bd=W(jd,[["__scopeId","data-v-3b6a086b"]]);const qd=A({__name:"Node",props:{id:{}},setup(e){const n=Ce(e),r=vn(rn,()=>{}),i=vn(sn,()=>{}),s=St(null),a=k(()=>s.value&&s.value.parentElement);return Ve([a,n.id],([o,l],[v,p])=>{v&&i(u(p)),o&&r(l,o)}),_r(()=>i(u(n.id))),(o,l)=>(_(),C("div",{class:"node",ref_key:"node",ref:s},null,512))}});var Ud=W(qd,[["__scopeId","data-v-a48cb382"]]);const Zd={class:"resource-list"},Wd=A({__name:"Research",props:{visibility:{},display:{},id:{},resources:{},progress:{},progressPercentage:{},isResearching:{},researched:{}},setup(e){const t=e,n=k(()=>{let i=[];for(const s in ct)s in t.resources&&t.resources[s]>0&&i.push([s,me(ct[s].symbol),u(t.progress)[s],t.resources[s]]);return i});function r(){u(t.researched)||u(t.isResearching)||(console.log("Setting active research value to",t.id),L.activeResearch.value=t.id)}return(i,s)=>(_(),C("button",{onClick:r,class:ne({researching:u(i.isResearching)}),style:re({background:`linear-gradient(to right, var(--accent1) ${u(i.progressPercentage)*100}%, var(--locked) ${u(i.progressPercentage)*100}%)`})},[m("span",null,[(_(),O(se(u(me)(u(i.display).title,"h3"))))]),m("span",null,[(_(),O(se(u(me)(u(i.display).description))))]),m("div",Zd,[(_(!0),C(X,null,he(n.value,([a,o,l,v])=>{var p;return _(),C("div",{class:"resource-cost",style:re({color:((p=u(cn)[a])!=null?p:0)>=l?"var(--feature-foreground)":void 0})},[(_(),O(se(o),{style:{"user-select":"none"}})),m("span",null,q(u(be)(v-l))+"/"+q(u(be)(v)),1)],4)}),256))]),R(Ud,{id:i.id},null,8,["id"])],6))}});var Gd=W(Wd,[["__scopeId","data-v-3edae5dd"]]);const Hd=Symbol("Research");function ie(e){const t=wt({});return Ie(n=>{const r=e.call(n,n);r.id=Dn("research-"),r.type=Hd,r[Dt]=Gd;for(const[i,s]of Object.entries(r.resources))t.value[i]=s;return r.progress=t,Z(r,"visibility"),ge(r,"visibility",Pt.Visible),Z(r,"display"),r.progressPercentage=k(()=>1-Object.values(r.progress.value).reduce((i,s)=>i+s,0)/Object.values(r.resources).reduce((i,s)=>i+s,0)),r.isResearching=k(()=>L.activeResearch.value===r.id),r.researched=k(()=>Object.values(r.progress.value).every(i=>i===0)),r[At]=function(){const{visibility:i,display:s,id:a,resources:o,progress:l,progressPercentage:v,isResearching:p,researched:b}=this;return{visibility:i,display:s,id:a,resources:o,progress:l,progressPercentage:v,isResearching:p,researched:b}},r})}function Yd(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Nr(e)}const L=Wn("main",function(){const e=nd(a=>({startNodes:du,types:K,links(){const o=[];for(const l of a.nodes.value)for(const v of l.connectedNodes.map(p=>n.value[p]))(l.distance<v.distance||l.distance===v.distance&&l.id<v.id)&&(o.unshift({startNode:l,endNode:v,stroke:"var(--accent1)",strokeWidth:5}),l.id in Gt.value&&v.id in Gt.value[l.id]&&o.push({startNode:l,endNode:v,stroke:"var(--foreground)",strokeWidth:Gt.value[l.id][v.id]}));return o},style:{height:"100%",overflow:"hidden"}})),t=wt(!0),n=k(()=>{const a={};for(const o of e.nodes.value)a[o.id]=o;return a});this.on("preUpdate",a=>{for(const l of e.nodes.value)mu(l,a);const o=Object.values(L.research).find(l=>l.id===L.activeResearch.value);if(o!==void 0){for(const l of e.nodes.value)wu(o,l,a);o.researched.value&&(s.value="none",In().info(R("div",null,[R("h3",null,[H("Research Complete!")]),R("div",null,[R("div",{style:"color: var(--feature-foreground)"},[me(u(o.display).title)])])])))}}),this.on("update",a=>{for(const o of e.nodes.value)bu(o,a);for(const o of e.nodes.value)yu(o,a);for(const o of e.nodes.value)_u(o,a)}),this.on("postUpdate",()=>{t.value&&(gu(e.nodes.value,e.nodes.value[0]),t.value=!1),ku()});const r=ud(()=>({enabled:e.draggingNode,key:"Escape",description:"Deselect Building",onPress(){e.draggingNode.value=null}})),i={bore:ie(()=>({resources:{[I.ConsumptionResearch]:50,[I.LogisticalResearch]:15},display:{title:"Nanite Bore",description:"Unlock a more permanent form of scrap generation"}})),naniteSmelting:ie(()=>({resources:{[I.ConsumptionResearch]:100,[I.LogisticalResearch]:25},display:{title:"Nanite Forge",description:"Allow Foundries to turn Scrap into Nanites"}})),circuits:ie(()=>({resources:{[I.ConsumptionResearch]:50,[I.LogisticalResearch]:100,[I.BalisticsResearch]:15},display:{title:"Dedicated Circuitry",description:"The first step towards more powerful and performant nodes"}})),transferSpeed:ie(()=>({resources:{[I.ConsumptionResearch]:25,[I.LogisticalResearch]:50},display:{title:"Improved Logistics I",description:"Increase the transfer rate of resources to 2/s"}})),transferSpeed2:ie(()=>({resources:{[I.ConsumptionResearch]:25*3,[I.LogisticalResearch]:50*3},display:{title:"Improved Logistics II",description:"Increase the transfer rate of resources to 3/s"},visibility:i.transferSpeed.researched})),transferSpeed3:ie(()=>({resources:{[I.ConsumptionResearch]:25*3**2,[I.LogisticalResearch]:50*3**2},display:{title:"Improved Logistics III",description:"Increase the transfer rate of resources to 5/s"},visibility:i.transferSpeed2.researched})),transferSpeed4:ie(()=>({resources:{[I.ConsumptionResearch]:25*3**3,[I.LogisticalResearch]:50*3**3},display:{title:"Improved Logistics IV",description:"Increase the transfer rate of resources to 8/s"},visibility:i.transferSpeed3.researched})),transferSpeed5:ie(()=>({resources:{[I.ConsumptionResearch]:25*3**4,[I.LogisticalResearch]:50*3**4},display:{title:"Improved Logistics V",description:"Increase the transfer rate of resources to 13/s"},visibility:i.transferSpeed4.researched})),transferSpeed6:ie(()=>({resources:{[I.ConsumptionResearch]:25*3**5,[I.LogisticalResearch]:50*3**5},display:{title:"Improved Logistics VI",description:"Increase the transfer rate of resources to 21/s"},visibility:i.transferSpeed5.researched})),transferSpeed7:ie(()=>({resources:{[I.ConsumptionResearch]:25*3**6,[I.LogisticalResearch]:50*3**6},display:{title:"Improved Logistics VII",description:"Increase the transfer rate of resources to 34/s"},visibility:i.transferSpeed6.researched})),transferSpeed8:ie(()=>({resources:{[I.ConsumptionResearch]:25*3**7,[I.LogisticalResearch]:50*3**7},display:{title:"Improved Logistics VIII",description:"Increase the transfer rate of resources to 55/s"},visibility:i.transferSpeed7.researched})),transferSpeed9:ie(()=>({resources:{[I.ConsumptionResearch]:25*3**8,[I.LogisticalResearch]:50*3**8},display:{title:"Improved Logistics IX",description:"Increase the transfer rate of resources to 89/s"},visibility:i.transferSpeed8.researched})),transferSpeed10:ie(()=>({resources:{[I.ConsumptionResearch]:25*3**9,[I.LogisticalResearch]:50*3**9},display:{title:"Improved Logistics X",description:"Increase the transfer rate of resources to 144/s"},visibility:i.transferSpeed9.researched})),buildSpeed:ie(()=>({resources:{[I.ConsumptionResearch]:50,[I.LogisticalResearch]:25},display:{title:"Improved Construction I",description:"Increase the construction rate of structures to 2/s"}})),buildSpeed2:ie(()=>({resources:{[I.ConsumptionResearch]:50*3,[I.LogisticalResearch]:25*3},display:{title:"Improved Construction II",description:"Increase the construction rate of structures to 3/s"},visibility:i.buildSpeed.researched})),buildSpeed3:ie(()=>({resources:{[I.ConsumptionResearch]:50*3**2,[I.LogisticalResearch]:25*3**2},display:{title:"Improved Construction II",description:"Increase the construction rate of structures to 5/s"},visibility:i.buildSpeed2.researched})),buildSpeed4:ie(()=>({resources:{[I.ConsumptionResearch]:50*3**3,[I.LogisticalResearch]:25*3**3},display:{title:"Improved Construction II",description:"Increase the construction rate of structures to 8/s"},visibility:i.buildSpeed3.researched})),buildSpeed5:ie(()=>({resources:{[I.ConsumptionResearch]:50*3**4,[I.LogisticalResearch]:25*3**4},display:{title:"Improved Construction II",description:"Increase the construction rate of structures to 13/s"},visibility:i.buildSpeed4.researched})),buildSpeed6:ie(()=>({resources:{[I.ConsumptionResearch]:50*3**5,[I.LogisticalResearch]:25*3**5},display:{title:"Improved Construction II",description:"Increase the construction rate of structures to 21/s"},visibility:i.buildSpeed5.researched})),buildSpeed7:ie(()=>({resources:{[I.ConsumptionResearch]:50*3**6,[I.LogisticalResearch]:25*3**6},display:{title:"Improved Construction II",description:"Increase the construction rate of structures to 34/s"},visibility:i.buildSpeed6.researched})),buildSpeed8:ie(()=>({resources:{[I.ConsumptionResearch]:50*3**7,[I.LogisticalResearch]:25*3**7},display:{title:"Improved Construction II",description:"Increase the construction rate of structures to 55/s"},visibility:i.buildSpeed7.researched})),buildSpeed9:ie(()=>({resources:{[I.ConsumptionResearch]:50*3**8,[I.LogisticalResearch]:25*3**8},display:{title:"Improved Construction II",description:"Increase the construction rate of structures to 89/s"},visibility:i.buildSpeed8.researched})),buildSpeed10:ie(()=>({resources:{[I.ConsumptionResearch]:50*3**9,[I.LogisticalResearch]:25*3**9},display:{title:"Improved Construction II",description:"Increase the construction rate of structures to 144/s"},visibility:i.buildSpeed9.researched}))},s=wt("none",!1);return{board:e,idToNodeMap:n,dirty:t,research:i,activeResearch:s,dropBuilding:r,display:ke(()=>{let a;return R(Bd,null,Yd(a=Qe(e))?a:{default:()=>[a]})}),minimizable:!1}}),Jd=e=>[L],gn=k(()=>!1);function Kd(e,t){}var Xd=Object.freeze(Object.defineProperty({__proto__:null,root:L,getInitialLayers:Jd,hasWon:gn,fixOldSave:Kd},Symbol.toStringTag,{value:"Module"}));const Ct=e=>($e("data-v-4a50ce42"),e=e(),Le(),e),Qd={class:"game-over-modal-header"},ef=["src","alt"],tf={class:"game-over-modal-title"},nf=Ct(()=>m("h2",null,"Congratulations!",-1)),rf={key:0},sf=Ct(()=>m("br",null,null,-1)),of=Ct(()=>m("div",null," Please check the Discord to discuss the game or to check for new content updates! ",-1)),af=Ct(()=>m("br",null,null,-1)),lf=["href"],uf=Ct(()=>m("span",{class:"material-icons game-over-modal-discord"},"discord",-1)),cf=A({__name:"GameOverScreen",setup(e){const{title:t,logo:n,discordName:r,discordLink:i,versionNumber:s,versionTitle:a}=ee,o=k(()=>en(J.timePlayed)),l=k(()=>gn.value&&!J.keepGoing),v=We(J,"autosave");function p(){J.keepGoing=!0}function b(){Je(ot())}return(d,c)=>(_(),O(nt,{"model-value":l.value},{header:j(()=>[m("div",Qd,[u(n)?(_(),C("img",{key:0,class:"game-over-modal-logo",src:u(n),alt:u(t)},null,8,ef)):P("",!0),m("div",tf,[nf,m("h4",null,"You've beaten "+q(u(t))+" v"+q(u(s))+": "+q(u(a)),1)])])]),body:j(({shown:g})=>[g?(_(),C("div",rf,[m("div",null,"It took you "+q(o.value)+" to beat the game.",1),sf,of,af,m("div",null,[m("a",{href:u(i),class:"game-over-modal-discord-link"},[uf,H(" "+q(u(r)),1)],8,lf)]),R(qe,{title:"Autosave",modelValue:v.value,"onUpdate:modelValue":c[0]||(c[0]=h=>v.value=h)},null,8,["modelValue"])])):P("",!0)]),footer:j(()=>[m("div",{class:"game-over-footer"},[m("button",{onClick:p,class:"button"},"Keep Going"),m("button",{onClick:b,class:"button danger"},"Play Again")])]),_:1},8,["model-value"]))}});var df=W(cf,[["__scopeId","data-v-4a50ce42"]]);const qt=e=>($e("data-v-3038a9de"),e=e(),Le(),e),ff=qt(()=>m("div",{class:"nan-modal-header"},[m("h2",null,"NaN value detected!")],-1)),gf={key:0},pf=qt(()=>m("br",null,null,-1)),vf=["href"],hf=qt(()=>m("span",{class:"material-icons nan-modal-discord"},"discord",-1)),mf=qt(()=>m("br",null,null,-1)),bf={class:"nan-footer"},yf=A({__name:"NaNScreen",setup(e){const{discordName:t,discordLink:n}=ee,r=B(!0),i=B(!0),s=We(ae,"hasNaN"),a=B(null);Ve(s,d=>{d?(r.value=J.autosave,i.value=J.devSpeed===0):(J.autosave=r.value,J.devSpeed=i.value?0:null)});const o=k(()=>{var d;return(d=ae.NaNPath)==null?void 0:d.join(".")}),l=k(()=>ae.NaNPersistent!=null?ae.NaNPersistent.value:null);function v(){ae.NaNPersistent!=null&&(ae.NaNPersistent.value=0,ae.hasNaN=!1)}function p(){ae.NaNPersistent&&(ae.NaNPersistent.value=1,ae.hasNaN=!1)}function b(){ae.NaNPersistent&&(ae.NaNPersistent.value=NaN,ae.hasNaN=!1)}return(d,c)=>(_(),C(X,null,[R(nt,Ze({modelValue:s.value,"onUpdate:modelValue":c[4]||(c[4]=g=>s.value=g)},d.$attrs),{header:j(()=>[ff]),body:j(()=>[m("div",null,[H(' Attempted to assign "'+q(o.value)+'" to NaN',1),l.value?(_(),C("span",gf,q(" ")+"(previously "+q(u(zn)(l.value))+")",1)):P("",!0),H(". Auto-saving has been "+q(r.value?"enabled":"disabled")+". Check the console for more details, and consider sharing it with the developers on discord. ",1)]),pf,m("div",null,[m("a",{href:u(n)||"https://discord.gg/yJ4fjnjU54",class:"nan-modal-discord-link"},[hf,H(" "+q(u(t)||"The Paper Pilot Community"),1)],8,vf)]),mf,R(qe,{title:"Autosave",modelValue:r.value,"onUpdate:modelValue":c[0]||(c[0]=g=>r.value=g)},null,8,["modelValue"]),u(ee).enablePausing?(_(),O(qe,{key:0,title:"Pause game",modelValue:i.value,"onUpdate:modelValue":c[1]||(c[1]=g=>i.value=g)},null,8,["modelValue"])):P("",!0)]),footer:j(()=>[m("div",bf,[m("button",{onClick:c[2]||(c[2]=g=>{var h;return(h=a.value)==null?void 0:h.open()}),class:"button"},"Open Saves Manager"),m("button",{onClick:v,class:"button"},"Set to 0"),m("button",{onClick:p,class:"button"},"Set to 1"),l.value&&u(N).neq(l.value,0)&&u(N).neq(l.value,1)?(_(),C("button",{key:0,onClick:c[3]||(c[3]=g=>s.value=!1),class:"button"}," Set to previous ")):P("",!0),m("button",{onClick:b,class:"button danger"},"Ignore")])]),_:1},16,["modelValue"]),R(Qn,{ref_key:"savesManager",ref:a},null,512)],64))}});var _f=W(yf,[["__scopeId","data-v-3038a9de"]]);const Nf={key:0,class:"tpsDisplay"},wf=A({__name:"TPS",setup(e){const t=k(()=>N.div(ae.lastTenTicks.length,ae.lastTenTicks.reduce((n,r)=>n+r,0)));return(n,r)=>t.value.isNan()?P("",!0):(_(),C("div",Nf,"TPS: "+q(u(On)(t.value)),1))}});var kf=W(wf,[["__scopeId","data-v-89b89152"]]);var Sf=A({__name:"App",setup(e){const t=ee.useHeader,n=k(()=>Te[te.theme].variables),r=We(te,"showTPS"),i=We(ae,"errors"),s=k(()=>me(ke(()=>R(X,null,[Hi.map(Qe)]))));return(a,o)=>i.value.length>0?(_(),C("div",{key:0,class:"error-container",style:re(n.value)},[R(Rn,{errors:i.value},null,8,["errors"])],4)):(_(),C(X,{key:1},[m("div",{id:"modal-root",style:re(n.value)},null,4),m("div",{class:ne(["app",{useHeader:u(t)}]),style:re(n.value)},[u(t)?(_(),O(er,{key:0})):P("",!0),R(jl),u(r.value)?(_(),O(kf,{key:1})):P("",!0),R(df),R(_f),(_(),O(se(s.value)))],6)],64))}});var Cf=W(Sf,[["__scopeId","data-v-6248aa87"]]);_e.on("setupVue",e=>e.use(Mr));function xf(e={}){const{immediate:t=!1,onNeedRefresh:n,onOfflineReady:r,onRegistered:i,onRegisteredSW:s,onRegisterError:a}=e;let o,l,v,p;const b=async(c=!0)=>{await v,c&&(o==null||o.addEventListener("controlling",g=>{g.isUpdate&&window.location.reload()})),await(p==null?void 0:p())};async function d(){if("serviceWorker"in navigator){const{Workbox:c,messageSW:g}=await bt(()=>import("./workbox-window.4a8794bb.js"),[]);p=async()=>{l&&l.waiting&&await g(l.waiting,{type:"SKIP_WAITING"})},o=new c("./sw.js",{scope:"./",type:"classic"}),o.addEventListener("activated",h=>{h.isUpdate||r==null||r()});{const h=()=>{n==null||n()};o.addEventListener("waiting",h),o.addEventListener("externalwaiting",h)}o.register({immediate:t}).then(h=>{l=h,s?s("./sw.js",h):i==null||i(h)}).catch(h=>{a==null||a(h)})}}return v=d(),b}function Mf(e={}){const{immediate:t=!0,onNeedRefresh:n,onOfflineReady:r,onRegistered:i,onRegisteredSW:s,onRegisterError:a}=e,o=B(!1),l=B(!1);return{updateServiceWorker:xf({immediate:t,onNeedRefresh(){o.value=!0,n==null||n()},onOfflineReady(){l.value=!0,r==null||r()},onRegistered:i,onRegisteredSW:s,onRegisterError:a}),offlineReady:l,needRefresh:o}}const If=console.error;console.error=function(...e){If(...e)};window.onerror=function(e,t,n,r,i){return ae.errors.push(i instanceof Error?i:new Error(JSON.stringify(i))),!0};window.onunhandledrejection=function(e){ae.errors.push(e.reason instanceof Error?e.reason:new Error(JSON.stringify(e.reason)))};document.title=ee.title;window.projInfo=ee;ee.id===""&&console.error("Project ID is empty!","Please select a unique ID for this project in /src/data/projInfo.json");requestAnimationFrame(async()=>{console.log(`%cMade in Profectus%c
Learn more at www.moddingtree.com`,"font-weight: bold; font-size: 24px; color: #A3BE8C; background: #2E3440; padding: 4px 8px; border-radius: 8px;","padding: 4px;"),await Bi();const{globalBus:e}=await bt(()=>Promise.resolve().then(function(){return ji}),void 0),{startGameLoop:t}=await bt(()=>import("./gameLoop.45302804.js"),["assets/gameLoop.45302804.js","assets/@fontsource.f583a260.css","assets/vue.17dc9343.js","assets/amator.662264f3.js","assets/bezier-easing.a990b400.js","assets/@vue.f39bd477.js","assets/nanoevents.1080beb7.js","assets/lz-string.dccec454.js","assets/vue-next-select.3f210d97.js","assets/vue-next-select.9e6f4164.css","assets/vuedraggable.3138c559.js","assets/sortablejs.d2aaca1a.js","assets/vue-textarea-autosize.35804eaf.js","assets/vue-panzoom.db51701d.js","assets/panzoom.f5ccc6c8.js","assets/wheel.c9cad283.js","assets/ngraph.events.083734c6.js","assets/vue-toastification.277609fd.js","assets/vue-toastification.4b5f8ac8.css"]),n=window.vue=wr(Cf);n.config.errorHandler=function(r,i,s){console.error(r,s,i)},e.emit("setupVue",n),n.mount("#app"),ht(()=>{const r=In(),{updateServiceWorker:i}=Mf({onNeedRefresh(){r.info("New content available, click here to update.",{timeout:!1,closeOnClick:!1,draggable:!1,icon:{iconClass:"material-icons",iconChildren:"refresh",iconTag:"i"},rtl:!1,onClick(){i()}})},onOfflineReady(){r.info("App ready to work offline")},onRegisterError:console.warn,onRegistered(s){s&&setInterval(()=>s.update(),60*60*1e3)}})}),t()});export{N as D,bt as _,ae as a,ee as b,Xd as c,_e as g,qi as l,J as p,te as s};
